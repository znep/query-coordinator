<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<head>
  <meta http-equiv="content-type" content="text/html;charset=utf-8" />

  <%= stylesheet_link_tag "base", "common", "info-pane", "layout",
    "outer-chrome", "sidebar", "widgets",
    :cache => "cache/all" %>

  <% if ENV["RAILS_ENV"] != 'production' %>
  <script src="/javascripts/jquery-1.3.2.js" type="text/javascript"
    charset="utf-8"></script>
  <% else %>
  <script src="http://www.google.com/jsapi" type="text/javascript"></script>
  <script type="text/javascript">
    google.load("jquery", "1.3.2");
  </script>
  <% end %>

  <%= yield :head %>

</head>

<body id='<%= @body_id %>' class='<%= @body_class %>'>

  <div id='outerContainer'>
    <div id='header'>
      <div id='mainLogo'><%= link_to('blist', root_url) %></div>

      <div id='mainNav'>
        <ul>
          <li class='home'><%= link_to("Home", root_url) %></li>
          <li class='discover'><%= link_to("Discover", discover_url) %></li>
          <li class='community last'><a href='#'>Community</a></li>
        </ul>
      </div>

      <%# This is not supported yet
      <div class='notifications'>
        <ul>
          <li><a href='#' class='messages' title='Messages'>1</a></li>
          <li><a href='#' class='requests' title='Requests'>3</a></li>
        </ul>
      </div>
      %>

      <div class='userNav'>
        <ul>
          <li><a href='/help'>Help</a></li>
          <li class='signInLink'><a href='/login'>Sign In</a></li>
          <li class='accountLink'><%= link_to "My Account", account_url %></li>
          <li class='signOutLink'><a href='/logout'>Sign Out</a></li>
        </ul>
      </div>

      <form class='search' action='/discover'>
        <p>
          <input type='text' class='textPrompt' name='search'
            title='Search for blists, contacts &amp; help'
            value='<%= @discover_search %>' />
          <input type='image' class='submit' name='discoverSubmit'
            src="<%= image_path("find_button.png") %>" />
        </p>
      </form>
    </div>

    <%= yield :layout %>

    <div id='footer'>
      <%= link_to 'blist', { :controller => 'home'} , { :class => 'homeLink' } %>
      <ul>
        <li><%= link_to('Forums', '/forum') %></li>
        <li><%= link_to('Blog', 'http://blog.blist.com/',
          { :class => 'rss' }) %></li>
        <li><%= link_to('About blist', '/company-info/about-blist') %></li>
        <li><%= link_to('Terms of use', '/help/terms-of-use') %></li>
        <li><%= link_to('Site map', '/site-map') %></li>
        <li><%= link_to('Contact us', '/contact-us') %></li>
      </ul>
    </div>
  </div>

  <%#
  Better to load JS at the bottom:
  http://developer.yahoo.com/performance/rules.html#js_bottom
  %>
  <%= javascript_include_tag "plugins/jquery.sizes.min", "util/namespace",
    :cache => "cache/all" %>

  <% if ENV["RAILS_ENV"] != 'production' %>
    <%= javascript_include_tag "util/debug", :cache => "cache/all" %>
  <% end %>


  <%# This should be included on all pages, including the marketing site.
  It will update the header appropriately based on your logged-in state %>
  <%= javascript_include_tag "plugins/jquery.cookies.2.0.1.min",
    :cache => "cache/all" %>
  <script type="text/javascript">
    jQuery((function ($)
    {
        var blistCookie = $.cookies.get('blist_core_session');
        if (blistCookie && blistCookie !== "")
        {
            $('#header .userNav').addClass('loggedInNav');
        }
    })(jQuery));
  </script>

  <%= yield :js_footer %>
</body>
</html>
