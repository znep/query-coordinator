<% content_for :head do %>
  <%= stylesheet_link_tag "home-screen",
    :cache => "cache/all" %>
  <title>blist | share your weblists</title>
<% end %>



<div class="twoColumnContainer clearfix">
  <div id="mainColumnContent" class="column mainContent">
    <div id='home'>
      <%= render(:partial => "shared/tabs") %>
      <div class='outerContent'>
        <div class='contentHighlight'>
          <div class='content'>
            <h1>Welcome back <%= current_user.is_established? ? h(current_user.login) : h(current_user.firstName) %></h1>
            
            <ul class="actionButtons clearfix">
              <li><a href="<%= blist_href_new_blist %>"
                class="arrowButton">New blist</a></li>
              <li><a href="<%= blist_href_import %>">Import from Excel</a></li>
              <li><a href="#">Browse blists</a></li>
              <li class="last"><a href="#">Invite Others</a></li>
            </ul>
            
            <%- if (!current_user.is_established?) -%>
              <%= render(:partial => "shared/feature_boxes") %>
            <%- end -%>
            
            <%- if (@recently_opened_blists.length > 0) -%>
              <div class="activityListContainer">
                <h2>Recently Opened blists</h2>
                <ul>
                  <%= render( :partial => "blist_activity_list_item", 
                              :collection => @recently_opened_blists) %>
                </ul>
                <p class="listAction"><a href="#act">View All</a></p>
              </div>
            <%- end -%>
            
            <%- if (@favorite_blists.length > 0) -%>
              <div class="activityListContainer">
                <h2>Favorite blists</h2>
                <ul class="favoriteList">
                  <%= render( :partial => "blist_activity_list_item", 
                              :collection => @favorite_blists) %>
                </ul>
                <p class="listAction"><a href="#act">View All</a></p>
              </div>
            <%- end -%>
            
            <%- if (@contacts.length > 0) -%>
              <div class="activityListContainer">
                <h2>Contacts Updates</h2>
                <ul class="contactList">
                  <%= render( :partial => "contact_activity_list_item", 
                              :collection => @contacts) %>
                </ul>
                <p class="listAction"><a href="#act">View All</a></p>
              </div>
            <%- end -%>
            
            <%- if (@feed_items.length > 0) -%>
              <div class="activityListContainer">
                <h2>From the Blog</h2>
                <ul>
                  <%= render( :partial => "blog_activity_list_item", 
                              :collection => @feed_items) %>
                </ul>
                <p class="listAction"><a href="#act">View All</a></p>
              </div>
            <%- end -%>
            
          </div>
        </div>
      </div>
    </div>
  </div>

  <div id="sidebar" class="column">
    <% render(:layout => "shared/sidebar_box") do %>
      <%= render(:partial => "shared/current_user_tile", :locals => { :user => current_user }) %>
    <% end %>

    <%- # only show updates if the user has > 3 total blists -%>
    <%- if (current_user.is_established?) -%>
      <% render(:layout => "shared/sidebar_box",
        :locals => { :content_class => 'userUpdates' } ) do %>
        <%= render(:partial => "shared/user_updates", :locals => { :user => current_user }) %>
      <% end %>
    <%- end -%>
    
    <%- # Storage space used is not yet applicable -%>
    <%- if false -%>
      <% render(:layout => "shared/sidebar_box") do %>
        <h4>Storage</h4>
        <p>You are using 50% of your available storage</p>
      <% end %>
    <%- end -%>

    <%= render(:partial => "shared/ad_box", :locals => { :last_child => true }) %>
  </div>
</div>

<% content_for :js_footer do %>
  <%= render(:partial => "shared/common_js") %>
<% end %>
