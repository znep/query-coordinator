<div class="aboutDataset_contact">
  <div class="contactOwnerFormWrapper">
    <%= form_tag(url_for({:controller => 'datasets', :action => "math_validate"}),
      :class => 'contactOwnerForm') do %>
      <%= hidden_field_tag 'method', 'flag' %>
      <div class="lined">
        <div><label for="contactPurpose" class="required">Purpose:</label></div>
        <select id="contactPurpose" name="type">
          <%= options_for_select(
              [['-- Select Purpose --', ''],
               ['Copyright Violation', 'copyright_violation'],
               ['Offensive Content', 'offensive_content'],
               ['Spam or Junk', 'spam'],
               ['Personal Information', 'personal_information'],
               ['Other', 'other']], '') -%>
        </select>
      </div>

      <div class="lined">
        <label for="contactSubject">Subject:</label>
        <textarea id="contactSubject" name="subject"></textarea>
      </div>

      <div class="lined">
        <div><label for="contactBody" class="required">Short Message:</label></div>
        <textarea id="contactBody" name="message"></textarea>
      </div>

      <div class="lined">
        <div><label for="from_address" class="required">Your Email:</label></div>
        <p>Your email address will be shared with the owner of this dataset so they can reply.</p>
        <input id="fromAddress" name="from_address" type="text" value="<%= current_user.email unless (current_user.nil? || current_user.email.nil?) %>"/>
      </div>

      <div class="lined">
        <% 
        numbers = ['zero','one','two','three','four','five']
        operations = ['plus', 'minus']

        num1 = numbers[rand(numbers.length)]
        num2 = numbers[rand(numbers.length)]
        operation = operations[rand(operations.size)]

        if numbers.index(num1) < numbers.index(num2)
          num1,num2 = num2,num1
        end
        
        output = sprintf('%s %s %s', num1, operation, num2)
        encoded = ::Base64.encode64(output.center(20))
          %> 
        <div><label for="noSpam" class="required">What is <%= output %> as a word?</label></div>
        <input class="noSpamAnswer" type="text" name="user_answer" />
      </div>

      <input type="text" class="encrypted" name="equation_token" style="display:none;" value="<%= encoded %>"/>
      <div class="math_message flash"></div>

      <%- if local_assigns[:static_links] -%>
      <%= submit_tag('Send', :class => 'button default') %>
      <%- else -%>
      <a href="#submit" class="button sendContactButton">Send</a>
      <%- end -%>
      <a href="<%= local_assigns[:static_links] ? @view.alt_href : '#cancel' %>"
        class="button cancelContactButton contactButton">Cancel</a>
    <% end %>
  </div>
</div>
