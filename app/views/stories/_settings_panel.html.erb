<div id="settings-panel-container">
  <div class="settings-panel">
    <%- if current_user.present? %>
    <a class="back-to-profile-btn" href="/profile/<%= current_user['id'] %>?limitTo=story">
      <span class="icon-arrow-prev back-to-profile-icon"></span>
      <span class="back-to-profile-label" title="<%= t('editor.settings_panel.back_to_profile') %>">
        <%= t('editor.settings_panel.back_to_profile') %>
      </span>
    </a>
    <%- end %>
    <button class="close-side-panel-btn" data-panel-toggle="settings-panel">
      <span class="icon-cross2 close-panel-icon"></span>
    </button>

    <header>
      <h4 class="settings-main-title text-center"><%= t('editor.settings_panel.panel_title') %></h4>
    </header>

    <section class="settings-panel-errors warning-bar hidden">
      <p><span class="icon-warning"></span></p>
      <p class="settings-panel-error-message"><%= t('editor.settings_panel.errors.generic_error') %></p>
    </section>

    <ul class="menu-list">

      <li id="settings-panel-story-metadata" class="menu-list-item">
        <button class="menu-list-item-header expandable">
          <span class="icon-edit"></span>
          <span><%= t('editor.settings_panel.displaying_section.section_title') %></span>
        </button>
        <div class="menu-list-item-content settings-panel-displaying collapsed">
          <div>
            <%- if contributor? -%>
              <section class="warning-bar">
                <p><span class="icon-warning"></span></p>
                <p class="settings-panel-error-message"><%= t('editor.settings_panel.errors.cannot_edit_title_and_description') %></p>
              </section>
            <%- end %>

            <form>
              <label><%= t('editor.settings_panel.displaying_section.title_label') %></label>
              <input name="title" type="text" maxlength="254"<%= ' disabled' unless can_edit_title_and_description? %>>
              <label><%= t('editor.settings_panel.displaying_section.description_label') %></label>
              <textarea <%= ' disabled' unless can_edit_title_and_description? %>></textarea>
            </form>

            <div class="settings-save-failure-message">
              <div><%= t('editor.settings_panel.errors.generic_save_failure_message') %></div>
              <div class="settings-save-failure-message-details"></div>
            </div>
            <button class="settings-save-btn btn-default btn-dark">
              <span><%= t('editor.settings_panel.displaying_section.save_button_label') %></span>
            </button>
          </div>
        </div>
      </li>

      <li id="settings-panel-copy-story" class="menu-list-item">
        <button class="menu-list-item-header" data-action="STORY_MAKE_COPY_MODAL_OPEN"<%= ' disabled' unless can_make_copy? %>>
          <span class="icon-copy-document"></span>
          <span><%= t('editor.settings_panel.copy_section.section_title') %></span>
          <%- unless can_make_copy? -%>
            <span class="settings-panel-subtitle"><%= t('editor.settings_panel.warnings.permissions') %></span>
          <%- end %>
        </button>
      </li>

      <li id="settings-panel-collaborators" class="menu-list-item">
        <button class="menu-list-item-header" data-action="COLLABORATORS_OPEN"<%= ' disabled' unless can_manage_collaborators? %>>
          <span class="icon-add-collaborator"></span>
          <span><%= t('editor.settings_panel.collaborators_section.section_title') %></span>
          <%- unless can_manage_collaborators? -%>
            <span class="settings-panel-subtitle"><%= t('editor.settings_panel.warnings.permissions') %></span>
          <%- end %>
        </button>
      </li>

      <li id="settings-panel-publishing" class="menu-list-item">
        <button class="menu-list-item-header expandable">
          <span class="icon-eye"></span>
          <span><%= t('editor.settings_panel.publishing_section.section_title') %></span>
        </button>
        <div class="menu-list-item-content settings-panel-publishing collapsed">
          <div>
            <%- if contributor? -%>
              <section class="warning-bar">
                <p><span class="icon-warning"></span></p>
                <%- if determine_permissions_from_core_attributes[:isPublic] -%>
                  <p class="settings-panel-error-message"><%= t('editor.settings_panel.errors.cannot_change_visibility_or_update_public_version') %></p>
                <%- else -%>
                  <p class="settings-panel-error-message"><%= t('editor.settings_panel.errors.cannot_change_visibility') %></p>
                <%- end -%>
              </section>
            <%- end %>

            <div class="settings-panel-story-visibility">
              <div>
                <h2><%= t('editor.settings_panel.publishing_section.visibility.title') %></h2>
                <h3><%= t('editor.settings_panel.publishing_section.visibility.private') %></h3>
              </div>
              <div>
                <button class="btn-secondary btn-dark" <%= ' disabled' unless can_manage_story_visibility? %>>
                  <span><%= t('editor.settings_panel.publishing_section.visibility.make_story_public') %></span>
                </button>
              </div>
            </div>

            <hr>

            <div class="settings-panel-story-status hidden">
              <div>
                <h2><%= t('editor.settings_panel.publishing_section.status.title') %></h2>
                <h3><%= t('editor.settings_panel.publishing_section.status.draft') %></h3>
              </div>
              <div>
                <button class="btn-primary btn-dark" disabled>
                  <span><%= t('editor.settings_panel.publishing_section.status.update_public_version') %></span>
                </button>
              </div>
            </div>

            <p class="settings-panel-story-publishing-help-text">
              <%= t('editor.settings_panel.publishing_section.messages.can_be_shared_publicly') %>
            </p>
          </div>
        </div>
      </li>

      <li id="settings-panel-share" class="menu-list-item">
        <button class="menu-list-item-header" data-action="SHARE_AND_EMBED_MODAL_OPEN">
          <span class="icon-share"></span>
          <span><%= t('editor.settings_panel.story_widget_embed_section.section_title') %></span>
        </button>
      </li>

      <% if Rails.application.config.enable_settings_panel_stats_link -%>
      <li id="settings-panel-story-stats" class="menu-list-item">
        <%= settings_panel_story_stats_link do %>
          <span class="icon-bar-chart"></span>
          <span><%= t('editor.settings_panel.story_stats_section.section_title') %></span>
          <%- unless can_see_story_stats? -%>
            <span class="settings-panel-subtitle"><%= t('editor.settings_panel.warnings.permissions') %></span>
          <%- end %>
        <% end -%>
      </li>
      <% end -%>

    </ul>
  </div>
  <div id="settings-panel-overlay" data-panel-toggle="settings-panel"></div>
</div>
