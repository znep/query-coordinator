<div class="user-story-container">

  <%= render(partial: 'stories/partials/header') %>

  <div class="user-story large theme-<%= @story.theme %>">
    <% @story.blocks.each do |block| -%>
      <% layout_columns = block.layout.split('-') -%>

      <div class="block" <%= 'data-presentable' if block.presentable %>>
        <% if block.layout == '12-12-12-12' -%>

          <!-- Couple two 12's together and wrap them with a .col6 -->
          <% [block.components.slice(0, 2), block.components.slice(2, 2)].each do |chunk| -%>
            <div class="col6">
              <% chunk.each_with_index do |component, index| -%>
                <%=
                  render(
                    partial: 'stories/partials/component',
                    locals: {
                      index: index,
                      layout_columns: layout_columns,
                      component: component
                    }
                  )
                %>
              <% end -%>
            </div>
          <% end -%>

        <% else -%>

          <% block.components.each_with_index do |component, index| %>
            <%=
              render(
                partial: 'stories/partials/component',
                locals: {
                  index: index,
                  layout_columns: layout_columns,
                  component: component
                }
              )
            %>
          <% end -%>

        <% end %>
      </div>
    <% end -%>

  </div>

  <%= render(partial: 'stories/partials/footer') %>
</div>

<%= render(partial: 'stories/partials/presentation_mode') %>
