<!DOCTYPE html>
<html>
  <head>
    <title>Example Usage: socrata.visualizations.ColumnChart.js</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF8">
    <link rel="stylesheet" media="all" href="../socrata.visualizations.columnChart.css">
    <link rel="stylesheet" media="all" href="../socrata.visualizations.flyoutRenderer.css">
    <style type="text/css">

      body {
        font-size: 10px;
        font-family: sans-serif;
      }

      #column-chart-1 {
        display: block;
        position: relative;
        width: 640px;
        height: 480px;
        margin: 100px auto 0 auto;
        border: 1px solid #aaa;
      }

      #column-chart-2 {
        display: block;
        position: relative;
        width: 640px;
        height: 480px;
        margin: 100px auto 0 auto;
        border: 1px solid #aaa;
      }

    </style>
  </head>
  <body>
    <div id="column-chart-1"></div>
    <div id="column-chart-2"></div>
  </body>
  <!-- lodash must be loaded before `socrata.utils.js` -->
  <script type="text/javascript" src="../bower_components/lodash/lodash.js"></script>
  <script type="text/javascript" src="../bower_components/socrata-utils/socrata.utils.js"></script>
  <!-- jquery must be loaded before `socrata.visualizations.Visualization.js` -->
  <script type="text/javascript" src="../bower_components/jquery/dist/jquery.js"></script>
  <!-- `socrata.visualizations.Visualization.js` must be loaded before `socrata.visualizations.ColumnChart.js` -->
  <script type="text/javascript" src="../socrata.visualizations.Visualization.js"></script>
  <!-- d3 must be loaded before `socrata.visualizations.ColumnChart.js` -->
  <script type="text/javascript" src="../bower_components/d3/d3.js"></script>
  <script type="text/javascript" src="../socrata.visualizations.ColumnChart.js"></script>
  <!-- `socrata.visualizations.DataProvider.js` must be loaded before `socrata.visualizations.SoqlDataProvider.js` -->
  <script type="text/javascript" src="../socrata.visualizations.DataProvider.js"></script>
  <script type="text/javascript" src="../socrata.visualizations.SoqlDataProvider.js"></script>
  <script type="text/javascript" src="../socrata.visualizations.FlyoutRenderer.js"></script>
  <script type="text/javascript" src="../components/SocrataColumnChart.js"></script>
  <script type="text/javascript">

    var flyoutRenderer = new window.socrata.visualizations.FlyoutRenderer();

    var columnChart1Config = {
      domain: 'dataspace.demo.socrata.com',
      datasetUid: 'r6t9-rak2',
      columnName: 'category',
      filters: [],
      localization: {
        'NO_VALUE': 'No value',
        'FLYOUT_UNFILTERED_AMOUNT_LABEL': 'Total',
        'FLYOUT_FILTERED_AMOUNT_LABEL': 'Filtered',
        'FLYOUT_SELECTED_NOTICE': 'This column is selected'
      },
      unit: {
        en: {
          one: 'case',
          other: 'cases'
        }
      }
    };

    var columnChart2Config = _.cloneDeep(columnChart1Config);
    columnChart2Config.columnName = 'source';

    var $columnChart1Element = $('#column-chart-1');
    $columnChart1Element.socrataColumnChart(columnChart1Config);

    var $columnChart2Element = $('#column-chart-2');
    $columnChart2Element.socrataColumnChart(columnChart2Config);

    /**
     * Handle flyout events.
     */

    $columnChart1Element.on('SOCRATA_VISUALIZATION_COLUMN_CHART_FLYOUT', handleFlyout);
    $columnChart2Element.on('SOCRATA_VISUALIZATION_COLUMN_CHART_FLYOUT', handleFlyout);


    function handleFlyout(event) {

      var payload = event.originalEvent.detail;

      // Render/hide a flyout
      if (payload !== null) {

        flyoutRenderer.render(payload);

      } else {

        flyoutRenderer.clear();
      }
    }

  </script>
</html>
