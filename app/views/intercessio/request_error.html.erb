<% content_for :head do %>
    <title><%= CurrentDomain.strings.site_title %> Unable to Retrieve Generated Document</title>
    <%= rendered_stylesheet_tag 'error-pages' %>
<% end %>

<div class="modalContentBox siteContent">
    <div class="contentHeader">
        <h1 id="intercessio-error" >Unable to Retrieve Generated Document</h1>
    </div>
    <div class="contentBoxInner clearfix notFound">
        <div class="icon errorIcon"></div>

        <p class="subheadline"></p>
        <p class="body">
            Documents generated through this service are only available for a limited time because
            they may contain private data. These documents are generated for specific users, and will
            not be available to other users even if the download link is shared.

            You may be able to request the document again by following the link provided in the
            notification email.
        </p>

        <div class="goSomewhere">
            <span class="labelText"><%= t 'error.not_found_404.back_to'  %></span> <a href="/" class="button default"><%= CurrentDomain.cname %></a>
        </div>

        <script>
            $(function () {
                var error_msg = "Unable to Retrieve Generated Document";
                var server = new ServerModel();
                var intercessioRequest = function (target) {
                    server.makeRequest({
                        url: target,
                        type: "GET",
                        success: function (responseData) {
                            if (responseData.state) {
                                if (responseData.state == "Dead") {
                                    error_msg = "There was an Error Creating Document";
                                } else if (responseData.state == "StorageTimedOut") {
                                    error_msg = "The Document has Expired";
                                } else {
                                    error_msg = "Unknown Document State";
                                }
                                $("#intercession-error").innerHTML = error_msg;
                            }
                        },
                        error: function (request) {
                            error_msg = "The Document Cannot Be Found";
                            $("#intercession-error").innerHTML = error_msg;

                        }
                    })
                };
                intercessioRequest("/intercessio/status/<%= @token %>");
            });
        </script>


    </div>
</div>
