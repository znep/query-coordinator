/*!
 * Socrata Styleguide v0.4.3
 * Copyright 2015-2016 Socrata, Inc.
 * Licensed under MIT
 */

function DropDown(element) {
  this.dd = element;
  this.orientation = element.getAttribute('data-orientation') || 'bottom';
  this.dd.classList.add('dropdown-orientation-' + this.orientation);

  this.placeholder = this.dd.querySelector('span');
  this.opts = Array.prototype.slice.call(this.dd.querySelectorAll('.dropdown-options > li'));
  this.val = '';
  this.index = -1;

  this.initEvents();
}

DropDown.prototype = {
  initEvents: function() {
    var obj = this;

    obj.dd.addEventListener('click', function(event) {
      event.stopPropagation();
      obj.dd.classList.toggle('active');
      return false;
    });

    obj.opts.forEach(function(opt) {
      opt.addEventListener('click', function(event) {
        event.preventDefault();

        var node = opt;
        var index = 0;

        while ((node = node.previousElementSibling) !== null) {
          index++;
        }

        obj.val = opt.textContent;
        obj.index = index;
        obj.placeholder.textContent = 'Gender: ' + obj.val;

        return false;
      });
    });
  }
}

function FlannelFactory(element) {
  var padding = 10;
  var hoverables = Array.prototype.slice.apply(document.querySelectorAll('[data-flannel]'));

  hoverables.forEach(function(hoverable) {
    var flannel = document.querySelector('#' + hoverable.getAttribute('data-flannel'));
    var dismissals = Array.prototype.slice.apply(flannel.querySelectorAll('[data-flannel-dismiss]'));

    dismissals.forEach(function(dismissal) {
      dismissal.addEventListener('click', function() {
        flannel.classList.add('flannel-hidden');
        hoverable.classList.remove('active');
      });
    });

    hoverable.addEventListener('click', function() {
      flannel.classList.toggle('flannel-hidden');
      var node = hoverable;
      var left = 0;
      var top = 0;

      do {
        left += node.offsetLeft;
        top += node.offsetTop;
      } while ((node = node.offsetParent) !== null);

      left = left + hoverable.offsetWidth / 2;
      top = top + hoverable.offsetHeight + padding;

      flannel.style.left = left + 'px';
      flannel.style.top = top + 'px';
    });
  });

}

function FlyoutFactory(element) {
  var padding = 10;
  var hoverables = Array.prototype.slice.apply(document.querySelectorAll('[data-flyout]'));

  hoverables.forEach(function(hoverable) {
    var flyout = document.querySelector('#' + hoverable.getAttribute('data-flyout'));

    hoverable.addEventListener('mouseover', function() {
      flyout.classList.remove('flyout-hidden');
      var node = hoverable;
      var left = 0;
      var top = 0;

      do {
        left += node.offsetLeft;
        top += node.offsetTop;
      } while ((node = node.offsetParent) !== null);

      left = left + hoverable.offsetWidth / 2;
      top = top + hoverable.offsetHeight + padding;

      flyout.style.left = left + 'px';
      flyout.style.top = top + 'px';
    });

    hoverable.addEventListener('mouseout', function() {
      flyout.classList.add('flyout-hidden');
    });
  });

}

function MenuFactory(element) {
  var menus = Array.prototype.slice.call(element.querySelectorAll('.menu'));
  var toggles = Array.prototype.slice.call(element.querySelectorAll('[data-menu-toggle]'));

  toggles.forEach(function(toggle) {
    toggle.addEventListener('click', function() {
      var menu = element.querySelector('#' + toggle.getAttribute('data-menu-toggle'));
      menu.classList.toggle('active');
    });
  });

  menus.forEach(function(menu) {
    var dismissals = Array.prototype.slice.call(menu.querySelectorAll('[data-menu-dismiss]'));

    dismissals.forEach(function(dismissal) {
      dismissal.addEventListener('click', function() {
        menu.classList.remove('active');
        document.querySelector('[data-menu-toggle="' + menu.id + '"]').classList.remove('active');
      });
    });
  });
}

function ModalFactory(element) {
  this.root = element;
  this.dismissals = Array.prototype.slice.apply(element.querySelectorAll('[data-modal-dismiss]'));
  this.openers = Array.prototype.slice.apply(element.querySelectorAll('[data-modal]'));
  this.attachEvents();
}

ModalFactory.prototype = {
  attachEvents: function() {
    this.dismissals.forEach(function (dismissal) {
      dismissal.addEventListener('click', this.dismiss.bind(this));
    }, this);

    this.openers.forEach(function (opener) {
      opener.addEventListener('click', this.open.bind(this));
    }, this);

    document.addEventListener('keyup', function(event) {
      var key = event.which || event.keyCode;

      // ESC
      if (key === 27) {
        var modals = Array.prototype.slice.call(document.querySelectorAll('.modal:not(.modal-hidden)'));
        modals.forEach(function(modal) {
          modal.classList.add('modal-hidden');
        });
      }
    });
  },
  open: function(event) {
    var modal = event.target.getAttribute('data-modal');
    modal = this.root.querySelector('#' + modal);
    modal.classList.remove('modal-hidden');
  },
  dismiss: function(event) {
    var target = event.target;
    var closeable = target === event.currentTarget &&
      target.classList.contains('modal-overlay');

    do {
      if (target.hasAttribute('data-modal-dismiss') &&
          !target.classList.contains('modal')) {
        closeable = true;
      } else if (target.classList.contains('modal') && closeable) {
        return target.classList.add('modal-hidden');
      } else if (target.classList.contains('modal')){
        return;
      }
    } while((target = target.parentNode) !== this.root);
  }
};

function ToggleFactory(element) {
  var toggles = Array.prototype.slice.apply(element.querySelectorAll('[data-toggle]'));
  this.element = element;

  toggles.forEach(function(toggle) {
    toggle.addEventListener('click', this.toggle.bind(this));
  }, this);
}

ToggleFactory.prototype = {
  toggle: function(event) {
    var target = event.target;

    do {
      if (target.hasAttribute('data-toggle')) {
        return target.classList.toggle('active')
      }
    } while((target = target.parentNode) !== this.element)
  }
}

//= require ./vendor/tether.min
//= require ./vendor/shepherd.min

function TourFactory(element) {
  this.root = element;
  this.openers = Array.prototype.slice.apply(element.querySelectorAll('[data-tour]'));
  this.tourOverlay = element.querySelector('.tour-overlay');
  this.initializeTour();
  this.addSteps();
  this.attachEvents();

  // Open tour immediately unless openers are specified
  if (this.openers.length === 0) {
    this.openTour();
  }
}

TourFactory.prototype = {
  initializeTour: function() {
    var that = this;

    this.tour = new Shepherd.Tour({
      defaults: {
        showCancelLink: true,
        buttons: [
          {
            text: that.tourOverlay.getAttribute('data-tour-skip'),
            classes: 'btn-default',
            action: function() {
              that.tour.cancel();
            }
          },
          {
            text: that.tourOverlay.getAttribute('data-tour-next'),
            classes: 'btn-primary',
            action: function() {
              that.clickNext();
            }
          }
        ]
      }
    });
  },
  addSteps: function() {
    var that = this;

    var steps = Array.prototype.slice.apply(document.querySelectorAll('[data-tour-step]'));
    var sortedSteps = steps.sort(function(a, b) {
      var stepA = parseInt(a.getAttribute('data-step-number'));
      var stepB = parseInt(b.getAttribute('data-step-number'));

      if (stepA > stepB) {
        return 1;
      } else if (stepA < stepB) {
        return -1;
      } else {
        return 0;
      }
    });

    sortedSteps.forEach(function(step, index) {
      var stepConfig = {
        title: step.getAttribute('data-title'),
        text: step.innerHTML,
      };

      var classes = step.getAttribute('data-classes');

      var attachToElement = step.getAttribute('data-attach-to-element');
      var attachToPosition = step.getAttribute('data-attach-to-position');
      var positionOffset = {
        left: '0 25px',
        right: '0 -25px',
        top: '25px 0',
        bottom: '-25px 0'
      }[attachToPosition];

      if (classes) {
        stepConfig.classes = classes.split(' ');
      }

      if (attachToElement && attachToPosition && positionOffset) {
        stepConfig.attachTo = {
          element: attachToElement,
          on: attachToPosition
        };

        stepConfig.tetherOptions = {
          offset: positionOffset
        }
      }

      if (sortedSteps.length - 1 === index) {
        stepConfig.buttons = [
          {
            text: that.tourOverlay.getAttribute('data-tour-done'),
            classes: 'btn-primary',
            action: that.tour.complete
          }
        ];
      }

      that.tour.addStep(stepConfig);
    });
  },
  attachEvents: function() {
    var that = this;

    that.openers.forEach(function (opener) {
      opener.addEventListener('click', that.openTour.bind(that));
    }, that);

    document.addEventListener('keyup', function(event) {
      var key = event.which || event.keyCode;

      // ESC
      if (key === 27) {
        that.tour.cancel();
      }
    });

    that.tourOverlay.addEventListener('click', function() {
      that.tour.cancel();
    });

    that.tour.on('active', function() {
      that.tourOverlay.classList.remove('overlay-hidden');
    });

    that.tour.on('inactive', function() {
      that.tourOverlay.classList.add('overlay-hidden');
    });
  },
  openTour: function() {
    this.tour.start();
    this.tourOverlay.classList.remove('tour-overlay-hidden');
  },
  clickNext: function() {
    document.dispatchEvent(new CustomEvent('next', { 'detail': this.tour.getCurrentStep() }));
    this.tour.next();
  }
};

!function(e,t){"function"==typeof define&&define.amd?define(["tether"],t):"object"==typeof exports?module.exports=t(require("tether")):e.Shepherd=t(e.Tether)}(this,function(e){"use strict";function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function i(e){var t=document.createElement("div");return t.innerHTML=e,t.children[0]}function o(e,t){var n=void 0;return"undefined"!=typeof e.matches?n=e.matches:"undefined"!=typeof e.matchesSelector?n=e.matchesSelector:"undefined"!=typeof e.msMatchesSelector?n=e.msMatchesSelector:"undefined"!=typeof e.webkitMatchesSelector?n=e.webkitMatchesSelector:"undefined"!=typeof e.mozMatchesSelector?n=e.mozMatchesSelector:"undefined"!=typeof e.oMatchesSelector&&(n=e.oMatchesSelector),n.call(e,t)}function s(e,t){if(null===e||"undefined"==typeof e)return e;if("object"==typeof e)return e;var n=e.split(" "),i=n.length,o=t.length;i>o&&(n[0]=n.slice(0,i-o+1).join(" "),n.splice(1,o));for(var s={},r=0;o>r;++r){var h=t[r];s[h]=n[r]}return s}var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),h=function(e,t,n){for(var i=!0;i;){var o=e,s=t,r=n;h=a=u=void 0,i=!1,null===o&&(o=Function.prototype);var h=Object.getOwnPropertyDescriptor(o,s);if(void 0!==h){if("value"in h)return h.value;var u=h.get;return void 0===u?void 0:u.call(r)}var a=Object.getPrototypeOf(o);if(null===a)return void 0;e=a,t=s,n=r,i=!0}},u=e.Utils,a=u.Evented,c=u.addClass,d=u.extend,l=u.hasClass,p=u.removeClass,f=u.uniqueId,v=new a,y={top:"bottom center",left:"middle right",right:"middle left",bottom:"top center",center:"middle center"},m=function(u){function a(e,n){return t(this,a),h(Object.getPrototypeOf(a.prototype),"constructor",this).call(this,e,n),this.tour=e,this.bindMethods(),this.setOptions(n),this}return n(a,u),r(a,[{key:"bindMethods",value:function(){var e=this,t=["_show","show","hide","isOpen","cancel","complete","scrollTo","destroy"];t.map(function(t){e[t]=e[t].bind(e)})}},{key:"setOptions",value:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];this.options=e,this.destroy(),this.id=this.options.id||this.id||"step-"+f();var t=this.options.when;if(t)for(var n in t)if({}.hasOwnProperty.call(t,n)){var i=t[n];this.on(n,i,this)}this.options.buttons||(this.options.buttons=[{text:"Next",action:this.tour.next}])}},{key:"getTour",value:function(){return this.tour}},{key:"bindAdvance",value:function(){var e=this,t=s(this.options.advanceOn,["selector","event"]),n=t.event,i=t.selector,r=function(t){e.isOpen()&&("undefined"!=typeof i?o(t.target,i)&&e.tour.next():e.el&&t.target===e.el&&e.tour.next())};document.body.addEventListener(n,r),this.on("destroy",function(){return document.body.removeEventListener(n,r)})}},{key:"getAttachTo",value:function(){var e=s(this.options.attachTo,["element","on"])||{},t=e.element;if("string"==typeof t&&(e.element=document.querySelector(t),!e.element))throw new Error("The element for this Shepherd step was not found "+t);return e}},{key:"setupTether",value:function(){if("undefined"==typeof e)throw new Error("Using the attachment feature of Shepherd requires the Tether library");var t=this.getAttachTo(),n=y[t.on||"right"];"undefined"==typeof t.element&&(t.element="viewport",n="middle center");var i={classPrefix:"shepherd",element:this.el,constraints:[{to:"window",pin:!0,attachment:"together"}],target:t.element,offset:t.offset||"0 0",attachment:n};this.tether&&this.tether.destroy(),this.tether=new e(d(i,this.options.tetherOptions))}},{key:"show",value:function(){var e=this;if("undefined"!=typeof this.options.beforeShowPromise){var t=this.options.beforeShowPromise();if("undefined"!=typeof t)return t.then(function(){return e._show()})}this._show()}},{key:"_show",value:function(){var e=this;this.trigger("before-show"),this.el||this.render(),c(this.el,"shepherd-open"),document.body.setAttribute("data-shepherd-step",this.id),this.setupTether(),this.options.scrollTo&&setTimeout(function(){e.scrollTo()}),this.trigger("show")}},{key:"hide",value:function(){this.trigger("before-hide"),p(this.el,"shepherd-open"),document.body.removeAttribute("data-shepherd-step"),this.tether&&this.tether.destroy(),this.tether=null,this.trigger("hide")}},{key:"isOpen",value:function(){return l(this.el,"shepherd-open")}},{key:"cancel",value:function(){this.tour.cancel(),this.trigger("cancel")}},{key:"complete",value:function(){this.tour.complete(),this.trigger("complete")}},{key:"scrollTo",value:function(){var e=this.getAttachTo(),t=e.element;"undefined"!=typeof this.options.scrollToHandler?this.options.scrollToHandler(t):"undefined"!=typeof t&&t.scrollIntoView()}},{key:"destroy",value:function(){"undefined"!=typeof this.el&&(document.body.removeChild(this.el),delete this.el),this.tether&&this.tether.destroy(),this.tether=null,this.trigger("destroy")}},{key:"render",value:function(){var e=this;"undefined"!=typeof this.el&&this.destroy(),this.el=i("<div class='shepherd-step "+(this.options.classes||"")+"' data-id='"+this.id+"' "+(this.options.idAttribute?'id="'+this.options.idAttribute+'"':"")+"></div>");var t=document.createElement("div");t.className="shepherd-content",this.el.appendChild(t);var n=document.createElement("header");if(t.appendChild(n),"undefined"!=typeof this.options.title&&(n.innerHTML+="<h3 class='shepherd-title'>"+this.options.title+"</h3>",this.el.className+=" shepherd-has-title"),this.options.showCancelLink){var o=i("<a href class='shepherd-cancel-link'>✕</a>");n.appendChild(o),this.el.className+=" shepherd-has-cancel-link",this.bindCancelLink(o)}"undefined"!=typeof this.options.text&&!function(){var n=i("<div class='shepherd-text'></div>"),o=e.options.text;"function"==typeof o&&(o=o.call(e,n)),o instanceof HTMLElement?n.appendChild(o):("string"==typeof o&&(o=[o]),o.map(function(e){n.innerHTML+="<p>"+e+"</p>"})),t.appendChild(n)}();var s=document.createElement("footer");this.options.buttons&&!function(){var t=i("<ul class='shepherd-buttons'></ul>");e.options.buttons.map(function(n){var o=i("<li><a class='shepherd-button "+(n.classes||"")+"'>"+n.text+"</a>");t.appendChild(o),e.bindButtonEvents(n,o.querySelector("a"))}),s.appendChild(t)}(),t.appendChild(s),document.body.appendChild(this.el),this.setupTether(),this.options.advanceOn&&this.bindAdvance()}},{key:"bindCancelLink",value:function(e){var t=this;e.addEventListener("click",function(e){e.preventDefault(),t.cancel()})}},{key:"bindButtonEvents",value:function(e,t){var n=this;e.events=e.events||{},"undefined"!=typeof e.action&&(e.events.click=e.action);for(var i in e.events)if({}.hasOwnProperty.call(e.events,i)){var o=e.events[i];"string"==typeof o&&!function(){var e=o;o=function(){return n.tour.show(e)}}(),t.addEventListener(i,o)}this.on("destroy",function(){for(var n in e.events)if({}.hasOwnProperty.call(e.events,n)){var i=e.events[n];t.removeEventListener(n,i)}})}}]),a}(a),g=function(e){function i(){var e=this,n=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];t(this,i),h(Object.getPrototypeOf(i.prototype),"constructor",this).call(this,n),this.bindMethods(),this.options=n,this.steps=this.options.steps||[];var o=["complete","cancel","hide","start","show","active","inactive"];return o.map(function(t){!function(t){e.on(t,function(n){n=n||{},n.tour=e,v.trigger(t,n)})}(t)}),this}return n(i,e),r(i,[{key:"bindMethods",value:function(){var e=this,t=["next","back","cancel","complete","hide"];t.map(function(t){e[t]=e[t].bind(e)})}},{key:"addStep",value:function(e,t){return"undefined"==typeof t&&(t=e),t instanceof m?t.tour=this:(("string"==typeof e||"number"==typeof e)&&(t.id=e.toString()),t=d({},this.options.defaults,t),t=new m(this,t)),this.steps.push(t),this}},{key:"getById",value:function(e){for(var t=0;t<this.steps.length;++t){var n=this.steps[t];if(n.id===e)return n}}},{key:"getCurrentStep",value:function(){return this.currentStep}},{key:"next",value:function(){var e=this.steps.indexOf(this.currentStep);e===this.steps.length-1?(this.hide(e),this.trigger("complete"),this.done()):this.show(e+1,!0)}},{key:"back",value:function(){var e=this.steps.indexOf(this.currentStep);this.show(e-1,!1)}},{key:"cancel",value:function(){"undefined"!=typeof this.currentStep&&this.currentStep.hide(),this.trigger("cancel"),this.done()}},{key:"complete",value:function(){"undefined"!=typeof this.currentStep&&this.currentStep.hide(),this.trigger("complete"),this.done()}},{key:"hide",value:function(){"undefined"!=typeof this.currentStep&&this.currentStep.hide(),this.trigger("hide"),this.done()}},{key:"done",value:function(){v.activeTour=null,p(document.body,"shepherd-active"),this.trigger("inactive",{tour:this})}},{key:"show",value:function(){var e=arguments.length<=0||void 0===arguments[0]?0:arguments[0],t=arguments.length<=1||void 0===arguments[1]?!0:arguments[1];this.currentStep?this.currentStep.hide():(c(document.body,"shepherd-active"),this.trigger("active",{tour:this})),v.activeTour=this;var n=void 0;if(n="string"==typeof e?this.getById(e):this.steps[e])if("undefined"==typeof n.options.showOn||n.options.showOn())this.trigger("show",{step:n,previous:this.currentStep}),this.currentStep=n,n.show();else{var i=this.steps.indexOf(n),o=t?i+1:i-1;this.show(o,t)}}},{key:"start",value:function(){this.trigger("start"),this.currentStep=null,this.next()}}]),i}(a);return d(v,{Tour:g,Step:m,Evented:a}),v});
!function(t,e){"function"==typeof define&&define.amd?define(e):"object"==typeof exports?module.exports=e(require,exports,module):t.Tether=e()}(this,function(t,e,o){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t){var e=getComputedStyle(t)||{},o=e.position;if("fixed"===o)return t;for(var i=t;i=i.parentNode;){var n=void 0;try{n=getComputedStyle(i)}catch(r){}if("undefined"==typeof n||null===n)return i;var s=n,a=s.overflow,f=s.overflowX,h=s.overflowY;if(/(auto|scroll)/.test(a+h+f)&&("absolute"!==o||["relative","absolute","fixed"].indexOf(n.position)>=0))return i}return document.body}function r(t){var e=void 0;t===document?(e=document,t=document.documentElement):e=t.ownerDocument;var o=e.documentElement,i={},n=t.getBoundingClientRect();for(var r in n)i[r]=n[r];var s=x(e);return i.top-=s.top,i.left-=s.left,"undefined"==typeof i.width&&(i.width=document.body.scrollWidth-i.left-i.right),"undefined"==typeof i.height&&(i.height=document.body.scrollHeight-i.top-i.bottom),i.top=i.top-o.clientTop,i.left=i.left-o.clientLeft,i.right=e.body.clientWidth-i.width-i.left,i.bottom=e.body.clientHeight-i.height-i.top,i}function s(t){return t.offsetParent||document.documentElement}function a(){var t=document.createElement("div");t.style.width="100%",t.style.height="200px";var e=document.createElement("div");f(e.style,{position:"absolute",top:0,left:0,pointerEvents:"none",visibility:"hidden",width:"200px",height:"150px",overflow:"hidden"}),e.appendChild(t),document.body.appendChild(e);var o=t.offsetWidth;e.style.overflow="scroll";var i=t.offsetWidth;o===i&&(i=e.clientWidth),document.body.removeChild(e);var n=o-i;return{width:n,height:n}}function f(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],e=[];return Array.prototype.push.apply(e,arguments),e.slice(1).forEach(function(e){if(e)for(var o in e)({}).hasOwnProperty.call(e,o)&&(t[o]=e[o])}),t}function h(t,e){if("undefined"!=typeof t.classList)e.split(" ").forEach(function(e){e.trim()&&t.classList.remove(e)});else{var o=new RegExp("(^| )"+e.split(" ").join("|")+"( |$)","gi"),i=u(t).replace(o," ");p(t,i)}}function l(t,e){if("undefined"!=typeof t.classList)e.split(" ").forEach(function(e){e.trim()&&t.classList.add(e)});else{h(t,e);var o=u(t)+(" "+e);p(t,o)}}function d(t,e){if("undefined"!=typeof t.classList)return t.classList.contains(e);var o=u(t);return new RegExp("(^| )"+e+"( |$)","gi").test(o)}function u(t){return t.className instanceof SVGAnimatedString?t.className.baseVal:t.className}function p(t,e){t.setAttribute("class",e)}function c(t,e,o){o.forEach(function(o){-1===e.indexOf(o)&&d(t,o)&&h(t,o)}),e.forEach(function(e){d(t,e)||l(t,e)})}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function g(t,e){var o=arguments.length<=2||void 0===arguments[2]?1:arguments[2];return t+o>=e&&e>=t-o}function m(){return"undefined"!=typeof performance&&"undefined"!=typeof performance.now?performance.now():+new Date}function v(){for(var t={top:0,left:0},e=arguments.length,o=Array(e),i=0;e>i;i++)o[i]=arguments[i];return o.forEach(function(e){var o=e.top,i=e.left;"string"==typeof o&&(o=parseFloat(o,10)),"string"==typeof i&&(i=parseFloat(i,10)),t.top+=o,t.left+=i}),t}function y(t,e){return"string"==typeof t.left&&-1!==t.left.indexOf("%")&&(t.left=parseFloat(t.left,10)/100*e.width),"string"==typeof t.top&&-1!==t.top.indexOf("%")&&(t.top=parseFloat(t.top,10)/100*e.height),t}function b(t,e){return"scrollParent"===e?e=t.scrollParent:"window"===e&&(e=[pageXOffset,pageYOffset,innerWidth+pageXOffset,innerHeight+pageYOffset]),e===document&&(e=e.documentElement),"undefined"!=typeof e.nodeType&&!function(){var t=r(e),o=t,i=getComputedStyle(e);e=[o.left,o.top,t.width+o.left,t.height+o.top],U.forEach(function(t,o){t=t[0].toUpperCase()+t.substr(1),"Top"===t||"Left"===t?e[o]+=parseFloat(i["border"+t+"Width"]):e[o]-=parseFloat(i["border"+t+"Width"])})}(),e}var w=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}(),C=void 0;"undefined"==typeof C&&(C={modules:[]});var O=function(){var t=0;return function(){return++t}}(),E={},x=function(t){var e=t._tetherZeroElement;"undefined"==typeof e&&(e=t.createElement("div"),e.setAttribute("data-tether-id",O()),f(e.style,{top:0,left:0,position:"absolute"}),t.body.appendChild(e),t._tetherZeroElement=e);var o=e.getAttribute("data-tether-id");if("undefined"==typeof E[o]){E[o]={};var i=e.getBoundingClientRect();for(var n in i)E[o][n]=i[n];T(function(){delete E[o]})}return E[o]},A=[],T=function(t){A.push(t)},S=function(){for(var t=void 0;t=A.pop();)t()},W=function(){function t(){i(this,t)}return w(t,[{key:"on",value:function(t,e,o){var i=arguments.length<=3||void 0===arguments[3]?!1:arguments[3];"undefined"==typeof this.bindings&&(this.bindings={}),"undefined"==typeof this.bindings[t]&&(this.bindings[t]=[]),this.bindings[t].push({handler:e,ctx:o,once:i})}},{key:"once",value:function(t,e,o){this.on(t,e,o,!0)}},{key:"off",value:function(t,e){if("undefined"==typeof this.bindings||"undefined"==typeof this.bindings[t])if("undefined"==typeof e)delete this.bindings[t];else for(var o=0;o<this.bindings[t].length;)this.bindings[t][o].handler===e?this.bindings[t].splice(o,1):++o}},{key:"trigger",value:function(t){if("undefined"!=typeof this.bindings&&this.bindings[t]){for(var e=0,o=arguments.length,i=Array(o>1?o-1:0),n=1;o>n;n++)i[n-1]=arguments[n];for(;e<this.bindings[t].length;){var r=this.bindings[t][e],s=r.handler,a=r.ctx,f=r.once,h=a;"undefined"==typeof h&&(h=this),s.apply(h,i),f?this.bindings[t].splice(e,1):++e}}}}]),t}();C.Utils={getScrollParent:n,getBounds:r,getOffsetParent:s,extend:f,addClass:l,removeClass:h,hasClass:d,updateClasses:c,defer:T,flush:S,uniqueId:O,Evented:W,getScrollBarSize:a};var M=function(){function t(t,e){var o=[],i=!0,n=!1,r=void 0;try{for(var s,a=t[Symbol.iterator]();!(i=(s=a.next()).done)&&(o.push(s.value),!e||o.length!==e);i=!0);}catch(f){n=!0,r=f}finally{try{!i&&a["return"]&&a["return"]()}finally{if(n)throw r}}return o}return function(e,o){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,o);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),w=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}();if("undefined"==typeof C)throw new Error("You must include the utils.js file before tether.js");var P=C.Utils,n=P.getScrollParent,r=P.getBounds,s=P.getOffsetParent,f=P.extend,l=P.addClass,h=P.removeClass,c=P.updateClasses,T=P.defer,S=P.flush,a=P.getScrollBarSize,k=function(){if("undefined"==typeof document)return"";for(var t=document.createElement("div"),e=["transform","webkitTransform","OTransform","MozTransform","msTransform"],o=0;o<e.length;++o){var i=e[o];if(void 0!==t.style[i])return i}}(),B=[],_=function(){B.forEach(function(t){t.position(!1)}),S()};!function(){var t=null,e=null,o=null,i=function n(){return"undefined"!=typeof e&&e>16?(e=Math.min(e-16,250),void(o=setTimeout(n,250))):void("undefined"!=typeof t&&m()-t<10||("undefined"!=typeof o&&(clearTimeout(o),o=null),t=m(),_(),e=m()-t))};"undefined"!=typeof window&&["resize","scroll","touchmove"].forEach(function(t){window.addEventListener(t,i)})}();var z={center:"center",left:"right",right:"left"},F={middle:"middle",top:"bottom",bottom:"top"},L={top:0,left:0,middle:"50%",center:"50%",bottom:"100%",right:"100%"},Y=function(t,e){var o=t.left,i=t.top;return"auto"===o&&(o=z[e.left]),"auto"===i&&(i=F[e.top]),{left:o,top:i}},H=function(t){var e=t.left,o=t.top;return"undefined"!=typeof L[t.left]&&(e=L[t.left]),"undefined"!=typeof L[t.top]&&(o=L[t.top]),{left:e,top:o}},X=function(t){var e=t.split(" "),o=M(e,2),i=o[0],n=o[1];return{top:i,left:n}},j=X,N=function(){function t(e){var o=this;i(this,t),this.position=this.position.bind(this),B.push(this),this.history=[],this.setOptions(e,!1),C.modules.forEach(function(t){"undefined"!=typeof t.initialize&&t.initialize.call(o)}),this.position()}return w(t,[{key:"getClass",value:function(){var t=arguments.length<=0||void 0===arguments[0]?"":arguments[0],e=this.options.classes;return"undefined"!=typeof e&&e[t]?this.options.classes[t]:this.options.classPrefix?this.options.classPrefix+"-"+t:t}},{key:"setOptions",value:function(t){var e=this,o=arguments.length<=1||void 0===arguments[1]?!0:arguments[1],i={offset:"0 0",targetOffset:"0 0",targetAttachment:"auto auto",classPrefix:"tether"};this.options=f(i,t);var r=this.options,s=r.element,a=r.target,h=r.targetModifier;if(this.element=s,this.target=a,this.targetModifier=h,"viewport"===this.target?(this.target=document.body,this.targetModifier="visible"):"scroll-handle"===this.target&&(this.target=document.body,this.targetModifier="scroll-handle"),["element","target"].forEach(function(t){if("undefined"==typeof e[t])throw new Error("Tether Error: Both element and target must be defined");"undefined"!=typeof e[t].jquery?e[t]=e[t][0]:"string"==typeof e[t]&&(e[t]=document.querySelector(e[t]))}),l(this.element,this.getClass("element")),this.options.addTargetClasses!==!1&&l(this.target,this.getClass("target")),!this.options.attachment)throw new Error("Tether Error: You must provide an attachment");this.targetAttachment=j(this.options.targetAttachment),this.attachment=j(this.options.attachment),this.offset=X(this.options.offset),this.targetOffset=X(this.options.targetOffset),"undefined"!=typeof this.scrollParent&&this.disable(),"scroll-handle"===this.targetModifier?this.scrollParent=this.target:this.scrollParent=n(this.target),this.options.enabled!==!1&&this.enable(o)}},{key:"getTargetBounds",value:function(){if("undefined"==typeof this.targetModifier)return r(this.target);if("visible"===this.targetModifier){if(this.target===document.body)return{top:pageYOffset,left:pageXOffset,height:innerHeight,width:innerWidth};var t=r(this.target),e={height:t.height,width:t.width,top:t.top,left:t.left};return e.height=Math.min(e.height,t.height-(pageYOffset-t.top)),e.height=Math.min(e.height,t.height-(t.top+t.height-(pageYOffset+innerHeight))),e.height=Math.min(innerHeight,e.height),e.height-=2,e.width=Math.min(e.width,t.width-(pageXOffset-t.left)),e.width=Math.min(e.width,t.width-(t.left+t.width-(pageXOffset+innerWidth))),e.width=Math.min(innerWidth,e.width),e.width-=2,e.top<pageYOffset&&(e.top=pageYOffset),e.left<pageXOffset&&(e.left=pageXOffset),e}if("scroll-handle"===this.targetModifier){var t=void 0,o=this.target;o===document.body?(o=document.documentElement,t={left:pageXOffset,top:pageYOffset,height:innerHeight,width:innerWidth}):t=r(o);var i=getComputedStyle(o),n=o.scrollWidth>o.clientWidth||[i.overflow,i.overflowX].indexOf("scroll")>=0||this.target!==document.body,s=0;n&&(s=15);var a=t.height-parseFloat(i.borderTopWidth)-parseFloat(i.borderBottomWidth)-s,e={width:15,height:.975*a*(a/o.scrollHeight),left:t.left+t.width-parseFloat(i.borderLeftWidth)-15},f=0;408>a&&this.target===document.body&&(f=-11e-5*Math.pow(a,2)-.00727*a+22.58),this.target!==document.body&&(e.height=Math.max(e.height,24));var h=this.target.scrollTop/(o.scrollHeight-a);return e.top=h*(a-e.height-f)+t.top+parseFloat(i.borderTopWidth),this.target===document.body&&(e.height=Math.max(e.height,24)),e}}},{key:"clearCache",value:function(){this._cache={}}},{key:"cache",value:function(t,e){return"undefined"==typeof this._cache&&(this._cache={}),"undefined"==typeof this._cache[t]&&(this._cache[t]=e.call(this)),this._cache[t]}},{key:"enable",value:function(){var t=arguments.length<=0||void 0===arguments[0]?!0:arguments[0];this.options.addTargetClasses!==!1&&l(this.target,this.getClass("enabled")),l(this.element,this.getClass("enabled")),this.enabled=!0,this.scrollParent!==document&&this.scrollParent.addEventListener("scroll",this.position),t&&this.position()}},{key:"disable",value:function(){h(this.target,this.getClass("enabled")),h(this.element,this.getClass("enabled")),this.enabled=!1,"undefined"!=typeof this.scrollParent&&this.scrollParent.removeEventListener("scroll",this.position)}},{key:"destroy",value:function(){var t=this;this.disable(),B.forEach(function(e,o){return e===t?void B.splice(o,1):void 0})}},{key:"updateAttachClasses",value:function(t,e){var o=this;t=t||this.attachment,e=e||this.targetAttachment;var i=["left","top","bottom","right","middle","center"];"undefined"!=typeof this._addAttachClasses&&this._addAttachClasses.length&&this._addAttachClasses.splice(0,this._addAttachClasses.length),"undefined"==typeof this._addAttachClasses&&(this._addAttachClasses=[]);var n=this._addAttachClasses;t.top&&n.push(this.getClass("element-attached")+"-"+t.top),t.left&&n.push(this.getClass("element-attached")+"-"+t.left),e.top&&n.push(this.getClass("target-attached")+"-"+e.top),e.left&&n.push(this.getClass("target-attached")+"-"+e.left);var r=[];i.forEach(function(t){r.push(o.getClass("element-attached")+"-"+t),r.push(o.getClass("target-attached")+"-"+t)}),T(function(){"undefined"!=typeof o._addAttachClasses&&(c(o.element,o._addAttachClasses,r),o.options.addTargetClasses!==!1&&c(o.target,o._addAttachClasses,r),delete o._addAttachClasses)})}},{key:"position",value:function(){var t=this,e=arguments.length<=0||void 0===arguments[0]?!0:arguments[0];if(this.enabled){this.clearCache();var o=Y(this.targetAttachment,this.attachment);this.updateAttachClasses(this.attachment,o);var i=this.cache("element-bounds",function(){return r(t.element)}),n=i.width,f=i.height;if(0===n&&0===f&&"undefined"!=typeof this.lastSize){var h=this.lastSize;n=h.width,f=h.height}else this.lastSize={width:n,height:f};var l=this.cache("target-bounds",function(){return t.getTargetBounds()}),d=l,u=y(H(this.attachment),{width:n,height:f}),p=y(H(o),d),c=y(this.offset,{width:n,height:f}),g=y(this.targetOffset,d);u=v(u,c),p=v(p,g);for(var m=l.left+p.left-u.left,b=l.top+p.top-u.top,w=0;w<C.modules.length;++w){var O=C.modules[w],E=O.position.call(this,{left:m,top:b,targetAttachment:o,targetPos:l,elementPos:i,offset:u,targetOffset:p,manualOffset:c,manualTargetOffset:g,scrollbarSize:A,attachment:this.attachment});if(E===!1)return!1;"undefined"!=typeof E&&"object"==typeof E&&(b=E.top,m=E.left)}var x={page:{top:b,left:m},viewport:{top:b-pageYOffset,bottom:pageYOffset-b-f+innerHeight,left:m-pageXOffset,right:pageXOffset-m-n+innerWidth}},A=void 0;return document.body.scrollWidth>window.innerWidth&&(A=this.cache("scrollbar-size",a),x.viewport.bottom-=A.height),document.body.scrollHeight>window.innerHeight&&(A=this.cache("scrollbar-size",a),x.viewport.right-=A.width),(-1===["","static"].indexOf(document.body.style.position)||-1===["","static"].indexOf(document.body.parentElement.style.position))&&(x.page.bottom=document.body.scrollHeight-b-f,x.page.right=document.body.scrollWidth-m-n),"undefined"!=typeof this.options.optimizations&&this.options.optimizations.moveElement!==!1&&"undefined"==typeof this.targetModifier&&!function(){var e=t.cache("target-offsetparent",function(){return s(t.target)}),o=t.cache("target-offsetparent-bounds",function(){return r(e)}),i=getComputedStyle(e),n=o,a={};if(["Top","Left","Bottom","Right"].forEach(function(t){a[t.toLowerCase()]=parseFloat(i["border"+t+"Width"])}),o.right=document.body.scrollWidth-o.left-n.width+a.right,o.bottom=document.body.scrollHeight-o.top-n.height+a.bottom,x.page.top>=o.top+a.top&&x.page.bottom>=o.bottom&&x.page.left>=o.left+a.left&&x.page.right>=o.right){var f=e.scrollTop,h=e.scrollLeft;x.offset={top:x.page.top-o.top+f-a.top,left:x.page.left-o.left+h-a.left}}}(),this.move(x),this.history.unshift(x),this.history.length>3&&this.history.pop(),e&&S(),!0}}},{key:"move",value:function(t){var e=this;if("undefined"!=typeof this.element.parentNode){var o={};for(var i in t){o[i]={};for(var n in t[i]){for(var r=!1,a=0;a<this.history.length;++a){var h=this.history[a];if("undefined"!=typeof h[i]&&!g(h[i][n],t[i][n])){r=!0;break}}r||(o[i][n]=!0)}}var l={top:"",left:"",right:"",bottom:""},d=function(t,o){var i="undefined"!=typeof e.options.optimizations,n=i?e.options.optimizations.gpu:null;if(n!==!1){var r=void 0,s=void 0;t.top?(l.top=0,r=o.top):(l.bottom=0,r=-o.bottom),t.left?(l.left=0,s=o.left):(l.right=0,s=-o.right),l[k]="translateX("+Math.round(s)+"px) translateY("+Math.round(r)+"px)","msTransform"!==k&&(l[k]+=" translateZ(0)")}else t.top?l.top=o.top+"px":l.bottom=o.bottom+"px",t.left?l.left=o.left+"px":l.right=o.right+"px"},u=!1;if((o.page.top||o.page.bottom)&&(o.page.left||o.page.right)?(l.position="absolute",d(o.page,t.page)):(o.viewport.top||o.viewport.bottom)&&(o.viewport.left||o.viewport.right)?(l.position="fixed",d(o.viewport,t.viewport)):"undefined"!=typeof o.offset&&o.offset.top&&o.offset.left?!function(){l.position="absolute";var i=e.cache("target-offsetparent",function(){return s(e.target)});s(e.element)!==i&&T(function(){e.element.parentNode.removeChild(e.element),i.appendChild(e.element)}),d(o.offset,t.offset),u=!0}():(l.position="absolute",d({top:!0,left:!0},t.page)),!u){for(var p=!0,c=this.element.parentNode;c&&"BODY"!==c.tagName;){if("static"!==getComputedStyle(c).position){p=!1;break}c=c.parentNode}p||(this.element.parentNode.removeChild(this.element),document.body.appendChild(this.element))}var m={},v=!1;for(var n in l){var y=l[n],b=this.element.style[n];""!==b&&""!==y&&["top","left","bottom","right"].indexOf(n)>=0&&(b=parseFloat(b),y=parseFloat(y)),b!==y&&(v=!0,m[n]=y)}v&&T(function(){f(e.element.style,m)})}}}]),t}();N.modules=[],C.position=_;var R=f(N,C),M=function(){function t(t,e){var o=[],i=!0,n=!1,r=void 0;try{for(var s,a=t[Symbol.iterator]();!(i=(s=a.next()).done)&&(o.push(s.value),!e||o.length!==e);i=!0);}catch(f){n=!0,r=f}finally{try{!i&&a["return"]&&a["return"]()}finally{if(n)throw r}}return o}return function(e,o){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,o);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),P=C.Utils,r=P.getBounds,f=P.extend,c=P.updateClasses,T=P.defer,U=["left","top","right","bottom"];C.modules.push({position:function(t){var e=this,o=t.top,i=t.left,n=t.targetAttachment;if(!this.options.constraints)return!0;var s=this.cache("element-bounds",function(){return r(e.element)}),a=s.height,h=s.width;if(0===h&&0===a&&"undefined"!=typeof this.lastSize){var l=this.lastSize;h=l.width,a=l.height}var d=this.cache("target-bounds",function(){return e.getTargetBounds()}),u=d.height,p=d.width,g=[this.getClass("pinned"),this.getClass("out-of-bounds")];this.options.constraints.forEach(function(t){var e=t.outOfBoundsClass,o=t.pinnedClass;e&&g.push(e),o&&g.push(o)}),g.forEach(function(t){["left","top","right","bottom"].forEach(function(e){g.push(t+"-"+e)})});var m=[],v=f({},n),y=f({},this.attachment);return this.options.constraints.forEach(function(t){var r=t.to,s=t.attachment,f=t.pin;"undefined"==typeof s&&(s="");var l=void 0,d=void 0;if(s.indexOf(" ")>=0){var c=s.split(" "),g=M(c,2);d=g[0],l=g[1]}else l=d=s;var w=b(e,r);("target"===d||"both"===d)&&(o<w[1]&&"top"===v.top&&(o+=u,v.top="bottom"),o+a>w[3]&&"bottom"===v.top&&(o-=u,v.top="top")),"together"===d&&(o<w[1]&&"top"===v.top&&("bottom"===y.top?(o+=u,v.top="bottom",o+=a,y.top="top"):"top"===y.top&&(o+=u,v.top="bottom",o-=a,y.top="bottom")),o+a>w[3]&&"bottom"===v.top&&("top"===y.top?(o-=u,v.top="top",o-=a,y.top="bottom"):"bottom"===y.top&&(o-=u,v.top="top",o+=a,y.top="top")),"middle"===v.top&&(o+a>w[3]&&"top"===y.top?(o-=a,y.top="bottom"):o<w[1]&&"bottom"===y.top&&(o+=a,y.top="top"))),("target"===l||"both"===l)&&(i<w[0]&&"left"===v.left&&(i+=p,v.left="right"),i+h>w[2]&&"right"===v.left&&(i-=p,v.left="left")),"together"===l&&(i<w[0]&&"left"===v.left?"right"===y.left?(i+=p,v.left="right",i+=h,y.left="left"):"left"===y.left&&(i+=p,v.left="right",i-=h,y.left="right"):i+h>w[2]&&"right"===v.left?"left"===y.left?(i-=p,v.left="left",i-=h,y.left="right"):"right"===y.left&&(i-=p,v.left="left",i+=h,y.left="left"):"center"===v.left&&(i+h>w[2]&&"left"===y.left?(i-=h,y.left="right"):i<w[0]&&"right"===y.left&&(i+=h,y.left="left"))),("element"===d||"both"===d)&&(o<w[1]&&"bottom"===y.top&&(o+=a,y.top="top"),o+a>w[3]&&"top"===y.top&&(o-=a,y.top="bottom")),("element"===l||"both"===l)&&(i<w[0]&&("right"===y.left?(i+=h,y.left="left"):"center"===y.left&&(i+=h/2,y.left="left")),i+h>w[2]&&("left"===y.left?(i-=h,y.left="right"):"center"===y.left&&(i-=h/2,y.left="right"))),"string"==typeof f?f=f.split(",").map(function(t){return t.trim()}):f===!0&&(f=["top","left","right","bottom"]),f=f||[];var C=[],O=[];o<w[1]&&(f.indexOf("top")>=0?(o=w[1],C.push("top")):O.push("top")),o+a>w[3]&&(f.indexOf("bottom")>=0?(o=w[3]-a,C.push("bottom")):O.push("bottom")),i<w[0]&&(f.indexOf("left")>=0?(i=w[0],C.push("left")):O.push("left")),i+h>w[2]&&(f.indexOf("right")>=0?(i=w[2]-h,C.push("right")):O.push("right")),C.length&&!function(){var t=void 0;t="undefined"!=typeof e.options.pinnedClass?e.options.pinnedClass:e.getClass("pinned"),m.push(t),C.forEach(function(e){m.push(t+"-"+e)})}(),O.length&&!function(){var t=void 0;t="undefined"!=typeof e.options.outOfBoundsClass?e.options.outOfBoundsClass:e.getClass("out-of-bounds"),m.push(t),O.forEach(function(e){m.push(t+"-"+e)})}(),(C.indexOf("left")>=0||C.indexOf("right")>=0)&&(y.left=v.left=!1),(C.indexOf("top")>=0||C.indexOf("bottom")>=0)&&(y.top=v.top=!1),(v.top!==n.top||v.left!==n.left||y.top!==e.attachment.top||y.left!==e.attachment.left)&&e.updateAttachClasses(y,v)}),T(function(){e.options.addTargetClasses!==!1&&c(e.target,m,g),c(e.element,m,g)}),{top:o,left:i}}});var P=C.Utils,r=P.getBounds,c=P.updateClasses,T=P.defer;C.modules.push({position:function(t){var e=this,o=t.top,i=t.left,n=this.cache("element-bounds",function(){return r(e.element)}),s=n.height,a=n.width,f=this.getTargetBounds(),h=o+s,l=i+a,d=[];o<=f.bottom&&h>=f.top&&["left","right"].forEach(function(t){var e=f[t];(e===i||e===l)&&d.push(t)}),i<=f.right&&l>=f.left&&["top","bottom"].forEach(function(t){var e=f[t];(e===o||e===h)&&d.push(t)});var u=[],p=[],g=["left","top","right","bottom"];return u.push(this.getClass("abutted")),g.forEach(function(t){u.push(e.getClass("abutted")+"-"+t)}),d.length&&p.push(this.getClass("abutted")),d.forEach(function(t){p.push(e.getClass("abutted")+"-"+t)}),T(function(){e.options.addTargetClasses!==!1&&c(e.target,p,u),c(e.element,p,u)}),!0}});var M=function(){function t(t,e){var o=[],i=!0,n=!1,r=void 0;try{for(var s,a=t[Symbol.iterator]();!(i=(s=a.next()).done)&&(o.push(s.value),!e||o.length!==e);i=!0);}catch(f){n=!0,r=f}finally{try{!i&&a["return"]&&a["return"]()}finally{if(n)throw r}}return o}return function(e,o){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,o);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();return C.modules.push({position:function(t){var e=t.top,o=t.left;if(this.options.shift){var i=this.options.shift;"function"==typeof this.options.shift&&(i=this.options.shift.call(this,{top:e,left:o}));var n=void 0,r=void 0;if("string"==typeof i){i=i.split(" "),i[1]=i[1]||i[0];var s=i,a=M(s,2);n=a[0],r=a[1],n=parseFloat(n,10),r=parseFloat(r,10)}else n=i.top,r=i.left;return e+=n,o+=r,{top:e,left:o}}}}),R});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImRyb3Bkb3duLmpzIiwiZmxhbm5lbC5qcyIsImZseW91dC5qcyIsIm1lbnUuanMiLCJtb2RhbC5qcyIsInRvZ2dsZS5qcyIsInRvdXIuanMiLCJ2ZW5kb3Ivc2hlcGhlcmQubWluLmpzIiwidmVuZG9yL3RldGhlci5taW4uanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQzNDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNuQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQy9CQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDdEJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDbkRBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ3BCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDOUlBO0FDQUEiLCJmaWxlIjoic3R5bGVndWlkZS5qcyIsInNvdXJjZXNDb250ZW50IjpbImZ1bmN0aW9uIERyb3BEb3duKGVsZW1lbnQpIHtcbiAgdGhpcy5kZCA9IGVsZW1lbnQ7XG4gIHRoaXMub3JpZW50YXRpb24gPSBlbGVtZW50LmdldEF0dHJpYnV0ZSgnZGF0YS1vcmllbnRhdGlvbicpIHx8ICdib3R0b20nO1xuICB0aGlzLmRkLmNsYXNzTGlzdC5hZGQoJ2Ryb3Bkb3duLW9yaWVudGF0aW9uLScgKyB0aGlzLm9yaWVudGF0aW9uKTtcblxuICB0aGlzLnBsYWNlaG9sZGVyID0gdGhpcy5kZC5xdWVyeVNlbGVjdG9yKCdzcGFuJyk7XG4gIHRoaXMub3B0cyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKHRoaXMuZGQucXVlcnlTZWxlY3RvckFsbCgnLmRyb3Bkb3duLW9wdGlvbnMgPiBsaScpKTtcbiAgdGhpcy52YWwgPSAnJztcbiAgdGhpcy5pbmRleCA9IC0xO1xuXG4gIHRoaXMuaW5pdEV2ZW50cygpO1xufVxuXG5Ecm9wRG93bi5wcm90b3R5cGUgPSB7XG4gIGluaXRFdmVudHM6IGZ1bmN0aW9uKCkge1xuICAgIHZhciBvYmogPSB0aGlzO1xuXG4gICAgb2JqLmRkLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgb2JqLmRkLmNsYXNzTGlzdC50b2dnbGUoJ2FjdGl2ZScpO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH0pO1xuXG4gICAgb2JqLm9wdHMuZm9yRWFjaChmdW5jdGlvbihvcHQpIHtcbiAgICAgIG9wdC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICAgICAgdmFyIG5vZGUgPSBvcHQ7XG4gICAgICAgIHZhciBpbmRleCA9IDA7XG5cbiAgICAgICAgd2hpbGUgKChub2RlID0gbm9kZS5wcmV2aW91c0VsZW1lbnRTaWJsaW5nKSAhPT0gbnVsbCkge1xuICAgICAgICAgIGluZGV4Kys7XG4gICAgICAgIH1cblxuICAgICAgICBvYmoudmFsID0gb3B0LnRleHRDb250ZW50O1xuICAgICAgICBvYmouaW5kZXggPSBpbmRleDtcbiAgICAgICAgb2JqLnBsYWNlaG9sZGVyLnRleHRDb250ZW50ID0gJ0dlbmRlcjogJyArIG9iai52YWw7XG5cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cbn1cbiIsImZ1bmN0aW9uIEZsYW5uZWxGYWN0b3J5KGVsZW1lbnQpIHtcbiAgdmFyIHBhZGRpbmcgPSAxMDtcbiAgdmFyIGhvdmVyYWJsZXMgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuYXBwbHkoZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnW2RhdGEtZmxhbm5lbF0nKSk7XG5cbiAgaG92ZXJhYmxlcy5mb3JFYWNoKGZ1bmN0aW9uKGhvdmVyYWJsZSkge1xuICAgIHZhciBmbGFubmVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignIycgKyBob3ZlcmFibGUuZ2V0QXR0cmlidXRlKCdkYXRhLWZsYW5uZWwnKSk7XG4gICAgdmFyIGRpc21pc3NhbHMgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuYXBwbHkoZmxhbm5lbC5xdWVyeVNlbGVjdG9yQWxsKCdbZGF0YS1mbGFubmVsLWRpc21pc3NdJykpO1xuXG4gICAgZGlzbWlzc2Fscy5mb3JFYWNoKGZ1bmN0aW9uKGRpc21pc3NhbCkge1xuICAgICAgZGlzbWlzc2FsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oKSB7XG4gICAgICAgIGZsYW5uZWwuY2xhc3NMaXN0LmFkZCgnZmxhbm5lbC1oaWRkZW4nKTtcbiAgICAgICAgaG92ZXJhYmxlLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBob3ZlcmFibGUuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbigpIHtcbiAgICAgIGZsYW5uZWwuY2xhc3NMaXN0LnRvZ2dsZSgnZmxhbm5lbC1oaWRkZW4nKTtcbiAgICAgIHZhciBub2RlID0gaG92ZXJhYmxlO1xuICAgICAgdmFyIGxlZnQgPSAwO1xuICAgICAgdmFyIHRvcCA9IDA7XG5cbiAgICAgIGRvIHtcbiAgICAgICAgbGVmdCArPSBub2RlLm9mZnNldExlZnQ7XG4gICAgICAgIHRvcCArPSBub2RlLm9mZnNldFRvcDtcbiAgICAgIH0gd2hpbGUgKChub2RlID0gbm9kZS5vZmZzZXRQYXJlbnQpICE9PSBudWxsKTtcblxuICAgICAgbGVmdCA9IGxlZnQgKyBob3ZlcmFibGUub2Zmc2V0V2lkdGggLyAyO1xuICAgICAgdG9wID0gdG9wICsgaG92ZXJhYmxlLm9mZnNldEhlaWdodCArIHBhZGRpbmc7XG5cbiAgICAgIGZsYW5uZWwuc3R5bGUubGVmdCA9IGxlZnQgKyAncHgnO1xuICAgICAgZmxhbm5lbC5zdHlsZS50b3AgPSB0b3AgKyAncHgnO1xuICAgIH0pO1xuICB9KTtcblxufVxuIiwiZnVuY3Rpb24gRmx5b3V0RmFjdG9yeShlbGVtZW50KSB7XG4gIHZhciBwYWRkaW5nID0gMTA7XG4gIHZhciBob3ZlcmFibGVzID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmFwcGx5KGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ1tkYXRhLWZseW91dF0nKSk7XG5cbiAgaG92ZXJhYmxlcy5mb3JFYWNoKGZ1bmN0aW9uKGhvdmVyYWJsZSkge1xuICAgIHZhciBmbHlvdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjJyArIGhvdmVyYWJsZS5nZXRBdHRyaWJ1dGUoJ2RhdGEtZmx5b3V0JykpO1xuXG4gICAgaG92ZXJhYmxlLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlb3ZlcicsIGZ1bmN0aW9uKCkge1xuICAgICAgZmx5b3V0LmNsYXNzTGlzdC5yZW1vdmUoJ2ZseW91dC1oaWRkZW4nKTtcbiAgICAgIHZhciBub2RlID0gaG92ZXJhYmxlO1xuICAgICAgdmFyIGxlZnQgPSAwO1xuICAgICAgdmFyIHRvcCA9IDA7XG5cbiAgICAgIGRvIHtcbiAgICAgICAgbGVmdCArPSBub2RlLm9mZnNldExlZnQ7XG4gICAgICAgIHRvcCArPSBub2RlLm9mZnNldFRvcDtcbiAgICAgIH0gd2hpbGUgKChub2RlID0gbm9kZS5vZmZzZXRQYXJlbnQpICE9PSBudWxsKTtcblxuICAgICAgbGVmdCA9IGxlZnQgKyBob3ZlcmFibGUub2Zmc2V0V2lkdGggLyAyO1xuICAgICAgdG9wID0gdG9wICsgaG92ZXJhYmxlLm9mZnNldEhlaWdodCArIHBhZGRpbmc7XG5cbiAgICAgIGZseW91dC5zdHlsZS5sZWZ0ID0gbGVmdCArICdweCc7XG4gICAgICBmbHlvdXQuc3R5bGUudG9wID0gdG9wICsgJ3B4JztcbiAgICB9KTtcblxuICAgIGhvdmVyYWJsZS5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW91dCcsIGZ1bmN0aW9uKCkge1xuICAgICAgZmx5b3V0LmNsYXNzTGlzdC5hZGQoJ2ZseW91dC1oaWRkZW4nKTtcbiAgICB9KTtcbiAgfSk7XG5cbn1cbiIsImZ1bmN0aW9uIE1lbnVGYWN0b3J5KGVsZW1lbnQpIHtcbiAgdmFyIG1lbnVzID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoZWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKCcubWVudScpKTtcbiAgdmFyIHRvZ2dsZXMgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChlbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ1tkYXRhLW1lbnUtdG9nZ2xlXScpKTtcblxuICB0b2dnbGVzLmZvckVhY2goZnVuY3Rpb24odG9nZ2xlKSB7XG4gICAgdG9nZ2xlLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgbWVudSA9IGVsZW1lbnQucXVlcnlTZWxlY3RvcignIycgKyB0b2dnbGUuZ2V0QXR0cmlidXRlKCdkYXRhLW1lbnUtdG9nZ2xlJykpO1xuICAgICAgbWVudS5jbGFzc0xpc3QudG9nZ2xlKCdhY3RpdmUnKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgbWVudXMuZm9yRWFjaChmdW5jdGlvbihtZW51KSB7XG4gICAgdmFyIGRpc21pc3NhbHMgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChtZW51LnF1ZXJ5U2VsZWN0b3JBbGwoJ1tkYXRhLW1lbnUtZGlzbWlzc10nKSk7XG5cbiAgICBkaXNtaXNzYWxzLmZvckVhY2goZnVuY3Rpb24oZGlzbWlzc2FsKSB7XG4gICAgICBkaXNtaXNzYWwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbigpIHtcbiAgICAgICAgbWVudS5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKTtcbiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignW2RhdGEtbWVudS10b2dnbGU9XCInICsgbWVudS5pZCArICdcIl0nKS5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KTtcbn1cbiIsImZ1bmN0aW9uIE1vZGFsRmFjdG9yeShlbGVtZW50KSB7XG4gIHRoaXMucm9vdCA9IGVsZW1lbnQ7XG4gIHRoaXMuZGlzbWlzc2FscyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5hcHBseShlbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ1tkYXRhLW1vZGFsLWRpc21pc3NdJykpO1xuICB0aGlzLm9wZW5lcnMgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuYXBwbHkoZWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKCdbZGF0YS1tb2RhbF0nKSk7XG4gIHRoaXMuYXR0YWNoRXZlbnRzKCk7XG59XG5cbk1vZGFsRmFjdG9yeS5wcm90b3R5cGUgPSB7XG4gIGF0dGFjaEV2ZW50czogZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5kaXNtaXNzYWxzLmZvckVhY2goZnVuY3Rpb24gKGRpc21pc3NhbCkge1xuICAgICAgZGlzbWlzc2FsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5kaXNtaXNzLmJpbmQodGhpcykpO1xuICAgIH0sIHRoaXMpO1xuXG4gICAgdGhpcy5vcGVuZXJzLmZvckVhY2goZnVuY3Rpb24gKG9wZW5lcikge1xuICAgICAgb3BlbmVyLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5vcGVuLmJpbmQodGhpcykpO1xuICAgIH0sIHRoaXMpO1xuXG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5dXAnLCBmdW5jdGlvbihldmVudCkge1xuICAgICAgdmFyIGtleSA9IGV2ZW50LndoaWNoIHx8IGV2ZW50LmtleUNvZGU7XG5cbiAgICAgIC8vIEVTQ1xuICAgICAgaWYgKGtleSA9PT0gMjcpIHtcbiAgICAgICAgdmFyIG1vZGFscyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5tb2RhbDpub3QoLm1vZGFsLWhpZGRlbiknKSk7XG4gICAgICAgIG1vZGFscy5mb3JFYWNoKGZ1bmN0aW9uKG1vZGFsKSB7XG4gICAgICAgICAgbW9kYWwuY2xhc3NMaXN0LmFkZCgnbW9kYWwtaGlkZGVuJyk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0pO1xuICB9LFxuICBvcGVuOiBmdW5jdGlvbihldmVudCkge1xuICAgIHZhciBtb2RhbCA9IGV2ZW50LnRhcmdldC5nZXRBdHRyaWJ1dGUoJ2RhdGEtbW9kYWwnKTtcbiAgICBtb2RhbCA9IHRoaXMucm9vdC5xdWVyeVNlbGVjdG9yKCcjJyArIG1vZGFsKTtcbiAgICBtb2RhbC5jbGFzc0xpc3QucmVtb3ZlKCdtb2RhbC1oaWRkZW4nKTtcbiAgfSxcbiAgZGlzbWlzczogZnVuY3Rpb24oZXZlbnQpIHtcbiAgICB2YXIgdGFyZ2V0ID0gZXZlbnQudGFyZ2V0O1xuICAgIHZhciBjbG9zZWFibGUgPSB0YXJnZXQgPT09IGV2ZW50LmN1cnJlbnRUYXJnZXQgJiZcbiAgICAgIHRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ21vZGFsLW92ZXJsYXknKTtcblxuICAgIGRvIHtcbiAgICAgIGlmICh0YXJnZXQuaGFzQXR0cmlidXRlKCdkYXRhLW1vZGFsLWRpc21pc3MnKSAmJlxuICAgICAgICAgICF0YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdtb2RhbCcpKSB7XG4gICAgICAgIGNsb3NlYWJsZSA9IHRydWU7XG4gICAgICB9IGVsc2UgaWYgKHRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ21vZGFsJykgJiYgY2xvc2VhYmxlKSB7XG4gICAgICAgIHJldHVybiB0YXJnZXQuY2xhc3NMaXN0LmFkZCgnbW9kYWwtaGlkZGVuJyk7XG4gICAgICB9IGVsc2UgaWYgKHRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ21vZGFsJykpe1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgfSB3aGlsZSgodGFyZ2V0ID0gdGFyZ2V0LnBhcmVudE5vZGUpICE9PSB0aGlzLnJvb3QpO1xuICB9XG59O1xuIiwiZnVuY3Rpb24gVG9nZ2xlRmFjdG9yeShlbGVtZW50KSB7XG4gIHZhciB0b2dnbGVzID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmFwcGx5KGVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCgnW2RhdGEtdG9nZ2xlXScpKTtcbiAgdGhpcy5lbGVtZW50ID0gZWxlbWVudDtcblxuICB0b2dnbGVzLmZvckVhY2goZnVuY3Rpb24odG9nZ2xlKSB7XG4gICAgdG9nZ2xlLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy50b2dnbGUuYmluZCh0aGlzKSk7XG4gIH0sIHRoaXMpO1xufVxuXG5Ub2dnbGVGYWN0b3J5LnByb3RvdHlwZSA9IHtcbiAgdG9nZ2xlOiBmdW5jdGlvbihldmVudCkge1xuICAgIHZhciB0YXJnZXQgPSBldmVudC50YXJnZXQ7XG5cbiAgICBkbyB7XG4gICAgICBpZiAodGFyZ2V0Lmhhc0F0dHJpYnV0ZSgnZGF0YS10b2dnbGUnKSkge1xuICAgICAgICByZXR1cm4gdGFyZ2V0LmNsYXNzTGlzdC50b2dnbGUoJ2FjdGl2ZScpXG4gICAgICB9XG4gICAgfSB3aGlsZSgodGFyZ2V0ID0gdGFyZ2V0LnBhcmVudE5vZGUpICE9PSB0aGlzLmVsZW1lbnQpXG4gIH1cbn1cbiIsIi8vPSByZXF1aXJlIC4vdmVuZG9yL3RldGhlci5taW5cbi8vPSByZXF1aXJlIC4vdmVuZG9yL3NoZXBoZXJkLm1pblxuXG5mdW5jdGlvbiBUb3VyRmFjdG9yeShlbGVtZW50KSB7XG4gIHRoaXMucm9vdCA9IGVsZW1lbnQ7XG4gIHRoaXMub3BlbmVycyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5hcHBseShlbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ1tkYXRhLXRvdXJdJykpO1xuICB0aGlzLnRvdXJPdmVybGF5ID0gZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcudG91ci1vdmVybGF5Jyk7XG4gIHRoaXMuaW5pdGlhbGl6ZVRvdXIoKTtcbiAgdGhpcy5hZGRTdGVwcygpO1xuICB0aGlzLmF0dGFjaEV2ZW50cygpO1xuXG4gIC8vIE9wZW4gdG91ciBpbW1lZGlhdGVseSB1bmxlc3Mgb3BlbmVycyBhcmUgc3BlY2lmaWVkXG4gIGlmICh0aGlzLm9wZW5lcnMubGVuZ3RoID09PSAwKSB7XG4gICAgdGhpcy5vcGVuVG91cigpO1xuICB9XG59XG5cblRvdXJGYWN0b3J5LnByb3RvdHlwZSA9IHtcbiAgaW5pdGlhbGl6ZVRvdXI6IGZ1bmN0aW9uKCkge1xuICAgIHZhciB0aGF0ID0gdGhpcztcblxuICAgIHRoaXMudG91ciA9IG5ldyBTaGVwaGVyZC5Ub3VyKHtcbiAgICAgIGRlZmF1bHRzOiB7XG4gICAgICAgIHNob3dDYW5jZWxMaW5rOiB0cnVlLFxuICAgICAgICBidXR0b25zOiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgdGV4dDogdGhhdC50b3VyT3ZlcmxheS5nZXRBdHRyaWJ1dGUoJ2RhdGEtdG91ci1za2lwJyksXG4gICAgICAgICAgICBjbGFzc2VzOiAnYnRuLWRlZmF1bHQnLFxuICAgICAgICAgICAgYWN0aW9uOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgdGhhdC50b3VyLmNhbmNlbCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0sXG4gICAgICAgICAge1xuICAgICAgICAgICAgdGV4dDogdGhhdC50b3VyT3ZlcmxheS5nZXRBdHRyaWJ1dGUoJ2RhdGEtdG91ci1uZXh0JyksXG4gICAgICAgICAgICBjbGFzc2VzOiAnYnRuLXByaW1hcnknLFxuICAgICAgICAgICAgYWN0aW9uOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgdGhhdC5jbGlja05leHQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIF1cbiAgICAgIH1cbiAgICB9KTtcbiAgfSxcbiAgYWRkU3RlcHM6IGZ1bmN0aW9uKCkge1xuICAgIHZhciB0aGF0ID0gdGhpcztcblxuICAgIHZhciBzdGVwcyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5hcHBseShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdbZGF0YS10b3VyLXN0ZXBdJykpO1xuICAgIHZhciBzb3J0ZWRTdGVwcyA9IHN0ZXBzLnNvcnQoZnVuY3Rpb24oYSwgYikge1xuICAgICAgdmFyIHN0ZXBBID0gcGFyc2VJbnQoYS5nZXRBdHRyaWJ1dGUoJ2RhdGEtc3RlcC1udW1iZXInKSk7XG4gICAgICB2YXIgc3RlcEIgPSBwYXJzZUludChiLmdldEF0dHJpYnV0ZSgnZGF0YS1zdGVwLW51bWJlcicpKTtcblxuICAgICAgaWYgKHN0ZXBBID4gc3RlcEIpIHtcbiAgICAgICAgcmV0dXJuIDE7XG4gICAgICB9IGVsc2UgaWYgKHN0ZXBBIDwgc3RlcEIpIHtcbiAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBzb3J0ZWRTdGVwcy5mb3JFYWNoKGZ1bmN0aW9uKHN0ZXAsIGluZGV4KSB7XG4gICAgICB2YXIgc3RlcENvbmZpZyA9IHtcbiAgICAgICAgdGl0bGU6IHN0ZXAuZ2V0QXR0cmlidXRlKCdkYXRhLXRpdGxlJyksXG4gICAgICAgIHRleHQ6IHN0ZXAuaW5uZXJIVE1MLFxuICAgICAgfTtcblxuICAgICAgdmFyIGNsYXNzZXMgPSBzdGVwLmdldEF0dHJpYnV0ZSgnZGF0YS1jbGFzc2VzJyk7XG5cbiAgICAgIHZhciBhdHRhY2hUb0VsZW1lbnQgPSBzdGVwLmdldEF0dHJpYnV0ZSgnZGF0YS1hdHRhY2gtdG8tZWxlbWVudCcpO1xuICAgICAgdmFyIGF0dGFjaFRvUG9zaXRpb24gPSBzdGVwLmdldEF0dHJpYnV0ZSgnZGF0YS1hdHRhY2gtdG8tcG9zaXRpb24nKTtcbiAgICAgIHZhciBwb3NpdGlvbk9mZnNldCA9IHtcbiAgICAgICAgbGVmdDogJzAgMjVweCcsXG4gICAgICAgIHJpZ2h0OiAnMCAtMjVweCcsXG4gICAgICAgIHRvcDogJzI1cHggMCcsXG4gICAgICAgIGJvdHRvbTogJy0yNXB4IDAnXG4gICAgICB9W2F0dGFjaFRvUG9zaXRpb25dO1xuXG4gICAgICBpZiAoY2xhc3Nlcykge1xuICAgICAgICBzdGVwQ29uZmlnLmNsYXNzZXMgPSBjbGFzc2VzLnNwbGl0KCcgJyk7XG4gICAgICB9XG5cbiAgICAgIGlmIChhdHRhY2hUb0VsZW1lbnQgJiYgYXR0YWNoVG9Qb3NpdGlvbiAmJiBwb3NpdGlvbk9mZnNldCkge1xuICAgICAgICBzdGVwQ29uZmlnLmF0dGFjaFRvID0ge1xuICAgICAgICAgIGVsZW1lbnQ6IGF0dGFjaFRvRWxlbWVudCxcbiAgICAgICAgICBvbjogYXR0YWNoVG9Qb3NpdGlvblxuICAgICAgICB9O1xuXG4gICAgICAgIHN0ZXBDb25maWcudGV0aGVyT3B0aW9ucyA9IHtcbiAgICAgICAgICBvZmZzZXQ6IHBvc2l0aW9uT2Zmc2V0XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgaWYgKHNvcnRlZFN0ZXBzLmxlbmd0aCAtIDEgPT09IGluZGV4KSB7XG4gICAgICAgIHN0ZXBDb25maWcuYnV0dG9ucyA9IFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICB0ZXh0OiB0aGF0LnRvdXJPdmVybGF5LmdldEF0dHJpYnV0ZSgnZGF0YS10b3VyLWRvbmUnKSxcbiAgICAgICAgICAgIGNsYXNzZXM6ICdidG4tcHJpbWFyeScsXG4gICAgICAgICAgICBhY3Rpb246IHRoYXQudG91ci5jb21wbGV0ZVxuICAgICAgICAgIH1cbiAgICAgICAgXTtcbiAgICAgIH1cblxuICAgICAgdGhhdC50b3VyLmFkZFN0ZXAoc3RlcENvbmZpZyk7XG4gICAgfSk7XG4gIH0sXG4gIGF0dGFjaEV2ZW50czogZnVuY3Rpb24oKSB7XG4gICAgdmFyIHRoYXQgPSB0aGlzO1xuXG4gICAgdGhhdC5vcGVuZXJzLmZvckVhY2goZnVuY3Rpb24gKG9wZW5lcikge1xuICAgICAgb3BlbmVyLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhhdC5vcGVuVG91ci5iaW5kKHRoYXQpKTtcbiAgICB9LCB0aGF0KTtcblxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleXVwJywgZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgIHZhciBrZXkgPSBldmVudC53aGljaCB8fCBldmVudC5rZXlDb2RlO1xuXG4gICAgICAvLyBFU0NcbiAgICAgIGlmIChrZXkgPT09IDI3KSB7XG4gICAgICAgIHRoYXQudG91ci5jYW5jZWwoKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIHRoYXQudG91ck92ZXJsYXkuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbigpIHtcbiAgICAgIHRoYXQudG91ci5jYW5jZWwoKTtcbiAgICB9KTtcblxuICAgIHRoYXQudG91ci5vbignYWN0aXZlJywgZnVuY3Rpb24oKSB7XG4gICAgICB0aGF0LnRvdXJPdmVybGF5LmNsYXNzTGlzdC5yZW1vdmUoJ292ZXJsYXktaGlkZGVuJyk7XG4gICAgfSk7XG5cbiAgICB0aGF0LnRvdXIub24oJ2luYWN0aXZlJywgZnVuY3Rpb24oKSB7XG4gICAgICB0aGF0LnRvdXJPdmVybGF5LmNsYXNzTGlzdC5hZGQoJ292ZXJsYXktaGlkZGVuJyk7XG4gICAgfSk7XG4gIH0sXG4gIG9wZW5Ub3VyOiBmdW5jdGlvbigpIHtcbiAgICB0aGlzLnRvdXIuc3RhcnQoKTtcbiAgICB0aGlzLnRvdXJPdmVybGF5LmNsYXNzTGlzdC5yZW1vdmUoJ3RvdXItb3ZlcmxheS1oaWRkZW4nKTtcbiAgfSxcbiAgY2xpY2tOZXh0OiBmdW5jdGlvbigpIHtcbiAgICBkb2N1bWVudC5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgnbmV4dCcsIHsgJ2RldGFpbCc6IHRoaXMudG91ci5nZXRDdXJyZW50U3RlcCgpIH0pKTtcbiAgICB0aGlzLnRvdXIubmV4dCgpO1xuICB9XG59O1xuIiwiIWZ1bmN0aW9uKGUsdCl7XCJmdW5jdGlvblwiPT10eXBlb2YgZGVmaW5lJiZkZWZpbmUuYW1kP2RlZmluZShbXCJ0ZXRoZXJcIl0sdCk6XCJvYmplY3RcIj09dHlwZW9mIGV4cG9ydHM/bW9kdWxlLmV4cG9ydHM9dChyZXF1aXJlKFwidGV0aGVyXCIpKTplLlNoZXBoZXJkPXQoZS5UZXRoZXIpfSh0aGlzLGZ1bmN0aW9uKGUpe1widXNlIHN0cmljdFwiO2Z1bmN0aW9uIHQoZSx0KXtpZighKGUgaW5zdGFuY2VvZiB0KSl0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpfWZ1bmN0aW9uIG4oZSx0KXtpZihcImZ1bmN0aW9uXCIhPXR5cGVvZiB0JiZudWxsIT09dCl0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24sIG5vdCBcIit0eXBlb2YgdCk7ZS5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZSh0JiZ0LnByb3RvdHlwZSx7Y29uc3RydWN0b3I6e3ZhbHVlOmUsZW51bWVyYWJsZTohMSx3cml0YWJsZTohMCxjb25maWd1cmFibGU6ITB9fSksdCYmKE9iamVjdC5zZXRQcm90b3R5cGVPZj9PYmplY3Quc2V0UHJvdG90eXBlT2YoZSx0KTplLl9fcHJvdG9fXz10KX1mdW5jdGlvbiBpKGUpe3ZhciB0PWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7cmV0dXJuIHQuaW5uZXJIVE1MPWUsdC5jaGlsZHJlblswXX1mdW5jdGlvbiBvKGUsdCl7dmFyIG49dm9pZCAwO3JldHVyblwidW5kZWZpbmVkXCIhPXR5cGVvZiBlLm1hdGNoZXM/bj1lLm1hdGNoZXM6XCJ1bmRlZmluZWRcIiE9dHlwZW9mIGUubWF0Y2hlc1NlbGVjdG9yP249ZS5tYXRjaGVzU2VsZWN0b3I6XCJ1bmRlZmluZWRcIiE9dHlwZW9mIGUubXNNYXRjaGVzU2VsZWN0b3I/bj1lLm1zTWF0Y2hlc1NlbGVjdG9yOlwidW5kZWZpbmVkXCIhPXR5cGVvZiBlLndlYmtpdE1hdGNoZXNTZWxlY3Rvcj9uPWUud2Via2l0TWF0Y2hlc1NlbGVjdG9yOlwidW5kZWZpbmVkXCIhPXR5cGVvZiBlLm1vek1hdGNoZXNTZWxlY3Rvcj9uPWUubW96TWF0Y2hlc1NlbGVjdG9yOlwidW5kZWZpbmVkXCIhPXR5cGVvZiBlLm9NYXRjaGVzU2VsZWN0b3ImJihuPWUub01hdGNoZXNTZWxlY3Rvciksbi5jYWxsKGUsdCl9ZnVuY3Rpb24gcyhlLHQpe2lmKG51bGw9PT1lfHxcInVuZGVmaW5lZFwiPT10eXBlb2YgZSlyZXR1cm4gZTtpZihcIm9iamVjdFwiPT10eXBlb2YgZSlyZXR1cm4gZTt2YXIgbj1lLnNwbGl0KFwiIFwiKSxpPW4ubGVuZ3RoLG89dC5sZW5ndGg7aT5vJiYoblswXT1uLnNsaWNlKDAsaS1vKzEpLmpvaW4oXCIgXCIpLG4uc3BsaWNlKDEsbykpO2Zvcih2YXIgcz17fSxyPTA7bz5yOysrcil7dmFyIGg9dFtyXTtzW2hdPW5bcl19cmV0dXJuIHN9dmFyIHI9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKGUsdCl7Zm9yKHZhciBuPTA7bjx0Lmxlbmd0aDtuKyspe3ZhciBpPXRbbl07aS5lbnVtZXJhYmxlPWkuZW51bWVyYWJsZXx8ITEsaS5jb25maWd1cmFibGU9ITAsXCJ2YWx1ZVwiaW4gaSYmKGkud3JpdGFibGU9ITApLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShlLGkua2V5LGkpfX1yZXR1cm4gZnVuY3Rpb24odCxuLGkpe3JldHVybiBuJiZlKHQucHJvdG90eXBlLG4pLGkmJmUodCxpKSx0fX0oKSxoPWZ1bmN0aW9uKGUsdCxuKXtmb3IodmFyIGk9ITA7aTspe3ZhciBvPWUscz10LHI9bjtoPWE9dT12b2lkIDAsaT0hMSxudWxsPT09byYmKG89RnVuY3Rpb24ucHJvdG90eXBlKTt2YXIgaD1PYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG8scyk7aWYodm9pZCAwIT09aCl7aWYoXCJ2YWx1ZVwiaW4gaClyZXR1cm4gaC52YWx1ZTt2YXIgdT1oLmdldDtyZXR1cm4gdm9pZCAwPT09dT92b2lkIDA6dS5jYWxsKHIpfXZhciBhPU9iamVjdC5nZXRQcm90b3R5cGVPZihvKTtpZihudWxsPT09YSlyZXR1cm4gdm9pZCAwO2U9YSx0PXMsbj1yLGk9ITB9fSx1PWUuVXRpbHMsYT11LkV2ZW50ZWQsYz11LmFkZENsYXNzLGQ9dS5leHRlbmQsbD11Lmhhc0NsYXNzLHA9dS5yZW1vdmVDbGFzcyxmPXUudW5pcXVlSWQsdj1uZXcgYSx5PXt0b3A6XCJib3R0b20gY2VudGVyXCIsbGVmdDpcIm1pZGRsZSByaWdodFwiLHJpZ2h0OlwibWlkZGxlIGxlZnRcIixib3R0b206XCJ0b3AgY2VudGVyXCIsY2VudGVyOlwibWlkZGxlIGNlbnRlclwifSxtPWZ1bmN0aW9uKHUpe2Z1bmN0aW9uIGEoZSxuKXtyZXR1cm4gdCh0aGlzLGEpLGgoT2JqZWN0LmdldFByb3RvdHlwZU9mKGEucHJvdG90eXBlKSxcImNvbnN0cnVjdG9yXCIsdGhpcykuY2FsbCh0aGlzLGUsbiksdGhpcy50b3VyPWUsdGhpcy5iaW5kTWV0aG9kcygpLHRoaXMuc2V0T3B0aW9ucyhuKSx0aGlzfXJldHVybiBuKGEsdSkscihhLFt7a2V5OlwiYmluZE1ldGhvZHNcIix2YWx1ZTpmdW5jdGlvbigpe3ZhciBlPXRoaXMsdD1bXCJfc2hvd1wiLFwic2hvd1wiLFwiaGlkZVwiLFwiaXNPcGVuXCIsXCJjYW5jZWxcIixcImNvbXBsZXRlXCIsXCJzY3JvbGxUb1wiLFwiZGVzdHJveVwiXTt0Lm1hcChmdW5jdGlvbih0KXtlW3RdPWVbdF0uYmluZChlKX0pfX0se2tleTpcInNldE9wdGlvbnNcIix2YWx1ZTpmdW5jdGlvbigpe3ZhciBlPWFyZ3VtZW50cy5sZW5ndGg8PTB8fHZvaWQgMD09PWFyZ3VtZW50c1swXT97fTphcmd1bWVudHNbMF07dGhpcy5vcHRpb25zPWUsdGhpcy5kZXN0cm95KCksdGhpcy5pZD10aGlzLm9wdGlvbnMuaWR8fHRoaXMuaWR8fFwic3RlcC1cIitmKCk7dmFyIHQ9dGhpcy5vcHRpb25zLndoZW47aWYodClmb3IodmFyIG4gaW4gdClpZih7fS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHQsbikpe3ZhciBpPXRbbl07dGhpcy5vbihuLGksdGhpcyl9dGhpcy5vcHRpb25zLmJ1dHRvbnN8fCh0aGlzLm9wdGlvbnMuYnV0dG9ucz1be3RleHQ6XCJOZXh0XCIsYWN0aW9uOnRoaXMudG91ci5uZXh0fV0pfX0se2tleTpcImdldFRvdXJcIix2YWx1ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLnRvdXJ9fSx7a2V5OlwiYmluZEFkdmFuY2VcIix2YWx1ZTpmdW5jdGlvbigpe3ZhciBlPXRoaXMsdD1zKHRoaXMub3B0aW9ucy5hZHZhbmNlT24sW1wic2VsZWN0b3JcIixcImV2ZW50XCJdKSxuPXQuZXZlbnQsaT10LnNlbGVjdG9yLHI9ZnVuY3Rpb24odCl7ZS5pc09wZW4oKSYmKFwidW5kZWZpbmVkXCIhPXR5cGVvZiBpP28odC50YXJnZXQsaSkmJmUudG91ci5uZXh0KCk6ZS5lbCYmdC50YXJnZXQ9PT1lLmVsJiZlLnRvdXIubmV4dCgpKX07ZG9jdW1lbnQuYm9keS5hZGRFdmVudExpc3RlbmVyKG4sciksdGhpcy5vbihcImRlc3Ryb3lcIixmdW5jdGlvbigpe3JldHVybiBkb2N1bWVudC5ib2R5LnJlbW92ZUV2ZW50TGlzdGVuZXIobixyKX0pfX0se2tleTpcImdldEF0dGFjaFRvXCIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgZT1zKHRoaXMub3B0aW9ucy5hdHRhY2hUbyxbXCJlbGVtZW50XCIsXCJvblwiXSl8fHt9LHQ9ZS5lbGVtZW50O2lmKFwic3RyaW5nXCI9PXR5cGVvZiB0JiYoZS5lbGVtZW50PWRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodCksIWUuZWxlbWVudCkpdGhyb3cgbmV3IEVycm9yKFwiVGhlIGVsZW1lbnQgZm9yIHRoaXMgU2hlcGhlcmQgc3RlcCB3YXMgbm90IGZvdW5kIFwiK3QpO3JldHVybiBlfX0se2tleTpcInNldHVwVGV0aGVyXCIsdmFsdWU6ZnVuY3Rpb24oKXtpZihcInVuZGVmaW5lZFwiPT10eXBlb2YgZSl0aHJvdyBuZXcgRXJyb3IoXCJVc2luZyB0aGUgYXR0YWNobWVudCBmZWF0dXJlIG9mIFNoZXBoZXJkIHJlcXVpcmVzIHRoZSBUZXRoZXIgbGlicmFyeVwiKTt2YXIgdD10aGlzLmdldEF0dGFjaFRvKCksbj15W3Qub258fFwicmlnaHRcIl07XCJ1bmRlZmluZWRcIj09dHlwZW9mIHQuZWxlbWVudCYmKHQuZWxlbWVudD1cInZpZXdwb3J0XCIsbj1cIm1pZGRsZSBjZW50ZXJcIik7dmFyIGk9e2NsYXNzUHJlZml4Olwic2hlcGhlcmRcIixlbGVtZW50OnRoaXMuZWwsY29uc3RyYWludHM6W3t0bzpcIndpbmRvd1wiLHBpbjohMCxhdHRhY2htZW50OlwidG9nZXRoZXJcIn1dLHRhcmdldDp0LmVsZW1lbnQsb2Zmc2V0OnQub2Zmc2V0fHxcIjAgMFwiLGF0dGFjaG1lbnQ6bn07dGhpcy50ZXRoZXImJnRoaXMudGV0aGVyLmRlc3Ryb3koKSx0aGlzLnRldGhlcj1uZXcgZShkKGksdGhpcy5vcHRpb25zLnRldGhlck9wdGlvbnMpKX19LHtrZXk6XCJzaG93XCIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgZT10aGlzO2lmKFwidW5kZWZpbmVkXCIhPXR5cGVvZiB0aGlzLm9wdGlvbnMuYmVmb3JlU2hvd1Byb21pc2Upe3ZhciB0PXRoaXMub3B0aW9ucy5iZWZvcmVTaG93UHJvbWlzZSgpO2lmKFwidW5kZWZpbmVkXCIhPXR5cGVvZiB0KXJldHVybiB0LnRoZW4oZnVuY3Rpb24oKXtyZXR1cm4gZS5fc2hvdygpfSl9dGhpcy5fc2hvdygpfX0se2tleTpcIl9zaG93XCIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgZT10aGlzO3RoaXMudHJpZ2dlcihcImJlZm9yZS1zaG93XCIpLHRoaXMuZWx8fHRoaXMucmVuZGVyKCksYyh0aGlzLmVsLFwic2hlcGhlcmQtb3BlblwiKSxkb2N1bWVudC5ib2R5LnNldEF0dHJpYnV0ZShcImRhdGEtc2hlcGhlcmQtc3RlcFwiLHRoaXMuaWQpLHRoaXMuc2V0dXBUZXRoZXIoKSx0aGlzLm9wdGlvbnMuc2Nyb2xsVG8mJnNldFRpbWVvdXQoZnVuY3Rpb24oKXtlLnNjcm9sbFRvKCl9KSx0aGlzLnRyaWdnZXIoXCJzaG93XCIpfX0se2tleTpcImhpZGVcIix2YWx1ZTpmdW5jdGlvbigpe3RoaXMudHJpZ2dlcihcImJlZm9yZS1oaWRlXCIpLHAodGhpcy5lbCxcInNoZXBoZXJkLW9wZW5cIiksZG9jdW1lbnQuYm9keS5yZW1vdmVBdHRyaWJ1dGUoXCJkYXRhLXNoZXBoZXJkLXN0ZXBcIiksdGhpcy50ZXRoZXImJnRoaXMudGV0aGVyLmRlc3Ryb3koKSx0aGlzLnRldGhlcj1udWxsLHRoaXMudHJpZ2dlcihcImhpZGVcIil9fSx7a2V5OlwiaXNPcGVuXCIsdmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4gbCh0aGlzLmVsLFwic2hlcGhlcmQtb3BlblwiKX19LHtrZXk6XCJjYW5jZWxcIix2YWx1ZTpmdW5jdGlvbigpe3RoaXMudG91ci5jYW5jZWwoKSx0aGlzLnRyaWdnZXIoXCJjYW5jZWxcIil9fSx7a2V5OlwiY29tcGxldGVcIix2YWx1ZTpmdW5jdGlvbigpe3RoaXMudG91ci5jb21wbGV0ZSgpLHRoaXMudHJpZ2dlcihcImNvbXBsZXRlXCIpfX0se2tleTpcInNjcm9sbFRvXCIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgZT10aGlzLmdldEF0dGFjaFRvKCksdD1lLmVsZW1lbnQ7XCJ1bmRlZmluZWRcIiE9dHlwZW9mIHRoaXMub3B0aW9ucy5zY3JvbGxUb0hhbmRsZXI/dGhpcy5vcHRpb25zLnNjcm9sbFRvSGFuZGxlcih0KTpcInVuZGVmaW5lZFwiIT10eXBlb2YgdCYmdC5zY3JvbGxJbnRvVmlldygpfX0se2tleTpcImRlc3Ryb3lcIix2YWx1ZTpmdW5jdGlvbigpe1widW5kZWZpbmVkXCIhPXR5cGVvZiB0aGlzLmVsJiYoZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZCh0aGlzLmVsKSxkZWxldGUgdGhpcy5lbCksdGhpcy50ZXRoZXImJnRoaXMudGV0aGVyLmRlc3Ryb3koKSx0aGlzLnRldGhlcj1udWxsLHRoaXMudHJpZ2dlcihcImRlc3Ryb3lcIil9fSx7a2V5OlwicmVuZGVyXCIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgZT10aGlzO1widW5kZWZpbmVkXCIhPXR5cGVvZiB0aGlzLmVsJiZ0aGlzLmRlc3Ryb3koKSx0aGlzLmVsPWkoXCI8ZGl2IGNsYXNzPSdzaGVwaGVyZC1zdGVwIFwiKyh0aGlzLm9wdGlvbnMuY2xhc3Nlc3x8XCJcIikrXCInIGRhdGEtaWQ9J1wiK3RoaXMuaWQrXCInIFwiKyh0aGlzLm9wdGlvbnMuaWRBdHRyaWJ1dGU/J2lkPVwiJyt0aGlzLm9wdGlvbnMuaWRBdHRyaWJ1dGUrJ1wiJzpcIlwiKStcIj48L2Rpdj5cIik7dmFyIHQ9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTt0LmNsYXNzTmFtZT1cInNoZXBoZXJkLWNvbnRlbnRcIix0aGlzLmVsLmFwcGVuZENoaWxkKHQpO3ZhciBuPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJoZWFkZXJcIik7aWYodC5hcHBlbmRDaGlsZChuKSxcInVuZGVmaW5lZFwiIT10eXBlb2YgdGhpcy5vcHRpb25zLnRpdGxlJiYobi5pbm5lckhUTUwrPVwiPGgzIGNsYXNzPSdzaGVwaGVyZC10aXRsZSc+XCIrdGhpcy5vcHRpb25zLnRpdGxlK1wiPC9oMz5cIix0aGlzLmVsLmNsYXNzTmFtZSs9XCIgc2hlcGhlcmQtaGFzLXRpdGxlXCIpLHRoaXMub3B0aW9ucy5zaG93Q2FuY2VsTGluayl7dmFyIG89aShcIjxhIGhyZWYgY2xhc3M9J3NoZXBoZXJkLWNhbmNlbC1saW5rJz7inJU8L2E+XCIpO24uYXBwZW5kQ2hpbGQobyksdGhpcy5lbC5jbGFzc05hbWUrPVwiIHNoZXBoZXJkLWhhcy1jYW5jZWwtbGlua1wiLHRoaXMuYmluZENhbmNlbExpbmsobyl9XCJ1bmRlZmluZWRcIiE9dHlwZW9mIHRoaXMub3B0aW9ucy50ZXh0JiYhZnVuY3Rpb24oKXt2YXIgbj1pKFwiPGRpdiBjbGFzcz0nc2hlcGhlcmQtdGV4dCc+PC9kaXY+XCIpLG89ZS5vcHRpb25zLnRleHQ7XCJmdW5jdGlvblwiPT10eXBlb2YgbyYmKG89by5jYWxsKGUsbikpLG8gaW5zdGFuY2VvZiBIVE1MRWxlbWVudD9uLmFwcGVuZENoaWxkKG8pOihcInN0cmluZ1wiPT10eXBlb2YgbyYmKG89W29dKSxvLm1hcChmdW5jdGlvbihlKXtuLmlubmVySFRNTCs9XCI8cD5cIitlK1wiPC9wPlwifSkpLHQuYXBwZW5kQ2hpbGQobil9KCk7dmFyIHM9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImZvb3RlclwiKTt0aGlzLm9wdGlvbnMuYnV0dG9ucyYmIWZ1bmN0aW9uKCl7dmFyIHQ9aShcIjx1bCBjbGFzcz0nc2hlcGhlcmQtYnV0dG9ucyc+PC91bD5cIik7ZS5vcHRpb25zLmJ1dHRvbnMubWFwKGZ1bmN0aW9uKG4pe3ZhciBvPWkoXCI8bGk+PGEgY2xhc3M9J3NoZXBoZXJkLWJ1dHRvbiBcIisobi5jbGFzc2VzfHxcIlwiKStcIic+XCIrbi50ZXh0K1wiPC9hPlwiKTt0LmFwcGVuZENoaWxkKG8pLGUuYmluZEJ1dHRvbkV2ZW50cyhuLG8ucXVlcnlTZWxlY3RvcihcImFcIikpfSkscy5hcHBlbmRDaGlsZCh0KX0oKSx0LmFwcGVuZENoaWxkKHMpLGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQodGhpcy5lbCksdGhpcy5zZXR1cFRldGhlcigpLHRoaXMub3B0aW9ucy5hZHZhbmNlT24mJnRoaXMuYmluZEFkdmFuY2UoKX19LHtrZXk6XCJiaW5kQ2FuY2VsTGlua1wiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXM7ZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIixmdW5jdGlvbihlKXtlLnByZXZlbnREZWZhdWx0KCksdC5jYW5jZWwoKX0pfX0se2tleTpcImJpbmRCdXR0b25FdmVudHNcIix2YWx1ZTpmdW5jdGlvbihlLHQpe3ZhciBuPXRoaXM7ZS5ldmVudHM9ZS5ldmVudHN8fHt9LFwidW5kZWZpbmVkXCIhPXR5cGVvZiBlLmFjdGlvbiYmKGUuZXZlbnRzLmNsaWNrPWUuYWN0aW9uKTtmb3IodmFyIGkgaW4gZS5ldmVudHMpaWYoe30uaGFzT3duUHJvcGVydHkuY2FsbChlLmV2ZW50cyxpKSl7dmFyIG89ZS5ldmVudHNbaV07XCJzdHJpbmdcIj09dHlwZW9mIG8mJiFmdW5jdGlvbigpe3ZhciBlPW87bz1mdW5jdGlvbigpe3JldHVybiBuLnRvdXIuc2hvdyhlKX19KCksdC5hZGRFdmVudExpc3RlbmVyKGksbyl9dGhpcy5vbihcImRlc3Ryb3lcIixmdW5jdGlvbigpe2Zvcih2YXIgbiBpbiBlLmV2ZW50cylpZih7fS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGUuZXZlbnRzLG4pKXt2YXIgaT1lLmV2ZW50c1tuXTt0LnJlbW92ZUV2ZW50TGlzdGVuZXIobixpKX19KX19XSksYX0oYSksZz1mdW5jdGlvbihlKXtmdW5jdGlvbiBpKCl7dmFyIGU9dGhpcyxuPWFyZ3VtZW50cy5sZW5ndGg8PTB8fHZvaWQgMD09PWFyZ3VtZW50c1swXT97fTphcmd1bWVudHNbMF07dCh0aGlzLGkpLGgoT2JqZWN0LmdldFByb3RvdHlwZU9mKGkucHJvdG90eXBlKSxcImNvbnN0cnVjdG9yXCIsdGhpcykuY2FsbCh0aGlzLG4pLHRoaXMuYmluZE1ldGhvZHMoKSx0aGlzLm9wdGlvbnM9bix0aGlzLnN0ZXBzPXRoaXMub3B0aW9ucy5zdGVwc3x8W107dmFyIG89W1wiY29tcGxldGVcIixcImNhbmNlbFwiLFwiaGlkZVwiLFwic3RhcnRcIixcInNob3dcIixcImFjdGl2ZVwiLFwiaW5hY3RpdmVcIl07cmV0dXJuIG8ubWFwKGZ1bmN0aW9uKHQpeyFmdW5jdGlvbih0KXtlLm9uKHQsZnVuY3Rpb24obil7bj1ufHx7fSxuLnRvdXI9ZSx2LnRyaWdnZXIodCxuKX0pfSh0KX0pLHRoaXN9cmV0dXJuIG4oaSxlKSxyKGksW3trZXk6XCJiaW5kTWV0aG9kc1wiLHZhbHVlOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcyx0PVtcIm5leHRcIixcImJhY2tcIixcImNhbmNlbFwiLFwiY29tcGxldGVcIixcImhpZGVcIl07dC5tYXAoZnVuY3Rpb24odCl7ZVt0XT1lW3RdLmJpbmQoZSl9KX19LHtrZXk6XCJhZGRTdGVwXCIsdmFsdWU6ZnVuY3Rpb24oZSx0KXtyZXR1cm5cInVuZGVmaW5lZFwiPT10eXBlb2YgdCYmKHQ9ZSksdCBpbnN0YW5jZW9mIG0/dC50b3VyPXRoaXM6KChcInN0cmluZ1wiPT10eXBlb2YgZXx8XCJudW1iZXJcIj09dHlwZW9mIGUpJiYodC5pZD1lLnRvU3RyaW5nKCkpLHQ9ZCh7fSx0aGlzLm9wdGlvbnMuZGVmYXVsdHMsdCksdD1uZXcgbSh0aGlzLHQpKSx0aGlzLnN0ZXBzLnB1c2godCksdGhpc319LHtrZXk6XCJnZXRCeUlkXCIsdmFsdWU6ZnVuY3Rpb24oZSl7Zm9yKHZhciB0PTA7dDx0aGlzLnN0ZXBzLmxlbmd0aDsrK3Qpe3ZhciBuPXRoaXMuc3RlcHNbdF07aWYobi5pZD09PWUpcmV0dXJuIG59fX0se2tleTpcImdldEN1cnJlbnRTdGVwXCIsdmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5jdXJyZW50U3RlcH19LHtrZXk6XCJuZXh0XCIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgZT10aGlzLnN0ZXBzLmluZGV4T2YodGhpcy5jdXJyZW50U3RlcCk7ZT09PXRoaXMuc3RlcHMubGVuZ3RoLTE/KHRoaXMuaGlkZShlKSx0aGlzLnRyaWdnZXIoXCJjb21wbGV0ZVwiKSx0aGlzLmRvbmUoKSk6dGhpcy5zaG93KGUrMSwhMCl9fSx7a2V5OlwiYmFja1wiLHZhbHVlOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5zdGVwcy5pbmRleE9mKHRoaXMuY3VycmVudFN0ZXApO3RoaXMuc2hvdyhlLTEsITEpfX0se2tleTpcImNhbmNlbFwiLHZhbHVlOmZ1bmN0aW9uKCl7XCJ1bmRlZmluZWRcIiE9dHlwZW9mIHRoaXMuY3VycmVudFN0ZXAmJnRoaXMuY3VycmVudFN0ZXAuaGlkZSgpLHRoaXMudHJpZ2dlcihcImNhbmNlbFwiKSx0aGlzLmRvbmUoKX19LHtrZXk6XCJjb21wbGV0ZVwiLHZhbHVlOmZ1bmN0aW9uKCl7XCJ1bmRlZmluZWRcIiE9dHlwZW9mIHRoaXMuY3VycmVudFN0ZXAmJnRoaXMuY3VycmVudFN0ZXAuaGlkZSgpLHRoaXMudHJpZ2dlcihcImNvbXBsZXRlXCIpLHRoaXMuZG9uZSgpfX0se2tleTpcImhpZGVcIix2YWx1ZTpmdW5jdGlvbigpe1widW5kZWZpbmVkXCIhPXR5cGVvZiB0aGlzLmN1cnJlbnRTdGVwJiZ0aGlzLmN1cnJlbnRTdGVwLmhpZGUoKSx0aGlzLnRyaWdnZXIoXCJoaWRlXCIpLHRoaXMuZG9uZSgpfX0se2tleTpcImRvbmVcIix2YWx1ZTpmdW5jdGlvbigpe3YuYWN0aXZlVG91cj1udWxsLHAoZG9jdW1lbnQuYm9keSxcInNoZXBoZXJkLWFjdGl2ZVwiKSx0aGlzLnRyaWdnZXIoXCJpbmFjdGl2ZVwiLHt0b3VyOnRoaXN9KX19LHtrZXk6XCJzaG93XCIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgZT1hcmd1bWVudHMubGVuZ3RoPD0wfHx2b2lkIDA9PT1hcmd1bWVudHNbMF0/MDphcmd1bWVudHNbMF0sdD1hcmd1bWVudHMubGVuZ3RoPD0xfHx2b2lkIDA9PT1hcmd1bWVudHNbMV0/ITA6YXJndW1lbnRzWzFdO3RoaXMuY3VycmVudFN0ZXA/dGhpcy5jdXJyZW50U3RlcC5oaWRlKCk6KGMoZG9jdW1lbnQuYm9keSxcInNoZXBoZXJkLWFjdGl2ZVwiKSx0aGlzLnRyaWdnZXIoXCJhY3RpdmVcIix7dG91cjp0aGlzfSkpLHYuYWN0aXZlVG91cj10aGlzO3ZhciBuPXZvaWQgMDtpZihuPVwic3RyaW5nXCI9PXR5cGVvZiBlP3RoaXMuZ2V0QnlJZChlKTp0aGlzLnN0ZXBzW2VdKWlmKFwidW5kZWZpbmVkXCI9PXR5cGVvZiBuLm9wdGlvbnMuc2hvd09ufHxuLm9wdGlvbnMuc2hvd09uKCkpdGhpcy50cmlnZ2VyKFwic2hvd1wiLHtzdGVwOm4scHJldmlvdXM6dGhpcy5jdXJyZW50U3RlcH0pLHRoaXMuY3VycmVudFN0ZXA9bixuLnNob3coKTtlbHNle3ZhciBpPXRoaXMuc3RlcHMuaW5kZXhPZihuKSxvPXQ/aSsxOmktMTt0aGlzLnNob3cobyx0KX19fSx7a2V5Olwic3RhcnRcIix2YWx1ZTpmdW5jdGlvbigpe3RoaXMudHJpZ2dlcihcInN0YXJ0XCIpLHRoaXMuY3VycmVudFN0ZXA9bnVsbCx0aGlzLm5leHQoKX19XSksaX0oYSk7cmV0dXJuIGQodix7VG91cjpnLFN0ZXA6bSxFdmVudGVkOmF9KSx2fSk7IiwiIWZ1bmN0aW9uKHQsZSl7XCJmdW5jdGlvblwiPT10eXBlb2YgZGVmaW5lJiZkZWZpbmUuYW1kP2RlZmluZShlKTpcIm9iamVjdFwiPT10eXBlb2YgZXhwb3J0cz9tb2R1bGUuZXhwb3J0cz1lKHJlcXVpcmUsZXhwb3J0cyxtb2R1bGUpOnQuVGV0aGVyPWUoKX0odGhpcyxmdW5jdGlvbih0LGUsbyl7XCJ1c2Ugc3RyaWN0XCI7ZnVuY3Rpb24gaSh0LGUpe2lmKCEodCBpbnN0YW5jZW9mIGUpKXRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIil9ZnVuY3Rpb24gbih0KXt2YXIgZT1nZXRDb21wdXRlZFN0eWxlKHQpfHx7fSxvPWUucG9zaXRpb247aWYoXCJmaXhlZFwiPT09bylyZXR1cm4gdDtmb3IodmFyIGk9dDtpPWkucGFyZW50Tm9kZTspe3ZhciBuPXZvaWQgMDt0cnl7bj1nZXRDb21wdXRlZFN0eWxlKGkpfWNhdGNoKHIpe31pZihcInVuZGVmaW5lZFwiPT10eXBlb2Ygbnx8bnVsbD09PW4pcmV0dXJuIGk7dmFyIHM9bixhPXMub3ZlcmZsb3csZj1zLm92ZXJmbG93WCxoPXMub3ZlcmZsb3dZO2lmKC8oYXV0b3xzY3JvbGwpLy50ZXN0KGEraCtmKSYmKFwiYWJzb2x1dGVcIiE9PW98fFtcInJlbGF0aXZlXCIsXCJhYnNvbHV0ZVwiLFwiZml4ZWRcIl0uaW5kZXhPZihuLnBvc2l0aW9uKT49MCkpcmV0dXJuIGl9cmV0dXJuIGRvY3VtZW50LmJvZHl9ZnVuY3Rpb24gcih0KXt2YXIgZT12b2lkIDA7dD09PWRvY3VtZW50PyhlPWRvY3VtZW50LHQ9ZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50KTplPXQub3duZXJEb2N1bWVudDt2YXIgbz1lLmRvY3VtZW50RWxlbWVudCxpPXt9LG49dC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtmb3IodmFyIHIgaW4gbilpW3JdPW5bcl07dmFyIHM9eChlKTtyZXR1cm4gaS50b3AtPXMudG9wLGkubGVmdC09cy5sZWZ0LFwidW5kZWZpbmVkXCI9PXR5cGVvZiBpLndpZHRoJiYoaS53aWR0aD1kb2N1bWVudC5ib2R5LnNjcm9sbFdpZHRoLWkubGVmdC1pLnJpZ2h0KSxcInVuZGVmaW5lZFwiPT10eXBlb2YgaS5oZWlnaHQmJihpLmhlaWdodD1kb2N1bWVudC5ib2R5LnNjcm9sbEhlaWdodC1pLnRvcC1pLmJvdHRvbSksaS50b3A9aS50b3Atby5jbGllbnRUb3AsaS5sZWZ0PWkubGVmdC1vLmNsaWVudExlZnQsaS5yaWdodD1lLmJvZHkuY2xpZW50V2lkdGgtaS53aWR0aC1pLmxlZnQsaS5ib3R0b209ZS5ib2R5LmNsaWVudEhlaWdodC1pLmhlaWdodC1pLnRvcCxpfWZ1bmN0aW9uIHModCl7cmV0dXJuIHQub2Zmc2V0UGFyZW50fHxkb2N1bWVudC5kb2N1bWVudEVsZW1lbnR9ZnVuY3Rpb24gYSgpe3ZhciB0PWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7dC5zdHlsZS53aWR0aD1cIjEwMCVcIix0LnN0eWxlLmhlaWdodD1cIjIwMHB4XCI7dmFyIGU9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtmKGUuc3R5bGUse3Bvc2l0aW9uOlwiYWJzb2x1dGVcIix0b3A6MCxsZWZ0OjAscG9pbnRlckV2ZW50czpcIm5vbmVcIix2aXNpYmlsaXR5OlwiaGlkZGVuXCIsd2lkdGg6XCIyMDBweFwiLGhlaWdodDpcIjE1MHB4XCIsb3ZlcmZsb3c6XCJoaWRkZW5cIn0pLGUuYXBwZW5kQ2hpbGQodCksZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChlKTt2YXIgbz10Lm9mZnNldFdpZHRoO2Uuc3R5bGUub3ZlcmZsb3c9XCJzY3JvbGxcIjt2YXIgaT10Lm9mZnNldFdpZHRoO289PT1pJiYoaT1lLmNsaWVudFdpZHRoKSxkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKGUpO3ZhciBuPW8taTtyZXR1cm57d2lkdGg6bixoZWlnaHQ6bn19ZnVuY3Rpb24gZigpe3ZhciB0PWFyZ3VtZW50cy5sZW5ndGg8PTB8fHZvaWQgMD09PWFyZ3VtZW50c1swXT97fTphcmd1bWVudHNbMF0sZT1bXTtyZXR1cm4gQXJyYXkucHJvdG90eXBlLnB1c2guYXBwbHkoZSxhcmd1bWVudHMpLGUuc2xpY2UoMSkuZm9yRWFjaChmdW5jdGlvbihlKXtpZihlKWZvcih2YXIgbyBpbiBlKSh7fSkuaGFzT3duUHJvcGVydHkuY2FsbChlLG8pJiYodFtvXT1lW29dKX0pLHR9ZnVuY3Rpb24gaCh0LGUpe2lmKFwidW5kZWZpbmVkXCIhPXR5cGVvZiB0LmNsYXNzTGlzdCllLnNwbGl0KFwiIFwiKS5mb3JFYWNoKGZ1bmN0aW9uKGUpe2UudHJpbSgpJiZ0LmNsYXNzTGlzdC5yZW1vdmUoZSl9KTtlbHNle3ZhciBvPW5ldyBSZWdFeHAoXCIoXnwgKVwiK2Uuc3BsaXQoXCIgXCIpLmpvaW4oXCJ8XCIpK1wiKCB8JClcIixcImdpXCIpLGk9dSh0KS5yZXBsYWNlKG8sXCIgXCIpO3AodCxpKX19ZnVuY3Rpb24gbCh0LGUpe2lmKFwidW5kZWZpbmVkXCIhPXR5cGVvZiB0LmNsYXNzTGlzdCllLnNwbGl0KFwiIFwiKS5mb3JFYWNoKGZ1bmN0aW9uKGUpe2UudHJpbSgpJiZ0LmNsYXNzTGlzdC5hZGQoZSl9KTtlbHNle2godCxlKTt2YXIgbz11KHQpKyhcIiBcIitlKTtwKHQsbyl9fWZ1bmN0aW9uIGQodCxlKXtpZihcInVuZGVmaW5lZFwiIT10eXBlb2YgdC5jbGFzc0xpc3QpcmV0dXJuIHQuY2xhc3NMaXN0LmNvbnRhaW5zKGUpO3ZhciBvPXUodCk7cmV0dXJuIG5ldyBSZWdFeHAoXCIoXnwgKVwiK2UrXCIoIHwkKVwiLFwiZ2lcIikudGVzdChvKX1mdW5jdGlvbiB1KHQpe3JldHVybiB0LmNsYXNzTmFtZSBpbnN0YW5jZW9mIFNWR0FuaW1hdGVkU3RyaW5nP3QuY2xhc3NOYW1lLmJhc2VWYWw6dC5jbGFzc05hbWV9ZnVuY3Rpb24gcCh0LGUpe3Quc2V0QXR0cmlidXRlKFwiY2xhc3NcIixlKX1mdW5jdGlvbiBjKHQsZSxvKXtvLmZvckVhY2goZnVuY3Rpb24obyl7LTE9PT1lLmluZGV4T2YobykmJmQodCxvKSYmaCh0LG8pfSksZS5mb3JFYWNoKGZ1bmN0aW9uKGUpe2QodCxlKXx8bCh0LGUpfSl9ZnVuY3Rpb24gaSh0LGUpe2lmKCEodCBpbnN0YW5jZW9mIGUpKXRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIil9ZnVuY3Rpb24gZyh0LGUpe3ZhciBvPWFyZ3VtZW50cy5sZW5ndGg8PTJ8fHZvaWQgMD09PWFyZ3VtZW50c1syXT8xOmFyZ3VtZW50c1syXTtyZXR1cm4gdCtvPj1lJiZlPj10LW99ZnVuY3Rpb24gbSgpe3JldHVyblwidW5kZWZpbmVkXCIhPXR5cGVvZiBwZXJmb3JtYW5jZSYmXCJ1bmRlZmluZWRcIiE9dHlwZW9mIHBlcmZvcm1hbmNlLm5vdz9wZXJmb3JtYW5jZS5ub3coKTorbmV3IERhdGV9ZnVuY3Rpb24gdigpe2Zvcih2YXIgdD17dG9wOjAsbGVmdDowfSxlPWFyZ3VtZW50cy5sZW5ndGgsbz1BcnJheShlKSxpPTA7ZT5pO2krKylvW2ldPWFyZ3VtZW50c1tpXTtyZXR1cm4gby5mb3JFYWNoKGZ1bmN0aW9uKGUpe3ZhciBvPWUudG9wLGk9ZS5sZWZ0O1wic3RyaW5nXCI9PXR5cGVvZiBvJiYobz1wYXJzZUZsb2F0KG8sMTApKSxcInN0cmluZ1wiPT10eXBlb2YgaSYmKGk9cGFyc2VGbG9hdChpLDEwKSksdC50b3ArPW8sdC5sZWZ0Kz1pfSksdH1mdW5jdGlvbiB5KHQsZSl7cmV0dXJuXCJzdHJpbmdcIj09dHlwZW9mIHQubGVmdCYmLTEhPT10LmxlZnQuaW5kZXhPZihcIiVcIikmJih0LmxlZnQ9cGFyc2VGbG9hdCh0LmxlZnQsMTApLzEwMCplLndpZHRoKSxcInN0cmluZ1wiPT10eXBlb2YgdC50b3AmJi0xIT09dC50b3AuaW5kZXhPZihcIiVcIikmJih0LnRvcD1wYXJzZUZsb2F0KHQudG9wLDEwKS8xMDAqZS5oZWlnaHQpLHR9ZnVuY3Rpb24gYih0LGUpe3JldHVyblwic2Nyb2xsUGFyZW50XCI9PT1lP2U9dC5zY3JvbGxQYXJlbnQ6XCJ3aW5kb3dcIj09PWUmJihlPVtwYWdlWE9mZnNldCxwYWdlWU9mZnNldCxpbm5lcldpZHRoK3BhZ2VYT2Zmc2V0LGlubmVySGVpZ2h0K3BhZ2VZT2Zmc2V0XSksZT09PWRvY3VtZW50JiYoZT1lLmRvY3VtZW50RWxlbWVudCksXCJ1bmRlZmluZWRcIiE9dHlwZW9mIGUubm9kZVR5cGUmJiFmdW5jdGlvbigpe3ZhciB0PXIoZSksbz10LGk9Z2V0Q29tcHV0ZWRTdHlsZShlKTtlPVtvLmxlZnQsby50b3AsdC53aWR0aCtvLmxlZnQsdC5oZWlnaHQrby50b3BdLFUuZm9yRWFjaChmdW5jdGlvbih0LG8pe3Q9dFswXS50b1VwcGVyQ2FzZSgpK3Quc3Vic3RyKDEpLFwiVG9wXCI9PT10fHxcIkxlZnRcIj09PXQ/ZVtvXSs9cGFyc2VGbG9hdChpW1wiYm9yZGVyXCIrdCtcIldpZHRoXCJdKTplW29dLT1wYXJzZUZsb2F0KGlbXCJib3JkZXJcIit0K1wiV2lkdGhcIl0pfSl9KCksZX12YXIgdz1mdW5jdGlvbigpe2Z1bmN0aW9uIHQodCxlKXtmb3IodmFyIG89MDtvPGUubGVuZ3RoO28rKyl7dmFyIGk9ZVtvXTtpLmVudW1lcmFibGU9aS5lbnVtZXJhYmxlfHwhMSxpLmNvbmZpZ3VyYWJsZT0hMCxcInZhbHVlXCJpbiBpJiYoaS53cml0YWJsZT0hMCksT2JqZWN0LmRlZmluZVByb3BlcnR5KHQsaS5rZXksaSl9fXJldHVybiBmdW5jdGlvbihlLG8saSl7cmV0dXJuIG8mJnQoZS5wcm90b3R5cGUsbyksaSYmdChlLGkpLGV9fSgpLEM9dm9pZCAwO1widW5kZWZpbmVkXCI9PXR5cGVvZiBDJiYoQz17bW9kdWxlczpbXX0pO3ZhciBPPWZ1bmN0aW9uKCl7dmFyIHQ9MDtyZXR1cm4gZnVuY3Rpb24oKXtyZXR1cm4rK3R9fSgpLEU9e30seD1mdW5jdGlvbih0KXt2YXIgZT10Ll90ZXRoZXJaZXJvRWxlbWVudDtcInVuZGVmaW5lZFwiPT10eXBlb2YgZSYmKGU9dC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpLGUuc2V0QXR0cmlidXRlKFwiZGF0YS10ZXRoZXItaWRcIixPKCkpLGYoZS5zdHlsZSx7dG9wOjAsbGVmdDowLHBvc2l0aW9uOlwiYWJzb2x1dGVcIn0pLHQuYm9keS5hcHBlbmRDaGlsZChlKSx0Ll90ZXRoZXJaZXJvRWxlbWVudD1lKTt2YXIgbz1lLmdldEF0dHJpYnV0ZShcImRhdGEtdGV0aGVyLWlkXCIpO2lmKFwidW5kZWZpbmVkXCI9PXR5cGVvZiBFW29dKXtFW29dPXt9O3ZhciBpPWUuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7Zm9yKHZhciBuIGluIGkpRVtvXVtuXT1pW25dO1QoZnVuY3Rpb24oKXtkZWxldGUgRVtvXX0pfXJldHVybiBFW29dfSxBPVtdLFQ9ZnVuY3Rpb24odCl7QS5wdXNoKHQpfSxTPWZ1bmN0aW9uKCl7Zm9yKHZhciB0PXZvaWQgMDt0PUEucG9wKCk7KXQoKX0sVz1mdW5jdGlvbigpe2Z1bmN0aW9uIHQoKXtpKHRoaXMsdCl9cmV0dXJuIHcodCxbe2tleTpcIm9uXCIsdmFsdWU6ZnVuY3Rpb24odCxlLG8pe3ZhciBpPWFyZ3VtZW50cy5sZW5ndGg8PTN8fHZvaWQgMD09PWFyZ3VtZW50c1szXT8hMTphcmd1bWVudHNbM107XCJ1bmRlZmluZWRcIj09dHlwZW9mIHRoaXMuYmluZGluZ3MmJih0aGlzLmJpbmRpbmdzPXt9KSxcInVuZGVmaW5lZFwiPT10eXBlb2YgdGhpcy5iaW5kaW5nc1t0XSYmKHRoaXMuYmluZGluZ3NbdF09W10pLHRoaXMuYmluZGluZ3NbdF0ucHVzaCh7aGFuZGxlcjplLGN0eDpvLG9uY2U6aX0pfX0se2tleTpcIm9uY2VcIix2YWx1ZTpmdW5jdGlvbih0LGUsbyl7dGhpcy5vbih0LGUsbywhMCl9fSx7a2V5Olwib2ZmXCIsdmFsdWU6ZnVuY3Rpb24odCxlKXtpZihcInVuZGVmaW5lZFwiPT10eXBlb2YgdGhpcy5iaW5kaW5nc3x8XCJ1bmRlZmluZWRcIj09dHlwZW9mIHRoaXMuYmluZGluZ3NbdF0paWYoXCJ1bmRlZmluZWRcIj09dHlwZW9mIGUpZGVsZXRlIHRoaXMuYmluZGluZ3NbdF07ZWxzZSBmb3IodmFyIG89MDtvPHRoaXMuYmluZGluZ3NbdF0ubGVuZ3RoOyl0aGlzLmJpbmRpbmdzW3RdW29dLmhhbmRsZXI9PT1lP3RoaXMuYmluZGluZ3NbdF0uc3BsaWNlKG8sMSk6KytvfX0se2tleTpcInRyaWdnZXJcIix2YWx1ZTpmdW5jdGlvbih0KXtpZihcInVuZGVmaW5lZFwiIT10eXBlb2YgdGhpcy5iaW5kaW5ncyYmdGhpcy5iaW5kaW5nc1t0XSl7Zm9yKHZhciBlPTAsbz1hcmd1bWVudHMubGVuZ3RoLGk9QXJyYXkobz4xP28tMTowKSxuPTE7bz5uO24rKylpW24tMV09YXJndW1lbnRzW25dO2Zvcig7ZTx0aGlzLmJpbmRpbmdzW3RdLmxlbmd0aDspe3ZhciByPXRoaXMuYmluZGluZ3NbdF1bZV0scz1yLmhhbmRsZXIsYT1yLmN0eCxmPXIub25jZSxoPWE7XCJ1bmRlZmluZWRcIj09dHlwZW9mIGgmJihoPXRoaXMpLHMuYXBwbHkoaCxpKSxmP3RoaXMuYmluZGluZ3NbdF0uc3BsaWNlKGUsMSk6KytlfX19fV0pLHR9KCk7Qy5VdGlscz17Z2V0U2Nyb2xsUGFyZW50Om4sZ2V0Qm91bmRzOnIsZ2V0T2Zmc2V0UGFyZW50OnMsZXh0ZW5kOmYsYWRkQ2xhc3M6bCxyZW1vdmVDbGFzczpoLGhhc0NsYXNzOmQsdXBkYXRlQ2xhc3NlczpjLGRlZmVyOlQsZmx1c2g6Uyx1bmlxdWVJZDpPLEV2ZW50ZWQ6VyxnZXRTY3JvbGxCYXJTaXplOmF9O3ZhciBNPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCh0LGUpe3ZhciBvPVtdLGk9ITAsbj0hMSxyPXZvaWQgMDt0cnl7Zm9yKHZhciBzLGE9dFtTeW1ib2wuaXRlcmF0b3JdKCk7IShpPShzPWEubmV4dCgpKS5kb25lKSYmKG8ucHVzaChzLnZhbHVlKSwhZXx8by5sZW5ndGghPT1lKTtpPSEwKTt9Y2F0Y2goZil7bj0hMCxyPWZ9ZmluYWxseXt0cnl7IWkmJmFbXCJyZXR1cm5cIl0mJmFbXCJyZXR1cm5cIl0oKX1maW5hbGx5e2lmKG4pdGhyb3cgcn19cmV0dXJuIG99cmV0dXJuIGZ1bmN0aW9uKGUsbyl7aWYoQXJyYXkuaXNBcnJheShlKSlyZXR1cm4gZTtpZihTeW1ib2wuaXRlcmF0b3IgaW4gT2JqZWN0KGUpKXJldHVybiB0KGUsbyk7dGhyb3cgbmV3IFR5cGVFcnJvcihcIkludmFsaWQgYXR0ZW1wdCB0byBkZXN0cnVjdHVyZSBub24taXRlcmFibGUgaW5zdGFuY2VcIil9fSgpLHc9ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KHQsZSl7Zm9yKHZhciBvPTA7bzxlLmxlbmd0aDtvKyspe3ZhciBpPWVbb107aS5lbnVtZXJhYmxlPWkuZW51bWVyYWJsZXx8ITEsaS5jb25maWd1cmFibGU9ITAsXCJ2YWx1ZVwiaW4gaSYmKGkud3JpdGFibGU9ITApLE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LGkua2V5LGkpfX1yZXR1cm4gZnVuY3Rpb24oZSxvLGkpe3JldHVybiBvJiZ0KGUucHJvdG90eXBlLG8pLGkmJnQoZSxpKSxlfX0oKTtpZihcInVuZGVmaW5lZFwiPT10eXBlb2YgQyl0aHJvdyBuZXcgRXJyb3IoXCJZb3UgbXVzdCBpbmNsdWRlIHRoZSB1dGlscy5qcyBmaWxlIGJlZm9yZSB0ZXRoZXIuanNcIik7dmFyIFA9Qy5VdGlscyxuPVAuZ2V0U2Nyb2xsUGFyZW50LHI9UC5nZXRCb3VuZHMscz1QLmdldE9mZnNldFBhcmVudCxmPVAuZXh0ZW5kLGw9UC5hZGRDbGFzcyxoPVAucmVtb3ZlQ2xhc3MsYz1QLnVwZGF0ZUNsYXNzZXMsVD1QLmRlZmVyLFM9UC5mbHVzaCxhPVAuZ2V0U2Nyb2xsQmFyU2l6ZSxrPWZ1bmN0aW9uKCl7aWYoXCJ1bmRlZmluZWRcIj09dHlwZW9mIGRvY3VtZW50KXJldHVyblwiXCI7Zm9yKHZhciB0PWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiksZT1bXCJ0cmFuc2Zvcm1cIixcIndlYmtpdFRyYW5zZm9ybVwiLFwiT1RyYW5zZm9ybVwiLFwiTW96VHJhbnNmb3JtXCIsXCJtc1RyYW5zZm9ybVwiXSxvPTA7bzxlLmxlbmd0aDsrK28pe3ZhciBpPWVbb107aWYodm9pZCAwIT09dC5zdHlsZVtpXSlyZXR1cm4gaX19KCksQj1bXSxfPWZ1bmN0aW9uKCl7Qi5mb3JFYWNoKGZ1bmN0aW9uKHQpe3QucG9zaXRpb24oITEpfSksUygpfTshZnVuY3Rpb24oKXt2YXIgdD1udWxsLGU9bnVsbCxvPW51bGwsaT1mdW5jdGlvbiBuKCl7cmV0dXJuXCJ1bmRlZmluZWRcIiE9dHlwZW9mIGUmJmU+MTY/KGU9TWF0aC5taW4oZS0xNiwyNTApLHZvaWQobz1zZXRUaW1lb3V0KG4sMjUwKSkpOnZvaWQoXCJ1bmRlZmluZWRcIiE9dHlwZW9mIHQmJm0oKS10PDEwfHwoXCJ1bmRlZmluZWRcIiE9dHlwZW9mIG8mJihjbGVhclRpbWVvdXQobyksbz1udWxsKSx0PW0oKSxfKCksZT1tKCktdCkpfTtcInVuZGVmaW5lZFwiIT10eXBlb2Ygd2luZG93JiZbXCJyZXNpemVcIixcInNjcm9sbFwiLFwidG91Y2htb3ZlXCJdLmZvckVhY2goZnVuY3Rpb24odCl7d2luZG93LmFkZEV2ZW50TGlzdGVuZXIodCxpKX0pfSgpO3ZhciB6PXtjZW50ZXI6XCJjZW50ZXJcIixsZWZ0OlwicmlnaHRcIixyaWdodDpcImxlZnRcIn0sRj17bWlkZGxlOlwibWlkZGxlXCIsdG9wOlwiYm90dG9tXCIsYm90dG9tOlwidG9wXCJ9LEw9e3RvcDowLGxlZnQ6MCxtaWRkbGU6XCI1MCVcIixjZW50ZXI6XCI1MCVcIixib3R0b206XCIxMDAlXCIscmlnaHQ6XCIxMDAlXCJ9LFk9ZnVuY3Rpb24odCxlKXt2YXIgbz10LmxlZnQsaT10LnRvcDtyZXR1cm5cImF1dG9cIj09PW8mJihvPXpbZS5sZWZ0XSksXCJhdXRvXCI9PT1pJiYoaT1GW2UudG9wXSkse2xlZnQ6byx0b3A6aX19LEg9ZnVuY3Rpb24odCl7dmFyIGU9dC5sZWZ0LG89dC50b3A7cmV0dXJuXCJ1bmRlZmluZWRcIiE9dHlwZW9mIExbdC5sZWZ0XSYmKGU9TFt0LmxlZnRdKSxcInVuZGVmaW5lZFwiIT10eXBlb2YgTFt0LnRvcF0mJihvPUxbdC50b3BdKSx7bGVmdDplLHRvcDpvfX0sWD1mdW5jdGlvbih0KXt2YXIgZT10LnNwbGl0KFwiIFwiKSxvPU0oZSwyKSxpPW9bMF0sbj1vWzFdO3JldHVybnt0b3A6aSxsZWZ0Om59fSxqPVgsTj1mdW5jdGlvbigpe2Z1bmN0aW9uIHQoZSl7dmFyIG89dGhpcztpKHRoaXMsdCksdGhpcy5wb3NpdGlvbj10aGlzLnBvc2l0aW9uLmJpbmQodGhpcyksQi5wdXNoKHRoaXMpLHRoaXMuaGlzdG9yeT1bXSx0aGlzLnNldE9wdGlvbnMoZSwhMSksQy5tb2R1bGVzLmZvckVhY2goZnVuY3Rpb24odCl7XCJ1bmRlZmluZWRcIiE9dHlwZW9mIHQuaW5pdGlhbGl6ZSYmdC5pbml0aWFsaXplLmNhbGwobyl9KSx0aGlzLnBvc2l0aW9uKCl9cmV0dXJuIHcodCxbe2tleTpcImdldENsYXNzXCIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgdD1hcmd1bWVudHMubGVuZ3RoPD0wfHx2b2lkIDA9PT1hcmd1bWVudHNbMF0/XCJcIjphcmd1bWVudHNbMF0sZT10aGlzLm9wdGlvbnMuY2xhc3NlcztyZXR1cm5cInVuZGVmaW5lZFwiIT10eXBlb2YgZSYmZVt0XT90aGlzLm9wdGlvbnMuY2xhc3Nlc1t0XTp0aGlzLm9wdGlvbnMuY2xhc3NQcmVmaXg/dGhpcy5vcHRpb25zLmNsYXNzUHJlZml4K1wiLVwiK3Q6dH19LHtrZXk6XCJzZXRPcHRpb25zXCIsdmFsdWU6ZnVuY3Rpb24odCl7dmFyIGU9dGhpcyxvPWFyZ3VtZW50cy5sZW5ndGg8PTF8fHZvaWQgMD09PWFyZ3VtZW50c1sxXT8hMDphcmd1bWVudHNbMV0saT17b2Zmc2V0OlwiMCAwXCIsdGFyZ2V0T2Zmc2V0OlwiMCAwXCIsdGFyZ2V0QXR0YWNobWVudDpcImF1dG8gYXV0b1wiLGNsYXNzUHJlZml4OlwidGV0aGVyXCJ9O3RoaXMub3B0aW9ucz1mKGksdCk7dmFyIHI9dGhpcy5vcHRpb25zLHM9ci5lbGVtZW50LGE9ci50YXJnZXQsaD1yLnRhcmdldE1vZGlmaWVyO2lmKHRoaXMuZWxlbWVudD1zLHRoaXMudGFyZ2V0PWEsdGhpcy50YXJnZXRNb2RpZmllcj1oLFwidmlld3BvcnRcIj09PXRoaXMudGFyZ2V0Pyh0aGlzLnRhcmdldD1kb2N1bWVudC5ib2R5LHRoaXMudGFyZ2V0TW9kaWZpZXI9XCJ2aXNpYmxlXCIpOlwic2Nyb2xsLWhhbmRsZVwiPT09dGhpcy50YXJnZXQmJih0aGlzLnRhcmdldD1kb2N1bWVudC5ib2R5LHRoaXMudGFyZ2V0TW9kaWZpZXI9XCJzY3JvbGwtaGFuZGxlXCIpLFtcImVsZW1lbnRcIixcInRhcmdldFwiXS5mb3JFYWNoKGZ1bmN0aW9uKHQpe2lmKFwidW5kZWZpbmVkXCI9PXR5cGVvZiBlW3RdKXRocm93IG5ldyBFcnJvcihcIlRldGhlciBFcnJvcjogQm90aCBlbGVtZW50IGFuZCB0YXJnZXQgbXVzdCBiZSBkZWZpbmVkXCIpO1widW5kZWZpbmVkXCIhPXR5cGVvZiBlW3RdLmpxdWVyeT9lW3RdPWVbdF1bMF06XCJzdHJpbmdcIj09dHlwZW9mIGVbdF0mJihlW3RdPWRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoZVt0XSkpfSksbCh0aGlzLmVsZW1lbnQsdGhpcy5nZXRDbGFzcyhcImVsZW1lbnRcIikpLHRoaXMub3B0aW9ucy5hZGRUYXJnZXRDbGFzc2VzIT09ITEmJmwodGhpcy50YXJnZXQsdGhpcy5nZXRDbGFzcyhcInRhcmdldFwiKSksIXRoaXMub3B0aW9ucy5hdHRhY2htZW50KXRocm93IG5ldyBFcnJvcihcIlRldGhlciBFcnJvcjogWW91IG11c3QgcHJvdmlkZSBhbiBhdHRhY2htZW50XCIpO3RoaXMudGFyZ2V0QXR0YWNobWVudD1qKHRoaXMub3B0aW9ucy50YXJnZXRBdHRhY2htZW50KSx0aGlzLmF0dGFjaG1lbnQ9aih0aGlzLm9wdGlvbnMuYXR0YWNobWVudCksdGhpcy5vZmZzZXQ9WCh0aGlzLm9wdGlvbnMub2Zmc2V0KSx0aGlzLnRhcmdldE9mZnNldD1YKHRoaXMub3B0aW9ucy50YXJnZXRPZmZzZXQpLFwidW5kZWZpbmVkXCIhPXR5cGVvZiB0aGlzLnNjcm9sbFBhcmVudCYmdGhpcy5kaXNhYmxlKCksXCJzY3JvbGwtaGFuZGxlXCI9PT10aGlzLnRhcmdldE1vZGlmaWVyP3RoaXMuc2Nyb2xsUGFyZW50PXRoaXMudGFyZ2V0OnRoaXMuc2Nyb2xsUGFyZW50PW4odGhpcy50YXJnZXQpLHRoaXMub3B0aW9ucy5lbmFibGVkIT09ITEmJnRoaXMuZW5hYmxlKG8pfX0se2tleTpcImdldFRhcmdldEJvdW5kc1wiLHZhbHVlOmZ1bmN0aW9uKCl7aWYoXCJ1bmRlZmluZWRcIj09dHlwZW9mIHRoaXMudGFyZ2V0TW9kaWZpZXIpcmV0dXJuIHIodGhpcy50YXJnZXQpO2lmKFwidmlzaWJsZVwiPT09dGhpcy50YXJnZXRNb2RpZmllcil7aWYodGhpcy50YXJnZXQ9PT1kb2N1bWVudC5ib2R5KXJldHVybnt0b3A6cGFnZVlPZmZzZXQsbGVmdDpwYWdlWE9mZnNldCxoZWlnaHQ6aW5uZXJIZWlnaHQsd2lkdGg6aW5uZXJXaWR0aH07dmFyIHQ9cih0aGlzLnRhcmdldCksZT17aGVpZ2h0OnQuaGVpZ2h0LHdpZHRoOnQud2lkdGgsdG9wOnQudG9wLGxlZnQ6dC5sZWZ0fTtyZXR1cm4gZS5oZWlnaHQ9TWF0aC5taW4oZS5oZWlnaHQsdC5oZWlnaHQtKHBhZ2VZT2Zmc2V0LXQudG9wKSksZS5oZWlnaHQ9TWF0aC5taW4oZS5oZWlnaHQsdC5oZWlnaHQtKHQudG9wK3QuaGVpZ2h0LShwYWdlWU9mZnNldCtpbm5lckhlaWdodCkpKSxlLmhlaWdodD1NYXRoLm1pbihpbm5lckhlaWdodCxlLmhlaWdodCksZS5oZWlnaHQtPTIsZS53aWR0aD1NYXRoLm1pbihlLndpZHRoLHQud2lkdGgtKHBhZ2VYT2Zmc2V0LXQubGVmdCkpLGUud2lkdGg9TWF0aC5taW4oZS53aWR0aCx0LndpZHRoLSh0LmxlZnQrdC53aWR0aC0ocGFnZVhPZmZzZXQraW5uZXJXaWR0aCkpKSxlLndpZHRoPU1hdGgubWluKGlubmVyV2lkdGgsZS53aWR0aCksZS53aWR0aC09MixlLnRvcDxwYWdlWU9mZnNldCYmKGUudG9wPXBhZ2VZT2Zmc2V0KSxlLmxlZnQ8cGFnZVhPZmZzZXQmJihlLmxlZnQ9cGFnZVhPZmZzZXQpLGV9aWYoXCJzY3JvbGwtaGFuZGxlXCI9PT10aGlzLnRhcmdldE1vZGlmaWVyKXt2YXIgdD12b2lkIDAsbz10aGlzLnRhcmdldDtvPT09ZG9jdW1lbnQuYm9keT8obz1kb2N1bWVudC5kb2N1bWVudEVsZW1lbnQsdD17bGVmdDpwYWdlWE9mZnNldCx0b3A6cGFnZVlPZmZzZXQsaGVpZ2h0OmlubmVySGVpZ2h0LHdpZHRoOmlubmVyV2lkdGh9KTp0PXIobyk7dmFyIGk9Z2V0Q29tcHV0ZWRTdHlsZShvKSxuPW8uc2Nyb2xsV2lkdGg+by5jbGllbnRXaWR0aHx8W2kub3ZlcmZsb3csaS5vdmVyZmxvd1hdLmluZGV4T2YoXCJzY3JvbGxcIik+PTB8fHRoaXMudGFyZ2V0IT09ZG9jdW1lbnQuYm9keSxzPTA7biYmKHM9MTUpO3ZhciBhPXQuaGVpZ2h0LXBhcnNlRmxvYXQoaS5ib3JkZXJUb3BXaWR0aCktcGFyc2VGbG9hdChpLmJvcmRlckJvdHRvbVdpZHRoKS1zLGU9e3dpZHRoOjE1LGhlaWdodDouOTc1KmEqKGEvby5zY3JvbGxIZWlnaHQpLGxlZnQ6dC5sZWZ0K3Qud2lkdGgtcGFyc2VGbG9hdChpLmJvcmRlckxlZnRXaWR0aCktMTV9LGY9MDs0MDg+YSYmdGhpcy50YXJnZXQ9PT1kb2N1bWVudC5ib2R5JiYoZj0tMTFlLTUqTWF0aC5wb3coYSwyKS0uMDA3MjcqYSsyMi41OCksdGhpcy50YXJnZXQhPT1kb2N1bWVudC5ib2R5JiYoZS5oZWlnaHQ9TWF0aC5tYXgoZS5oZWlnaHQsMjQpKTt2YXIgaD10aGlzLnRhcmdldC5zY3JvbGxUb3AvKG8uc2Nyb2xsSGVpZ2h0LWEpO3JldHVybiBlLnRvcD1oKihhLWUuaGVpZ2h0LWYpK3QudG9wK3BhcnNlRmxvYXQoaS5ib3JkZXJUb3BXaWR0aCksdGhpcy50YXJnZXQ9PT1kb2N1bWVudC5ib2R5JiYoZS5oZWlnaHQ9TWF0aC5tYXgoZS5oZWlnaHQsMjQpKSxlfX19LHtrZXk6XCJjbGVhckNhY2hlXCIsdmFsdWU6ZnVuY3Rpb24oKXt0aGlzLl9jYWNoZT17fX19LHtrZXk6XCJjYWNoZVwiLHZhbHVlOmZ1bmN0aW9uKHQsZSl7cmV0dXJuXCJ1bmRlZmluZWRcIj09dHlwZW9mIHRoaXMuX2NhY2hlJiYodGhpcy5fY2FjaGU9e30pLFwidW5kZWZpbmVkXCI9PXR5cGVvZiB0aGlzLl9jYWNoZVt0XSYmKHRoaXMuX2NhY2hlW3RdPWUuY2FsbCh0aGlzKSksdGhpcy5fY2FjaGVbdF19fSx7a2V5OlwiZW5hYmxlXCIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgdD1hcmd1bWVudHMubGVuZ3RoPD0wfHx2b2lkIDA9PT1hcmd1bWVudHNbMF0/ITA6YXJndW1lbnRzWzBdO3RoaXMub3B0aW9ucy5hZGRUYXJnZXRDbGFzc2VzIT09ITEmJmwodGhpcy50YXJnZXQsdGhpcy5nZXRDbGFzcyhcImVuYWJsZWRcIikpLGwodGhpcy5lbGVtZW50LHRoaXMuZ2V0Q2xhc3MoXCJlbmFibGVkXCIpKSx0aGlzLmVuYWJsZWQ9ITAsdGhpcy5zY3JvbGxQYXJlbnQhPT1kb2N1bWVudCYmdGhpcy5zY3JvbGxQYXJlbnQuYWRkRXZlbnRMaXN0ZW5lcihcInNjcm9sbFwiLHRoaXMucG9zaXRpb24pLHQmJnRoaXMucG9zaXRpb24oKX19LHtrZXk6XCJkaXNhYmxlXCIsdmFsdWU6ZnVuY3Rpb24oKXtoKHRoaXMudGFyZ2V0LHRoaXMuZ2V0Q2xhc3MoXCJlbmFibGVkXCIpKSxoKHRoaXMuZWxlbWVudCx0aGlzLmdldENsYXNzKFwiZW5hYmxlZFwiKSksdGhpcy5lbmFibGVkPSExLFwidW5kZWZpbmVkXCIhPXR5cGVvZiB0aGlzLnNjcm9sbFBhcmVudCYmdGhpcy5zY3JvbGxQYXJlbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInNjcm9sbFwiLHRoaXMucG9zaXRpb24pfX0se2tleTpcImRlc3Ryb3lcIix2YWx1ZTpmdW5jdGlvbigpe3ZhciB0PXRoaXM7dGhpcy5kaXNhYmxlKCksQi5mb3JFYWNoKGZ1bmN0aW9uKGUsbyl7cmV0dXJuIGU9PT10P3ZvaWQgQi5zcGxpY2UobywxKTp2b2lkIDB9KX19LHtrZXk6XCJ1cGRhdGVBdHRhY2hDbGFzc2VzXCIsdmFsdWU6ZnVuY3Rpb24odCxlKXt2YXIgbz10aGlzO3Q9dHx8dGhpcy5hdHRhY2htZW50LGU9ZXx8dGhpcy50YXJnZXRBdHRhY2htZW50O3ZhciBpPVtcImxlZnRcIixcInRvcFwiLFwiYm90dG9tXCIsXCJyaWdodFwiLFwibWlkZGxlXCIsXCJjZW50ZXJcIl07XCJ1bmRlZmluZWRcIiE9dHlwZW9mIHRoaXMuX2FkZEF0dGFjaENsYXNzZXMmJnRoaXMuX2FkZEF0dGFjaENsYXNzZXMubGVuZ3RoJiZ0aGlzLl9hZGRBdHRhY2hDbGFzc2VzLnNwbGljZSgwLHRoaXMuX2FkZEF0dGFjaENsYXNzZXMubGVuZ3RoKSxcInVuZGVmaW5lZFwiPT10eXBlb2YgdGhpcy5fYWRkQXR0YWNoQ2xhc3NlcyYmKHRoaXMuX2FkZEF0dGFjaENsYXNzZXM9W10pO3ZhciBuPXRoaXMuX2FkZEF0dGFjaENsYXNzZXM7dC50b3AmJm4ucHVzaCh0aGlzLmdldENsYXNzKFwiZWxlbWVudC1hdHRhY2hlZFwiKStcIi1cIit0LnRvcCksdC5sZWZ0JiZuLnB1c2godGhpcy5nZXRDbGFzcyhcImVsZW1lbnQtYXR0YWNoZWRcIikrXCItXCIrdC5sZWZ0KSxlLnRvcCYmbi5wdXNoKHRoaXMuZ2V0Q2xhc3MoXCJ0YXJnZXQtYXR0YWNoZWRcIikrXCItXCIrZS50b3ApLGUubGVmdCYmbi5wdXNoKHRoaXMuZ2V0Q2xhc3MoXCJ0YXJnZXQtYXR0YWNoZWRcIikrXCItXCIrZS5sZWZ0KTt2YXIgcj1bXTtpLmZvckVhY2goZnVuY3Rpb24odCl7ci5wdXNoKG8uZ2V0Q2xhc3MoXCJlbGVtZW50LWF0dGFjaGVkXCIpK1wiLVwiK3QpLHIucHVzaChvLmdldENsYXNzKFwidGFyZ2V0LWF0dGFjaGVkXCIpK1wiLVwiK3QpfSksVChmdW5jdGlvbigpe1widW5kZWZpbmVkXCIhPXR5cGVvZiBvLl9hZGRBdHRhY2hDbGFzc2VzJiYoYyhvLmVsZW1lbnQsby5fYWRkQXR0YWNoQ2xhc3NlcyxyKSxvLm9wdGlvbnMuYWRkVGFyZ2V0Q2xhc3NlcyE9PSExJiZjKG8udGFyZ2V0LG8uX2FkZEF0dGFjaENsYXNzZXMsciksZGVsZXRlIG8uX2FkZEF0dGFjaENsYXNzZXMpfSl9fSx7a2V5OlwicG9zaXRpb25cIix2YWx1ZTpmdW5jdGlvbigpe3ZhciB0PXRoaXMsZT1hcmd1bWVudHMubGVuZ3RoPD0wfHx2b2lkIDA9PT1hcmd1bWVudHNbMF0/ITA6YXJndW1lbnRzWzBdO2lmKHRoaXMuZW5hYmxlZCl7dGhpcy5jbGVhckNhY2hlKCk7dmFyIG89WSh0aGlzLnRhcmdldEF0dGFjaG1lbnQsdGhpcy5hdHRhY2htZW50KTt0aGlzLnVwZGF0ZUF0dGFjaENsYXNzZXModGhpcy5hdHRhY2htZW50LG8pO3ZhciBpPXRoaXMuY2FjaGUoXCJlbGVtZW50LWJvdW5kc1wiLGZ1bmN0aW9uKCl7cmV0dXJuIHIodC5lbGVtZW50KX0pLG49aS53aWR0aCxmPWkuaGVpZ2h0O2lmKDA9PT1uJiYwPT09ZiYmXCJ1bmRlZmluZWRcIiE9dHlwZW9mIHRoaXMubGFzdFNpemUpe3ZhciBoPXRoaXMubGFzdFNpemU7bj1oLndpZHRoLGY9aC5oZWlnaHR9ZWxzZSB0aGlzLmxhc3RTaXplPXt3aWR0aDpuLGhlaWdodDpmfTt2YXIgbD10aGlzLmNhY2hlKFwidGFyZ2V0LWJvdW5kc1wiLGZ1bmN0aW9uKCl7cmV0dXJuIHQuZ2V0VGFyZ2V0Qm91bmRzKCl9KSxkPWwsdT15KEgodGhpcy5hdHRhY2htZW50KSx7d2lkdGg6bixoZWlnaHQ6Zn0pLHA9eShIKG8pLGQpLGM9eSh0aGlzLm9mZnNldCx7d2lkdGg6bixoZWlnaHQ6Zn0pLGc9eSh0aGlzLnRhcmdldE9mZnNldCxkKTt1PXYodSxjKSxwPXYocCxnKTtmb3IodmFyIG09bC5sZWZ0K3AubGVmdC11LmxlZnQsYj1sLnRvcCtwLnRvcC11LnRvcCx3PTA7dzxDLm1vZHVsZXMubGVuZ3RoOysrdyl7dmFyIE89Qy5tb2R1bGVzW3ddLEU9Ty5wb3NpdGlvbi5jYWxsKHRoaXMse2xlZnQ6bSx0b3A6Yix0YXJnZXRBdHRhY2htZW50Om8sdGFyZ2V0UG9zOmwsZWxlbWVudFBvczppLG9mZnNldDp1LHRhcmdldE9mZnNldDpwLG1hbnVhbE9mZnNldDpjLG1hbnVhbFRhcmdldE9mZnNldDpnLHNjcm9sbGJhclNpemU6QSxhdHRhY2htZW50OnRoaXMuYXR0YWNobWVudH0pO2lmKEU9PT0hMSlyZXR1cm4hMTtcInVuZGVmaW5lZFwiIT10eXBlb2YgRSYmXCJvYmplY3RcIj09dHlwZW9mIEUmJihiPUUudG9wLG09RS5sZWZ0KX12YXIgeD17cGFnZTp7dG9wOmIsbGVmdDptfSx2aWV3cG9ydDp7dG9wOmItcGFnZVlPZmZzZXQsYm90dG9tOnBhZ2VZT2Zmc2V0LWItZitpbm5lckhlaWdodCxsZWZ0Om0tcGFnZVhPZmZzZXQscmlnaHQ6cGFnZVhPZmZzZXQtbS1uK2lubmVyV2lkdGh9fSxBPXZvaWQgMDtyZXR1cm4gZG9jdW1lbnQuYm9keS5zY3JvbGxXaWR0aD53aW5kb3cuaW5uZXJXaWR0aCYmKEE9dGhpcy5jYWNoZShcInNjcm9sbGJhci1zaXplXCIsYSkseC52aWV3cG9ydC5ib3R0b20tPUEuaGVpZ2h0KSxkb2N1bWVudC5ib2R5LnNjcm9sbEhlaWdodD53aW5kb3cuaW5uZXJIZWlnaHQmJihBPXRoaXMuY2FjaGUoXCJzY3JvbGxiYXItc2l6ZVwiLGEpLHgudmlld3BvcnQucmlnaHQtPUEud2lkdGgpLCgtMT09PVtcIlwiLFwic3RhdGljXCJdLmluZGV4T2YoZG9jdW1lbnQuYm9keS5zdHlsZS5wb3NpdGlvbil8fC0xPT09W1wiXCIsXCJzdGF0aWNcIl0uaW5kZXhPZihkb2N1bWVudC5ib2R5LnBhcmVudEVsZW1lbnQuc3R5bGUucG9zaXRpb24pKSYmKHgucGFnZS5ib3R0b209ZG9jdW1lbnQuYm9keS5zY3JvbGxIZWlnaHQtYi1mLHgucGFnZS5yaWdodD1kb2N1bWVudC5ib2R5LnNjcm9sbFdpZHRoLW0tbiksXCJ1bmRlZmluZWRcIiE9dHlwZW9mIHRoaXMub3B0aW9ucy5vcHRpbWl6YXRpb25zJiZ0aGlzLm9wdGlvbnMub3B0aW1pemF0aW9ucy5tb3ZlRWxlbWVudCE9PSExJiZcInVuZGVmaW5lZFwiPT10eXBlb2YgdGhpcy50YXJnZXRNb2RpZmllciYmIWZ1bmN0aW9uKCl7dmFyIGU9dC5jYWNoZShcInRhcmdldC1vZmZzZXRwYXJlbnRcIixmdW5jdGlvbigpe3JldHVybiBzKHQudGFyZ2V0KX0pLG89dC5jYWNoZShcInRhcmdldC1vZmZzZXRwYXJlbnQtYm91bmRzXCIsZnVuY3Rpb24oKXtyZXR1cm4gcihlKX0pLGk9Z2V0Q29tcHV0ZWRTdHlsZShlKSxuPW8sYT17fTtpZihbXCJUb3BcIixcIkxlZnRcIixcIkJvdHRvbVwiLFwiUmlnaHRcIl0uZm9yRWFjaChmdW5jdGlvbih0KXthW3QudG9Mb3dlckNhc2UoKV09cGFyc2VGbG9hdChpW1wiYm9yZGVyXCIrdCtcIldpZHRoXCJdKX0pLG8ucmlnaHQ9ZG9jdW1lbnQuYm9keS5zY3JvbGxXaWR0aC1vLmxlZnQtbi53aWR0aCthLnJpZ2h0LG8uYm90dG9tPWRvY3VtZW50LmJvZHkuc2Nyb2xsSGVpZ2h0LW8udG9wLW4uaGVpZ2h0K2EuYm90dG9tLHgucGFnZS50b3A+PW8udG9wK2EudG9wJiZ4LnBhZ2UuYm90dG9tPj1vLmJvdHRvbSYmeC5wYWdlLmxlZnQ+PW8ubGVmdCthLmxlZnQmJngucGFnZS5yaWdodD49by5yaWdodCl7dmFyIGY9ZS5zY3JvbGxUb3AsaD1lLnNjcm9sbExlZnQ7eC5vZmZzZXQ9e3RvcDp4LnBhZ2UudG9wLW8udG9wK2YtYS50b3AsbGVmdDp4LnBhZ2UubGVmdC1vLmxlZnQraC1hLmxlZnR9fX0oKSx0aGlzLm1vdmUoeCksdGhpcy5oaXN0b3J5LnVuc2hpZnQoeCksdGhpcy5oaXN0b3J5Lmxlbmd0aD4zJiZ0aGlzLmhpc3RvcnkucG9wKCksZSYmUygpLCEwfX19LHtrZXk6XCJtb3ZlXCIsdmFsdWU6ZnVuY3Rpb24odCl7dmFyIGU9dGhpcztpZihcInVuZGVmaW5lZFwiIT10eXBlb2YgdGhpcy5lbGVtZW50LnBhcmVudE5vZGUpe3ZhciBvPXt9O2Zvcih2YXIgaSBpbiB0KXtvW2ldPXt9O2Zvcih2YXIgbiBpbiB0W2ldKXtmb3IodmFyIHI9ITEsYT0wO2E8dGhpcy5oaXN0b3J5Lmxlbmd0aDsrK2Epe3ZhciBoPXRoaXMuaGlzdG9yeVthXTtpZihcInVuZGVmaW5lZFwiIT10eXBlb2YgaFtpXSYmIWcoaFtpXVtuXSx0W2ldW25dKSl7cj0hMDticmVha319cnx8KG9baV1bbl09ITApfX12YXIgbD17dG9wOlwiXCIsbGVmdDpcIlwiLHJpZ2h0OlwiXCIsYm90dG9tOlwiXCJ9LGQ9ZnVuY3Rpb24odCxvKXt2YXIgaT1cInVuZGVmaW5lZFwiIT10eXBlb2YgZS5vcHRpb25zLm9wdGltaXphdGlvbnMsbj1pP2Uub3B0aW9ucy5vcHRpbWl6YXRpb25zLmdwdTpudWxsO2lmKG4hPT0hMSl7dmFyIHI9dm9pZCAwLHM9dm9pZCAwO3QudG9wPyhsLnRvcD0wLHI9by50b3ApOihsLmJvdHRvbT0wLHI9LW8uYm90dG9tKSx0LmxlZnQ/KGwubGVmdD0wLHM9by5sZWZ0KToobC5yaWdodD0wLHM9LW8ucmlnaHQpLGxba109XCJ0cmFuc2xhdGVYKFwiK01hdGgucm91bmQocykrXCJweCkgdHJhbnNsYXRlWShcIitNYXRoLnJvdW5kKHIpK1wicHgpXCIsXCJtc1RyYW5zZm9ybVwiIT09ayYmKGxba10rPVwiIHRyYW5zbGF0ZVooMClcIil9ZWxzZSB0LnRvcD9sLnRvcD1vLnRvcCtcInB4XCI6bC5ib3R0b209by5ib3R0b20rXCJweFwiLHQubGVmdD9sLmxlZnQ9by5sZWZ0K1wicHhcIjpsLnJpZ2h0PW8ucmlnaHQrXCJweFwifSx1PSExO2lmKChvLnBhZ2UudG9wfHxvLnBhZ2UuYm90dG9tKSYmKG8ucGFnZS5sZWZ0fHxvLnBhZ2UucmlnaHQpPyhsLnBvc2l0aW9uPVwiYWJzb2x1dGVcIixkKG8ucGFnZSx0LnBhZ2UpKTooby52aWV3cG9ydC50b3B8fG8udmlld3BvcnQuYm90dG9tKSYmKG8udmlld3BvcnQubGVmdHx8by52aWV3cG9ydC5yaWdodCk/KGwucG9zaXRpb249XCJmaXhlZFwiLGQoby52aWV3cG9ydCx0LnZpZXdwb3J0KSk6XCJ1bmRlZmluZWRcIiE9dHlwZW9mIG8ub2Zmc2V0JiZvLm9mZnNldC50b3AmJm8ub2Zmc2V0LmxlZnQ/IWZ1bmN0aW9uKCl7bC5wb3NpdGlvbj1cImFic29sdXRlXCI7dmFyIGk9ZS5jYWNoZShcInRhcmdldC1vZmZzZXRwYXJlbnRcIixmdW5jdGlvbigpe3JldHVybiBzKGUudGFyZ2V0KX0pO3MoZS5lbGVtZW50KSE9PWkmJlQoZnVuY3Rpb24oKXtlLmVsZW1lbnQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChlLmVsZW1lbnQpLGkuYXBwZW5kQ2hpbGQoZS5lbGVtZW50KX0pLGQoby5vZmZzZXQsdC5vZmZzZXQpLHU9ITB9KCk6KGwucG9zaXRpb249XCJhYnNvbHV0ZVwiLGQoe3RvcDohMCxsZWZ0OiEwfSx0LnBhZ2UpKSwhdSl7Zm9yKHZhciBwPSEwLGM9dGhpcy5lbGVtZW50LnBhcmVudE5vZGU7YyYmXCJCT0RZXCIhPT1jLnRhZ05hbWU7KXtpZihcInN0YXRpY1wiIT09Z2V0Q29tcHV0ZWRTdHlsZShjKS5wb3NpdGlvbil7cD0hMTticmVha31jPWMucGFyZW50Tm9kZX1wfHwodGhpcy5lbGVtZW50LnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQodGhpcy5lbGVtZW50KSxkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHRoaXMuZWxlbWVudCkpfXZhciBtPXt9LHY9ITE7Zm9yKHZhciBuIGluIGwpe3ZhciB5PWxbbl0sYj10aGlzLmVsZW1lbnQuc3R5bGVbbl07XCJcIiE9PWImJlwiXCIhPT15JiZbXCJ0b3BcIixcImxlZnRcIixcImJvdHRvbVwiLFwicmlnaHRcIl0uaW5kZXhPZihuKT49MCYmKGI9cGFyc2VGbG9hdChiKSx5PXBhcnNlRmxvYXQoeSkpLGIhPT15JiYodj0hMCxtW25dPXkpfXYmJlQoZnVuY3Rpb24oKXtmKGUuZWxlbWVudC5zdHlsZSxtKX0pfX19XSksdH0oKTtOLm1vZHVsZXM9W10sQy5wb3NpdGlvbj1fO3ZhciBSPWYoTixDKSxNPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCh0LGUpe3ZhciBvPVtdLGk9ITAsbj0hMSxyPXZvaWQgMDt0cnl7Zm9yKHZhciBzLGE9dFtTeW1ib2wuaXRlcmF0b3JdKCk7IShpPShzPWEubmV4dCgpKS5kb25lKSYmKG8ucHVzaChzLnZhbHVlKSwhZXx8by5sZW5ndGghPT1lKTtpPSEwKTt9Y2F0Y2goZil7bj0hMCxyPWZ9ZmluYWxseXt0cnl7IWkmJmFbXCJyZXR1cm5cIl0mJmFbXCJyZXR1cm5cIl0oKX1maW5hbGx5e2lmKG4pdGhyb3cgcn19cmV0dXJuIG99cmV0dXJuIGZ1bmN0aW9uKGUsbyl7aWYoQXJyYXkuaXNBcnJheShlKSlyZXR1cm4gZTtpZihTeW1ib2wuaXRlcmF0b3IgaW4gT2JqZWN0KGUpKXJldHVybiB0KGUsbyk7dGhyb3cgbmV3IFR5cGVFcnJvcihcIkludmFsaWQgYXR0ZW1wdCB0byBkZXN0cnVjdHVyZSBub24taXRlcmFibGUgaW5zdGFuY2VcIil9fSgpLFA9Qy5VdGlscyxyPVAuZ2V0Qm91bmRzLGY9UC5leHRlbmQsYz1QLnVwZGF0ZUNsYXNzZXMsVD1QLmRlZmVyLFU9W1wibGVmdFwiLFwidG9wXCIsXCJyaWdodFwiLFwiYm90dG9tXCJdO0MubW9kdWxlcy5wdXNoKHtwb3NpdGlvbjpmdW5jdGlvbih0KXt2YXIgZT10aGlzLG89dC50b3AsaT10LmxlZnQsbj10LnRhcmdldEF0dGFjaG1lbnQ7aWYoIXRoaXMub3B0aW9ucy5jb25zdHJhaW50cylyZXR1cm4hMDt2YXIgcz10aGlzLmNhY2hlKFwiZWxlbWVudC1ib3VuZHNcIixmdW5jdGlvbigpe3JldHVybiByKGUuZWxlbWVudCl9KSxhPXMuaGVpZ2h0LGg9cy53aWR0aDtpZigwPT09aCYmMD09PWEmJlwidW5kZWZpbmVkXCIhPXR5cGVvZiB0aGlzLmxhc3RTaXplKXt2YXIgbD10aGlzLmxhc3RTaXplO2g9bC53aWR0aCxhPWwuaGVpZ2h0fXZhciBkPXRoaXMuY2FjaGUoXCJ0YXJnZXQtYm91bmRzXCIsZnVuY3Rpb24oKXtyZXR1cm4gZS5nZXRUYXJnZXRCb3VuZHMoKX0pLHU9ZC5oZWlnaHQscD1kLndpZHRoLGc9W3RoaXMuZ2V0Q2xhc3MoXCJwaW5uZWRcIiksdGhpcy5nZXRDbGFzcyhcIm91dC1vZi1ib3VuZHNcIildO3RoaXMub3B0aW9ucy5jb25zdHJhaW50cy5mb3JFYWNoKGZ1bmN0aW9uKHQpe3ZhciBlPXQub3V0T2ZCb3VuZHNDbGFzcyxvPXQucGlubmVkQ2xhc3M7ZSYmZy5wdXNoKGUpLG8mJmcucHVzaChvKX0pLGcuZm9yRWFjaChmdW5jdGlvbih0KXtbXCJsZWZ0XCIsXCJ0b3BcIixcInJpZ2h0XCIsXCJib3R0b21cIl0uZm9yRWFjaChmdW5jdGlvbihlKXtnLnB1c2godCtcIi1cIitlKX0pfSk7dmFyIG09W10sdj1mKHt9LG4pLHk9Zih7fSx0aGlzLmF0dGFjaG1lbnQpO3JldHVybiB0aGlzLm9wdGlvbnMuY29uc3RyYWludHMuZm9yRWFjaChmdW5jdGlvbih0KXt2YXIgcj10LnRvLHM9dC5hdHRhY2htZW50LGY9dC5waW47XCJ1bmRlZmluZWRcIj09dHlwZW9mIHMmJihzPVwiXCIpO3ZhciBsPXZvaWQgMCxkPXZvaWQgMDtpZihzLmluZGV4T2YoXCIgXCIpPj0wKXt2YXIgYz1zLnNwbGl0KFwiIFwiKSxnPU0oYywyKTtkPWdbMF0sbD1nWzFdfWVsc2UgbD1kPXM7dmFyIHc9YihlLHIpOyhcInRhcmdldFwiPT09ZHx8XCJib3RoXCI9PT1kKSYmKG88d1sxXSYmXCJ0b3BcIj09PXYudG9wJiYobys9dSx2LnRvcD1cImJvdHRvbVwiKSxvK2E+d1szXSYmXCJib3R0b21cIj09PXYudG9wJiYoby09dSx2LnRvcD1cInRvcFwiKSksXCJ0b2dldGhlclwiPT09ZCYmKG88d1sxXSYmXCJ0b3BcIj09PXYudG9wJiYoXCJib3R0b21cIj09PXkudG9wPyhvKz11LHYudG9wPVwiYm90dG9tXCIsbys9YSx5LnRvcD1cInRvcFwiKTpcInRvcFwiPT09eS50b3AmJihvKz11LHYudG9wPVwiYm90dG9tXCIsby09YSx5LnRvcD1cImJvdHRvbVwiKSksbythPndbM10mJlwiYm90dG9tXCI9PT12LnRvcCYmKFwidG9wXCI9PT15LnRvcD8oby09dSx2LnRvcD1cInRvcFwiLG8tPWEseS50b3A9XCJib3R0b21cIik6XCJib3R0b21cIj09PXkudG9wJiYoby09dSx2LnRvcD1cInRvcFwiLG8rPWEseS50b3A9XCJ0b3BcIikpLFwibWlkZGxlXCI9PT12LnRvcCYmKG8rYT53WzNdJiZcInRvcFwiPT09eS50b3A/KG8tPWEseS50b3A9XCJib3R0b21cIik6bzx3WzFdJiZcImJvdHRvbVwiPT09eS50b3AmJihvKz1hLHkudG9wPVwidG9wXCIpKSksKFwidGFyZ2V0XCI9PT1sfHxcImJvdGhcIj09PWwpJiYoaTx3WzBdJiZcImxlZnRcIj09PXYubGVmdCYmKGkrPXAsdi5sZWZ0PVwicmlnaHRcIiksaStoPndbMl0mJlwicmlnaHRcIj09PXYubGVmdCYmKGktPXAsdi5sZWZ0PVwibGVmdFwiKSksXCJ0b2dldGhlclwiPT09bCYmKGk8d1swXSYmXCJsZWZ0XCI9PT12LmxlZnQ/XCJyaWdodFwiPT09eS5sZWZ0PyhpKz1wLHYubGVmdD1cInJpZ2h0XCIsaSs9aCx5LmxlZnQ9XCJsZWZ0XCIpOlwibGVmdFwiPT09eS5sZWZ0JiYoaSs9cCx2LmxlZnQ9XCJyaWdodFwiLGktPWgseS5sZWZ0PVwicmlnaHRcIik6aStoPndbMl0mJlwicmlnaHRcIj09PXYubGVmdD9cImxlZnRcIj09PXkubGVmdD8oaS09cCx2LmxlZnQ9XCJsZWZ0XCIsaS09aCx5LmxlZnQ9XCJyaWdodFwiKTpcInJpZ2h0XCI9PT15LmxlZnQmJihpLT1wLHYubGVmdD1cImxlZnRcIixpKz1oLHkubGVmdD1cImxlZnRcIik6XCJjZW50ZXJcIj09PXYubGVmdCYmKGkraD53WzJdJiZcImxlZnRcIj09PXkubGVmdD8oaS09aCx5LmxlZnQ9XCJyaWdodFwiKTppPHdbMF0mJlwicmlnaHRcIj09PXkubGVmdCYmKGkrPWgseS5sZWZ0PVwibGVmdFwiKSkpLChcImVsZW1lbnRcIj09PWR8fFwiYm90aFwiPT09ZCkmJihvPHdbMV0mJlwiYm90dG9tXCI9PT15LnRvcCYmKG8rPWEseS50b3A9XCJ0b3BcIiksbythPndbM10mJlwidG9wXCI9PT15LnRvcCYmKG8tPWEseS50b3A9XCJib3R0b21cIikpLChcImVsZW1lbnRcIj09PWx8fFwiYm90aFwiPT09bCkmJihpPHdbMF0mJihcInJpZ2h0XCI9PT15LmxlZnQ/KGkrPWgseS5sZWZ0PVwibGVmdFwiKTpcImNlbnRlclwiPT09eS5sZWZ0JiYoaSs9aC8yLHkubGVmdD1cImxlZnRcIikpLGkraD53WzJdJiYoXCJsZWZ0XCI9PT15LmxlZnQ/KGktPWgseS5sZWZ0PVwicmlnaHRcIik6XCJjZW50ZXJcIj09PXkubGVmdCYmKGktPWgvMix5LmxlZnQ9XCJyaWdodFwiKSkpLFwic3RyaW5nXCI9PXR5cGVvZiBmP2Y9Zi5zcGxpdChcIixcIikubWFwKGZ1bmN0aW9uKHQpe3JldHVybiB0LnRyaW0oKX0pOmY9PT0hMCYmKGY9W1widG9wXCIsXCJsZWZ0XCIsXCJyaWdodFwiLFwiYm90dG9tXCJdKSxmPWZ8fFtdO3ZhciBDPVtdLE89W107bzx3WzFdJiYoZi5pbmRleE9mKFwidG9wXCIpPj0wPyhvPXdbMV0sQy5wdXNoKFwidG9wXCIpKTpPLnB1c2goXCJ0b3BcIikpLG8rYT53WzNdJiYoZi5pbmRleE9mKFwiYm90dG9tXCIpPj0wPyhvPXdbM10tYSxDLnB1c2goXCJib3R0b21cIikpOk8ucHVzaChcImJvdHRvbVwiKSksaTx3WzBdJiYoZi5pbmRleE9mKFwibGVmdFwiKT49MD8oaT13WzBdLEMucHVzaChcImxlZnRcIikpOk8ucHVzaChcImxlZnRcIikpLGkraD53WzJdJiYoZi5pbmRleE9mKFwicmlnaHRcIik+PTA/KGk9d1syXS1oLEMucHVzaChcInJpZ2h0XCIpKTpPLnB1c2goXCJyaWdodFwiKSksQy5sZW5ndGgmJiFmdW5jdGlvbigpe3ZhciB0PXZvaWQgMDt0PVwidW5kZWZpbmVkXCIhPXR5cGVvZiBlLm9wdGlvbnMucGlubmVkQ2xhc3M/ZS5vcHRpb25zLnBpbm5lZENsYXNzOmUuZ2V0Q2xhc3MoXCJwaW5uZWRcIiksbS5wdXNoKHQpLEMuZm9yRWFjaChmdW5jdGlvbihlKXttLnB1c2godCtcIi1cIitlKX0pfSgpLE8ubGVuZ3RoJiYhZnVuY3Rpb24oKXt2YXIgdD12b2lkIDA7dD1cInVuZGVmaW5lZFwiIT10eXBlb2YgZS5vcHRpb25zLm91dE9mQm91bmRzQ2xhc3M/ZS5vcHRpb25zLm91dE9mQm91bmRzQ2xhc3M6ZS5nZXRDbGFzcyhcIm91dC1vZi1ib3VuZHNcIiksbS5wdXNoKHQpLE8uZm9yRWFjaChmdW5jdGlvbihlKXttLnB1c2godCtcIi1cIitlKX0pfSgpLChDLmluZGV4T2YoXCJsZWZ0XCIpPj0wfHxDLmluZGV4T2YoXCJyaWdodFwiKT49MCkmJih5LmxlZnQ9di5sZWZ0PSExKSwoQy5pbmRleE9mKFwidG9wXCIpPj0wfHxDLmluZGV4T2YoXCJib3R0b21cIik+PTApJiYoeS50b3A9di50b3A9ITEpLCh2LnRvcCE9PW4udG9wfHx2LmxlZnQhPT1uLmxlZnR8fHkudG9wIT09ZS5hdHRhY2htZW50LnRvcHx8eS5sZWZ0IT09ZS5hdHRhY2htZW50LmxlZnQpJiZlLnVwZGF0ZUF0dGFjaENsYXNzZXMoeSx2KX0pLFQoZnVuY3Rpb24oKXtlLm9wdGlvbnMuYWRkVGFyZ2V0Q2xhc3NlcyE9PSExJiZjKGUudGFyZ2V0LG0sZyksYyhlLmVsZW1lbnQsbSxnKX0pLHt0b3A6byxsZWZ0Oml9fX0pO3ZhciBQPUMuVXRpbHMscj1QLmdldEJvdW5kcyxjPVAudXBkYXRlQ2xhc3NlcyxUPVAuZGVmZXI7Qy5tb2R1bGVzLnB1c2goe3Bvc2l0aW9uOmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMsbz10LnRvcCxpPXQubGVmdCxuPXRoaXMuY2FjaGUoXCJlbGVtZW50LWJvdW5kc1wiLGZ1bmN0aW9uKCl7cmV0dXJuIHIoZS5lbGVtZW50KX0pLHM9bi5oZWlnaHQsYT1uLndpZHRoLGY9dGhpcy5nZXRUYXJnZXRCb3VuZHMoKSxoPW8rcyxsPWkrYSxkPVtdO288PWYuYm90dG9tJiZoPj1mLnRvcCYmW1wibGVmdFwiLFwicmlnaHRcIl0uZm9yRWFjaChmdW5jdGlvbih0KXt2YXIgZT1mW3RdOyhlPT09aXx8ZT09PWwpJiZkLnB1c2godCl9KSxpPD1mLnJpZ2h0JiZsPj1mLmxlZnQmJltcInRvcFwiLFwiYm90dG9tXCJdLmZvckVhY2goZnVuY3Rpb24odCl7dmFyIGU9Zlt0XTsoZT09PW98fGU9PT1oKSYmZC5wdXNoKHQpfSk7dmFyIHU9W10scD1bXSxnPVtcImxlZnRcIixcInRvcFwiLFwicmlnaHRcIixcImJvdHRvbVwiXTtyZXR1cm4gdS5wdXNoKHRoaXMuZ2V0Q2xhc3MoXCJhYnV0dGVkXCIpKSxnLmZvckVhY2goZnVuY3Rpb24odCl7dS5wdXNoKGUuZ2V0Q2xhc3MoXCJhYnV0dGVkXCIpK1wiLVwiK3QpfSksZC5sZW5ndGgmJnAucHVzaCh0aGlzLmdldENsYXNzKFwiYWJ1dHRlZFwiKSksZC5mb3JFYWNoKGZ1bmN0aW9uKHQpe3AucHVzaChlLmdldENsYXNzKFwiYWJ1dHRlZFwiKStcIi1cIit0KX0pLFQoZnVuY3Rpb24oKXtlLm9wdGlvbnMuYWRkVGFyZ2V0Q2xhc3NlcyE9PSExJiZjKGUudGFyZ2V0LHAsdSksYyhlLmVsZW1lbnQscCx1KX0pLCEwfX0pO3ZhciBNPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCh0LGUpe3ZhciBvPVtdLGk9ITAsbj0hMSxyPXZvaWQgMDt0cnl7Zm9yKHZhciBzLGE9dFtTeW1ib2wuaXRlcmF0b3JdKCk7IShpPShzPWEubmV4dCgpKS5kb25lKSYmKG8ucHVzaChzLnZhbHVlKSwhZXx8by5sZW5ndGghPT1lKTtpPSEwKTt9Y2F0Y2goZil7bj0hMCxyPWZ9ZmluYWxseXt0cnl7IWkmJmFbXCJyZXR1cm5cIl0mJmFbXCJyZXR1cm5cIl0oKX1maW5hbGx5e2lmKG4pdGhyb3cgcn19cmV0dXJuIG99cmV0dXJuIGZ1bmN0aW9uKGUsbyl7aWYoQXJyYXkuaXNBcnJheShlKSlyZXR1cm4gZTtpZihTeW1ib2wuaXRlcmF0b3IgaW4gT2JqZWN0KGUpKXJldHVybiB0KGUsbyk7dGhyb3cgbmV3IFR5cGVFcnJvcihcIkludmFsaWQgYXR0ZW1wdCB0byBkZXN0cnVjdHVyZSBub24taXRlcmFibGUgaW5zdGFuY2VcIil9fSgpO3JldHVybiBDLm1vZHVsZXMucHVzaCh7cG9zaXRpb246ZnVuY3Rpb24odCl7dmFyIGU9dC50b3Asbz10LmxlZnQ7aWYodGhpcy5vcHRpb25zLnNoaWZ0KXt2YXIgaT10aGlzLm9wdGlvbnMuc2hpZnQ7XCJmdW5jdGlvblwiPT10eXBlb2YgdGhpcy5vcHRpb25zLnNoaWZ0JiYoaT10aGlzLm9wdGlvbnMuc2hpZnQuY2FsbCh0aGlzLHt0b3A6ZSxsZWZ0Om99KSk7dmFyIG49dm9pZCAwLHI9dm9pZCAwO2lmKFwic3RyaW5nXCI9PXR5cGVvZiBpKXtpPWkuc3BsaXQoXCIgXCIpLGlbMV09aVsxXXx8aVswXTt2YXIgcz1pLGE9TShzLDIpO249YVswXSxyPWFbMV0sbj1wYXJzZUZsb2F0KG4sMTApLHI9cGFyc2VGbG9hdChyLDEwKX1lbHNlIG49aS50b3Ascj1pLmxlZnQ7cmV0dXJuIGUrPW4sbys9cix7dG9wOmUsbGVmdDpvfX19fSksUn0pOyJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
