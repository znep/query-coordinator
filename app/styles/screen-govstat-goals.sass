@mixin lower-label
  bottom: -1.3em
  display: block
  font-size: 1.2em
  font-weight: normal
  height: 1em
  letter-spacing: 0.2em
  @include opacity(0.6)
  position: absolute
  text-align: center
  text-transform: uppercase
  width: 100%

.addCategory
  position: absolute
  right: 1em
  top: 9.6em

.gridFlowLayout
  .categoryItem
    @include clearfix

    .categoryTitle
      h2
        display: inline

      .removeCategory
        display: none
        float: right
        padding: 0.6em
        text-rendering: optimizeLegibility

      .editIcon
        bottom: 0.3em
        left: 0.6em
        margin-right: 4em
        @include opacity(0.9)
        position: relative
        text-rendering: optimizeLegibility
        visibility: hidden

      input.categoryTitleEdit
        background: none
        border: none
          bottom: 2px dotted #666
        color: #666
        display: none
        font-family: 'myriad-pro'
        font-size: 1.5em
        height: 1em
        line-height: 1em
        margin: 0.22em 0
          bottom: 0.02em
        outline: none
        padding: 0
          right: 0.05em
          bottom: 0.2em
        text-rendering: optimizeLegibility
        width: 20em

      + *
        display: block


    &:hover
      .removeCategory
        display: inline-block
      .editIcon
        visibility: visible

    .goalList
      min-height: 20em
      &.dropTarget
        background-color: #eee

      .singleItem
        &.internal
          @include opacity(0.7)
        &.ui-draggable-dragging
          margin: 1em

.goalEditor.socrataDialog
  background-image: url(/stylesheets/images/content/noise.png)
  min-width: 90em
  padding: 0

  .headerBar
    @include vertical-gradient(rgba(0, 0, 0, 0.25), rgba(0, 0, 0, 0.1))
    border-bottom: 1px solid rgba(0, 0, 0, 0.3)
    @include clearfix
    margin: 0
    padding: 1em
    &.sticky
      position: fixed
      top: 0
      z-index: 10000
    .status
      float: left
      margin:
        left: 1em
        top: 1em
      span
        @include border-radius(0.3em)
        color: #ffffff
        display: none
        font-size: 1.5em
        padding: 0.5em 1em
      &.status-computed .computed
        background-color: #09a74f
        display: inline-block
      &.status-computing .computing
        background-color: #fcc806
        display: inline-block
      &.status-draft .draft
        background-color: #999999
        display: inline-block

    .actions
      float: right

      a
        display: inline-block
        font-size: 1.3em
        padding: 1em

  form
    line-height: 6em
    padding: 4em
      top: 2em

    > *
      margin-right: 5px

    .inputWrapper
      border-bottom: 2px dotted #333
      display: inline-block
      line-height: 1em
      position: relative

      label
        @include lower-label

      input, select
        background: none
        border: none
        box-sizing: border-box
        font-family: myriad-pro
        font-size: 2.8em
        line-height: 1em
        outline: none
        text-align: center
        width: 100%

      select
        height: 100%
        left: 0
        @include opacity(0)
        position: absolute
        top: 0
        width: 100%
        z-index: 9999

      .selectValue
        background: url(/stylesheets/images/content/dropdown_arrow.png) no-repeat right 0
        display: block
        height: 1.05em
        @include opacity(1)
        text-align: center
        width: 100%

    span
      font-size: 2.8em
      @include opacity(0.9)

  .metricsBlock
    padding: 0

  form + form, .metricsBlock + form
    @include vertical-gradient(rgba(0, 0, 0, 0.1), rgba(0, 0, 0, 0.02))
    border-top: 1px solid rgba(0, 0, 0, 0.2)
    line-height: 4.5em

  form.mainDetails
    .comparisonInput
      text-transform: lowercase
      width: 21em
    .nameInput
      width: 50em
    .amountInput
      width: 20em

    .startDateInput, .endDateInput
      width: 25em

    .amountIsPercentInput
      border: none

      input
        bottom: 0.15em
        float: left
        position: relative
        width: auto

      label
        display: inline
        font-size: 2em
        @include opacity(0.2)
        position: static
        @include transition(0.3s, opacity)

      input:checked + label
        @include opacity(0.85)

    .customTitle
      padding-top: 6em

      .customTitleInput
        width: 100%

        input
          font-size: 1.8em

          &.prompt
            @include opacity(0.5)

  form.additionalDetails
    h2
      line-height: 1em
      padding-bottom: 0.5em

    span
      font-size: 1.7em

    .inputWrapper
      input, select
        font-size: 1.7em

      label
        bottom: -1.4em

    .agencyInput
      display: inline

      .agencyList
        display: inline

        li
          display: inline

          // and now, a bunch of grammar
          .andText
            display: none

          &:first-child, &:last-child
            .commaText
              display: none

          // oxford commas are important!
          &:first-child + li ~ li:last-child
            .commaText
              display: inline

          &.newAgency
            .andText
              display: inline
            &:first-child .andText
              display: none

          .inputWrapper
            width: 30em

            input
              padding-right: 0.8em

          .removeAgency
            color: #333
            margin-left: -1.2em
            margin-right: 1.2em
            position: relative
            text-decoration: none
            text-rendering: optimizeLegibility
            @include transition(0.3s, color)
            z-index: 1

            &:active, &:hover, &:focus
              color: #888

    .publicInput
      text-transform: lowercase
      width: 15em

    .imageLine .inputWrapper
      width: 60em

    .iconPickerHandle
      border-bottom: 2px dotted #333
      color: #333
      display: inline-block
      font-size: 1.8em
      line-height: 1.2em
      padding: 0 1em

    .imageInput
      border: 2px dotted #333
      line-height: 1
      margin-top: 2em
      max-height: 50em
      min-height: 15em
      overflow: hidden
      padding: 0.5em
      position: relative

      img
        background-color: rgba(0, 0, 0, 0.1)
        border: none
        color: transparent
        min-height: 20em
        width: 100%

      .selectImageButton
        bottom: 1.5em
        left: 1.5em
        position: absolute

    .noteLine > span
      line-height: 1em

    .notesWrapper
      background: url(/stylesheets/images/content/dotted_line_dark.png)
      cursor: text
      position: relative

      .notes
        display: inline-block
        font-size: 1.7em
        line-height: 2.65em
        min-height: 5.5em
        vertical-align: middle
        width: 100%

        *
          font-size: 1em !important

        p
          line-height: 2.65em

        ul
          list-style-type: circle
          margin-left: 2em
        ol
          list-style-type: decimal
          margin-left: 2em

      .notesLabel
        @include lower-label
        bottom: -0.4em
        line-height: 1

  form.relatedDatasets
    .addDataset
      font-size: 1.4em

  .datasetCardList
    margin-top: 2em

  .datasetCard
    background: rgba(0, 0, 0, 0.1)
    @include prefixer(border-radius, 0.2em)
    @include prefixer(box-shadow, 0 0 1em rgba(0, 0, 0, 0.2) inset)
    margin-bottom: 1em
    padding: 2em
      left: 4em
    position: relative

    .datasetIcon
      @include sprite-type-icons-30
      float: left
      margin-right: 2em

    h2
      font-size: 2em
      font-weight: normal
      line-height: 1.5em

    .dragHandle
      background: transparent url(/stylesheets/images/interface/drag_handle.png)
      bottom: 1.5em
      cursor: move
      left: 2em
      position: absolute
      top: 1.5em
      width: 6px

    .removeDataset
      color: #333
      font-size: 1.3em
      margin-top: -1.5em
      position: absolute
      right: 1em
      text-rendering: optimizeLegibility
      top: 50%
      @include transition(0.3s, color)

      &:hover, &:focus, &:active
        color: #666

  .metric
    border-top: rgba(0, 0, 0, 0.15)
    line-height: 4.5em
    padding-bottom: 0
    position: relative

    background-color: rgba(0, 0, 0, 0.15)
    + .metric
      background: none
      + .metric
        background-color: rgba(0, 0, 0, 0.15)
        + .metric
          background: none
          + .metric
            background-color: rgba(0, 0, 0, 0.15)
            + .metric
              background: none
              + .metric
                background-color: rgba(0, 0, 0, 0.15)
                + .metric
                  background: none
                  + .metric
                    background-color: rgba(0, 0, 0, 0.15)
                    + .metric
                      background: none
                      + .metric
                        background-color: rgba(0, 0, 0, 0.15)
                        + .metric
                          background: none

    .removeMetric
      color: #333
      float: right
      font-size: 1.3em
      position: absolute
      right: 1em
      text-rendering: optimizeLegibility
      top: 1em
      @include transition(0.3s, color)

      &:hover
        color: #666

    .prevailing
      background-color: #ffdc5c
      @include prefixer(box-shadow, 0.3em 0 0.3em rgba(0, 0, 0, 0.2))
      color: #635213
      display: none
      font-size: 1.3em
      font-weight: bold
      line-height: 3em
      padding: 0 1.5em
      position: absolute
      right: 1em
      top: 2.38em
      @include prefixer(transform, rotate(90deg))

    > h2
      line-height: 1em
      padding-bottom: 1.5em

    span
      font-size: 1.7em

    .inputWrapper
      input, select
        font-size: 1.7em

    .detailsLine
      span, .inputWrapper input, .inputWrapper select
        font-size: 2.3em

    .nameInput
      width: 40em

    .indicatorContainer
      @include clearfix
      margin: 0
      padding: 1em 0
      position: relative

      .left
        float: left
        width: 50%

        > div
          padding: 2em 4em 4em 0

      .right
        overflow: hidden
        text-align: right

        > div
          padding: 2em 0 0 4em

        .calculationSection
          padding:
            left: 4em
            right: 0

      .comparison
        left: 50%
        line-height: 3.5em
        margin-left: -6em
        margin-top: -3em
        position: absolute
        text-align: center
        top: 60%
        width: 12em

        label
          left: -9999px

        p
          font-size: 1.3em

        .comparisonInput
          width: 12em

    .calculationSection
      padding-right: 9em

      .aggregationFunctionInput
        margin:
          bottom: 3.5em
          left: 0.5em
          right: 1.5em
        width: 20em

      .columnContainer
        display: inline-block

      .columnCard
        .inputWrapper
          width: 42em

        span.selectValue
          @include transition(0.2s, color)

          &.needsDataset
            color: #666

      .columnFunctionInput
        margin-top: 3.5em
        width: 15em

      .column2Wrapper
        margin-top: 3.5em
        @include opacity(0.2)
        @include transition(0.3s, opacity)

        select
          height: 0

      .columnFunctionInput.hasFunction + .column2Wrapper
        @include opacity(1)

        select
          height: 100%

    .date_column
      display: inline-block
      margin-bottom: 4em
      .columnCard .inputWrapper
        width: 28.5em

    .baselineDates
      margin-top: 2em
      padding-bottom: 1em
      .inputWrapper
        width: 26em

    // prevailing metric
    &:first-child
      .removeMetric
        display: none

      .prevailing
        display: block

      .indicatorContainer .comparison
        select
          display: none
        .selectValue
          background: none

  .indicator
    background: rgba(0, 0, 0, 0.03)
    border: 1px solid rgba(0, 0, 0, 0.06)
      left: none
      right: none
    margin: 3em -4em 0
    padding: 0 4em

    .datasetSection
      > h2
        line-height: 1em
        padding-bottom: 1.5em

      .datasetCard
        padding: 1em

        .datasetIcon
          margin-right: 1em

        h2
          font-size: 1.3em
          line-height: 1
          padding: 0.7em 0

          &.prompt
            padding: 0.3em

      .selectDataset
        font-size: 1.3em

    .calculationContainer
      background: rgba(0, 0, 0, 0.04)
      border: 1px solid rgba(0, 0, 0, 0.2)
        left: none
        right: none
      margin: 0 -4em
      padding: 2em 4em 1em

  .addMetric
    display: inline-block
    font-size: 1.5em
    margin: 2em

  &.draft
    background-color: #333
    color: #fff

    .headerBar
      @include vertical-gradient(rgba(255, 255, 255, 0.25), rgba(255, 255, 255, 0.1))
      border-bottom: 1px solid rgba(255, 255, 255, 0.3)

    form
      .inputWrapper
        border-color: #fff

        input, select
          color: #fff

        option
          background-color: #fff
          color: #000

    form + form, .metricsBlock + form
      @include vertical-gradient(rgba(0, 0, 0, 0.25), rgba(0, 0, 0, 0.1))
      border-top-color: rgba(0, 0, 0, 0.3)

      h2
        text-shadow: 0 1px 0.2em rgba(0, 0, 0, 0.4)

    form.additionalDetails
      .agencyInput .agencyList li .removeAgency
        color: #fff

        &:active, &:hover, &:focus
          color: #bbb

      .iconPickerHandle
        border-color: #fff
        color: #fff

      .imageInput
        border-color: #fff

      .notesWrapper
        background: url(/stylesheets/images/content/dotted_line.png)

    .datasetCard .removeDataset
      color: #fff
      &:hover, &:focus, &:active
        color: #bbb

    .metric
      border-top-color: rgba(0, 0, 0, 0.3)

      background-color: rgba(0, 0, 0, 0.25)
      + .metric
        background-color: rgba(255, 255, 255, 0.15)
        + .metric
          background-color: rgba(0, 0, 0, 0.1)
          + .metric
            background-color: rgba(255, 255, 255, 0.15)
            + .metric
              background-color: rgba(0, 0, 0, 0.1)
              + .metric
                background-color: rgba(255, 255, 255, 0.15)
                + .metric
                  background-color: rgba(0, 0, 0, 0.1)
                  + .metric
                    background-color: rgba(255, 255, 255, 0.15)
                    + .metric
                      background-color: rgba(0, 0, 0, 0.1)
                      + .metric
                        background-color: rgba(255, 255, 255, 0.15)
                        + .metric
                          background-color: rgba(0, 0, 0, 0.1)
                          + .metric
                            background-color: rgba(255, 255, 255, 0.15)

      .removeMetric
        color: #fff
        &:hover, &:focus, &:active
          color: #bbb

      .prevailing
        @include prefixer(box-shadow-color, rgba(0, 0, 0, 1))

    .indicatorContainer
      .calculationContainer .columnCard span.selectValue.needsDataset
        color: #bbb

    .indicator
      .calculationContainer
        background-color: rgba(0, 0, 0, 0.2)
        border-color: rgba(0, 0, 0, 0.4)


.socrataModal #selectDataset
  padding: 3em

  .jqmClose
    color: #333
    font-family: SSPika
    font-size: 1.2em
    position: absolute
    right: 2.5em
    text-rendering: optimizeLegibility
    top: 2.5em
    @include transition(0.3s, color)

    &:hover, &:focus, &:active
      color: #666

  h2
    font-size: 2.5em

  p
    font-size: 1.4em
    padding: 0.5em 0

  iframe
    box-sizing: border-box
    height: 50em
    margin-top: 2em
    width: 100%
