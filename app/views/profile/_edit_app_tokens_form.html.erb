<%= form_tag({:action => 'edit_app_token',
             :token_id => ((@token.nil? || @token.id.nil?) ? 'new' : @token.id)},
             {:multipart => true, :class => 'commonForm createNewTokenForm'}) %>
  <div class="editSection noBorder">
    <div class="line clearfix">
      <label for="app_token_name" class="required">Application Name</label>
      <%= text_field_tag("app_token[name]", @token.name, :class => 'textPrompt required',
            :title => 'Enter a name for your application') %>
    </div>
    <div class="line clearfix">
      <label for="app_token_description" class="required">Description</label>
      <%= text_area_tag("app_token[description]", @token.description, :class => 'textPrompt required',
            :title => 'Enter a description for your application') %>
    </div>
    <div class="line clearfix">
      <label for="app_token_organization">Organization</label>
      <%= text_field_tag("app_token[organization]", @token.organization, :class => 'textPrompt',
            :title => 'Enter the organization responsible for this application') %>
    </div>
    <div class="line clearfix">
      <label for="app_token_website">Website</label>
      <%= text_field_tag("app_token[website]", @token.website, :class => 'textPrompt url',
            :title => "Provide a link to this application or organization's website") %>
    </div>
    <div class="line clearfix">
      <label for="app_token_baseUri">Callback Prefix</label>
      <%= text_field_tag("app_token[baseUri]", @token.baseUri, :class => 'textPrompt url',
            :title => 'Provide the prefix to the secure (https) callback uri when using OAuth') %>
      <p>For instance, if your application will call back to
         <span class="code">https://my-domain.com/socrata-app/oauth/validated</span> and
         <span class="code">https://my-domain.com/socrata-app/profile</span>, you'll want to supply
         <span class="code">https://my-domain.com/socrata-app</span> as your prefix. Note
         that you must include at least the entire domain name.</p>
    </div>
    <div class="line clearfix">
      <label for="app_token_public">Public?</label>
      <%= check_box_tag 'app_token[public]', 'on', @token.public %>
    </div>
    <%- unless @token.id.nil? -%>
      <div class="line clearfix">
        <label>Thumbnail</label>
        <%- if @token.has_thumbnail? -%>
          <div class="thumbnail thumbnailArea">
            <img src="<%= @token.thumbnail_url %>" alt="thumbnail" />
          </div>
          <span class="flash error thumbnailError">Please choose an image file (jpg, gif, png or tiff)</span>
        <%- else -%>
          <div class="noThumbnail thumbnailArea">
            <img alt="thumbnail" />
            <span class="noThumbnailText">
              <em>No Thumbnail</em>
            </span>
          </div>
        <%- end -%>
      </div>
      <div class="line clearfix">
        <label>&nbsp;</label>
        <%= file_field_tag('new_image', {:accept => 'image/png,image/gif,image/jpeg',
                           'data-endpoint' => @token.set_thumbnail_url(current_user.id),
                           :class => 'uploadAppTokenImage'}) %>
        <span class="uploadIndicator"></span>
      </div>
    <%- end -%>
  </div>
  <div class="submitLine">
    <%= submit_tag (@token && @token.id ? 'Save' : 'Create'), :class => 'button default' %>
    <%= link_to('Cancel', {:action => 'edit_app_tokens'}, {:class => 'cancelButton button'}) %>
  </div>
</form>
