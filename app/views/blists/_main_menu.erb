<ul id='mainMenu' class='menu multilevelMenu'>
  <li class='first blist active'>
    <dl><dt><a href='#menublist'>blist</a></dt>
      <dd><%= menu_tag({'bare_menu' => true, 'items' => [
        {'text' => 'Print this blist...', 'class' => 'print',
        'href' => '#print', 'swf_item' => true},
        {'text' => 'Export this blist', 'class' => 'export',
        'href' => '#', 'submenu' => {'class' => 'noicon', 'items' => [
        {'text' => 'As CSV', 'href' => "/views/#{@view.id}/rows.csv"},
        {'text' => 'As PDF', 'href' => '#print', 'swf_item' => true}]}},
        {'text' => 'Email this blist...', 'class' => 'email',
        'href' => '#email', 'swf_item' => true},
        {'text' => 'Copy this blist', 'class' => 'copy', 'href' => '#copy_blist',
        'swf_item' => true},
        {'separator' => true, 'swf_item' => true},
        {'text' => 'Create New blist...', 'class' => 'create',
        'href' => '#new_blist', 'swf_item' => true },
        # Submenu for Create blist when we support different types
#        , 'submenu' => {'items' => [
#        {'text' => 'Start As a Table', 'class' => 'table',
#        'href' => '#'},
#        {'text' => 'Start As a Page', 'class' => 'page',
#        'href' => '#'},
#        {'text' => 'Start New Calendar', 'class' => 'calendar',
#        'href' => '#'},
#        {'text' => 'Start New Form', 'class' => 'form',
#        'href' => '#'}]}
        {'text' => 'Upload...', 'class' => 'import', 'href' => '/import',
        'swf_item' => false},
        {'text' => 'Find a Template', 'class' => 'findTemplate',
        'href' => discover_url},
        {'separator' => true},
        {'text' => 'Open Recent', 'class' => 'recent', 'href' => '#',
        'submenu' => recent_blists_menu(@view, 5)},
        {'separator' => true, 'owner_item' => true, 'swf_item' => true},
        {'text' => 'Edit blist permissions...',
        'class' => 'editPermissions', 'href' => '#permissions',
        'owner_item' => true, 'swf_item' => true}
        ]}, is_owner, can_edit) %>
    </dd></dl>
  </li>
  <%- if can_edit -%>
  <li class='edit swfItem'>
    <dl><dt><a href='#menuEdit'>Edit</a></dt>
      <dd><%= menu_tag({'bare_menu' => true, 'items' => [
        {'text' => 'Undo', 'class' => 'undo', 'href' => '#Undo'},
        {'text' => 'Redo', 'class' => 'redo', 'href' => '#Redo'},
        {'separator' => true},
        {'text' => 'Cut', 'class' => 'cut', 'href' => '#Cut'},
        {'text' => 'Copy', 'class' => 'copy', 'href' => '#Copy'},
        {'text' => 'Paste', 'class' => 'paste', 'href' => '#Paste'},
        {'separator' => true},
        {'text' => 'Delete', 'class' => 'delete', 'href' => '#Delete'},
        {'separator' => true},
        {'text' => 'Edit Column Options', 'class' => 'columnOptions',
        'href' => '#', 'submenu' => columns_menu(@view,
                 {'id' => 'columnOptionsMenu',
                  'href_prefix' => "#edit_column:",
                  'include_options' =>
                   {'blist_in_blist' => true,
                    'bnb_children' => true, 'list' => true},
                    'initial_items' => [
                      {'section_title' => 'Select a Column'},
                      {'separator' => true}]})}
        # There are no row options
#        {'text' => 'Edit Row Options', 'class' => 'rowOptions',
#        'href' => '#'}
        ]}, is_owner, can_edit) %>
    </dd></dl>
  </li>
  <%- end -%>
  <%- if can_edit -%>
  <li class='data swfItem'>
    <dl><dt><a href='#menuData'>Data</a></dt>
      <dd><%= menu_tag({'bare_menu' => true, 'items' => [
        {'text' => 'Insert a Column', 'class' => 'insertColumn',
        'href' => '#', 'owner_item' => true,
        'submenu' => {'class' => 'noicon', 'items' => [
        {'text' => 'At the Far Right', 'href' => '#addColumn_last'},
        {'text' => 'At the Far Left', 'href' => '#addColumn_first'}]}},
        # Not supported yet
#        {'text' => 'Insert a Row', 'class' => 'insertRow',
#        'href' => '#', 'submenu' => {'class' => 'noicon', 'items' => [
#        {'text' => 'At the Top', 'href' => '#'},
#        {'text' => 'At the Bottom', 'href' => '#'}]}},
        {'separator' => true, 'owner_item' => true},
        {'text' => 'Manage Pick Lists...', 'class' => 'picklists',
        'href' => '#picklistBrowser'},
        {'separator' => true},
        {'text' => 'Show Row Tags', 'class' => 'rowTags',
        'href' => '#addColumn_rowTag'},
        # Not supported
#        {'text' => 'Show Row IDs', 'class' => 'rowIDs', 'href' => '#'},
        {'separator' => true},
        {'text' => 'Column Totals', 'class' => 'columnTotals',
        'href' => '#', 'submenu' => columns_menu(@view,
                 {'id' => 'columnTotalsMenu',
                  'href_prefix' => "#column_totals:",
                  'include_options' =>
                   {'bnb_children' => true, 'list' => true},
                    'initial_items' => [
                      # Not supported yet
                      #{'text' => 'Show Totals Bar',
                      #'class' => 'showTotals', 'href' => '#'},
                      #{'separator' => true},
                      {'section_title' => 'Add totals to:'}],
                  'submenu' => method(:column_aggregate_menu),
                  'column_test' => proc {|c|
                  c.dataType.possible_aggregates.length > 1}})}
        ]}, is_owner, can_edit) %>
    </dd></dl>
  </li>
  <%- end -%>
  <li class='info'>
    <dl><dt><a href='#menuInfo'>Info</a></dt>
      <dd><%= menu_tag({'bare_menu' => true, 'items' => [
        {'section_title' => 'Tabs'},
        {'text' => 'Summary', 'class' => 'summary activePane',
        'href' => '#infoPane_tabSummary'},
        {'text' => 'Show Filtered Views', 'class' => 'views',
        'href' => '#infoPane_tabFiltered'},
        {'text' => 'Show Comments', 'class' => 'comments',
        'href' => '#infoPane_tabComments'},
        {'text' => 'Show Shares', 'class' => 'shares',
        'href' => '#infoPane_tabSharing'},
        {'text' => 'Show Publishing', 'class' => 'publishing',
        'href' => '#infoPane_tabPublishing'}
#        {'text' => 'Show Activity', 'class' => 'activity',
#        'href' => '#infoPane_tabActivity'}
        ]}, is_owner, can_edit) %>
    </dd></dl>
  </li>
  <%- if can_edit -%>
  <li class='publish swfItem'>
    <dl><dt><a href='#menuPublish'>Publish</a></dt>
      <dd><%= menu_tag({'bare_menu' => true, 'items' => [
        {'section_title' => 'Embed blists on the Web'},
        {'text' => 'Grid Only', 'class' => 'grid', 'href' => '#publish_grid'},
        # Not supported
#        {'text' => 'Grid + Page', 'class' => 'gridPage', 'href' => '#'},
#        {'text' => 'Page Only', 'class' => 'page', 'href' => '#'},
        {'separator' => true},
        {'text' => 'As a Form', 'class' => 'form', 'href' => '#publish_form'}
        # Not supported
#        {'text' => 'As a Search Widget', 'class' => 'search',
#        'href' => '#'}
        ]}, is_owner, can_edit) %>
    </dd></dl>
  </li>
  <%- end -%>
  <li class='footer'><div class='outerWrapper'>
    <div class='innerWrapper'><span class='colorWrapper'></span>
  </div></div></li>
</ul>
