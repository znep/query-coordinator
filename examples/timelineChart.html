<!DOCTYPE html>
<html>
  <head>
    <title>Example Usage: TimelineChart.js</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF8">
    <link rel="stylesheet" media="all" href="../src/views/styles/timelineChart.css">
    <link rel="stylesheet" media="all" href="../src/views/styles/flyoutRenderer.css">
    <style type="text/css">

      body {
        font-size: 10px;
        font-family: sans-serif;
      }

      #timeline-chart-1 {
        display: block;
        position: relative;
        width: 640px;
        height: 480px;
        margin: 100px auto 0 auto;
        border: 1px solid #aaa;
      }

      #timeline-chart-2 {
        display: block;
        position: relative;
        width: 640px;
        height: 480px;
        margin: 100px auto 0 auto;
        border: 1px solid #aaa;
      }

      #timeline-chart-3 {
        display: block;
        position: relative;
        width: 640px;
        height: 480px;
        margin: 100px auto 0 auto;
        border: 1px solid #aaa;
      }

      #timeline-chart-4 {
        display: block;
        position: relative;
        width: 640px;
        height: 480px;
        margin: 100px auto 0 auto;
        border: 1px solid #aaa;
      }

    </style>
  </head>
  <body>
    <div id="timeline-chart-1"></div>
    <div id="timeline-chart-2"></div>
    <div id="timeline-chart-3"></div>
    <div id="timeline-chart-4"></div>
  </body>
  <!-- lodash must be loaded before `socrata.utils.js` -->
  <script type="text/javascript" src="../bower_components/lodash/lodash.js"></script>
  <script type="text/javascript" src="../bower_components/moment/moment.js"></script>
  <script type="text/javascript" src="../bower_components/socrata-utils/socrata.utils.js"></script>
  <script type="text/javascript" src="../bower_components/jquery/dist/jquery.js"></script>
  <script type="text/javascript" src="../bower_components/d3/d3.js"></script>
  <script type="text/javascript" src="../bower_components/chroma-js/chroma.min.js"></script>
  <script type="text/javascript" src="../bower_components/simple-statistics/src/simple_statistics.js"></script>
  <script type="text/javascript" src="../dist/frontend-visualizations-jquery-plugins.js"></script>
  <script type="text/javascript">

    var flyoutRenderer = new socrata.visualizations.views.FlyoutRenderer();

    var COLUMN_NAME = 'date';
    var DATASET_UID = '52my-2pak';
    var DOMAIN = 'dataspace.demo.socrata.com';

    var timelineChart1VIF = {
      'aggregation': {
        'columnName': null,
        'function': 'count'
      },
      'columnName': COLUMN_NAME,
      'configuration': {
        // The localization values should be set by the application but are set to string literals
        // for the purposes of this example.
        'localization': {
          'NO_VALUE': 'No value',
          'FLYOUT_UNFILTERED_AMOUNT_LABEL': 'Total',
          'FLYOUT_FILTERED_AMOUNT_LABEL': 'Filtered',
          'FLYOUT_SELECTED_NOTICE': 'This column is selected'
        },
        'precision': 'MONTH'
      },
      'createdAt': '2014-01-01T00:00:00',
      'datasetUid': DATASET_UID,
      'domain': DOMAIN,
      'filters': [],
      'format': {
        'type': 'visualization_interchange_format',
        'version': 1
      },
      'origin': {
        'type': 'test_data',
        'url': 'localhost'
      },
      'title': COLUMN_NAME,
      'type': 'timelineChart',
      'unit': {
        'one': 'case',
        'other': 'cases'
      }
    };

    var $timelineChart1Element = $('#timeline-chart-1');
    $timelineChart1Element.socrataTimelineChart(timelineChart1VIF);

    var timelineChart2VIF = _.cloneDeep(timelineChart1VIF);
    timelineChart2VIF.datasetUid = 'r6t9-rak2';
    timelineChart2VIF.columnName = 'updated';
    delete timelineChart2VIF.configuration.precision;

    var $timelineChart2Element = $('#timeline-chart-2');
    $timelineChart2Element.socrataTimelineChart(timelineChart2VIF);

    var timelineChart3VIF = _.cloneDeep(timelineChart1VIF);
    timelineChart3VIF.domain = 'vertex-stories.rc-socrata.com';
    timelineChart3VIF.datasetUid = '7s6i-wbnq';
    timelineChart3VIF.columnName = 'date';
    delete timelineChart3VIF.configuration.precision;

    var $timelineChart3Element = $('#timeline-chart-3');
    $timelineChart3Element.socrataTimelineChart(timelineChart3VIF);

    var timelineChart4VIF = _.cloneDeep(timelineChart1VIF);
    timelineChart4VIF.configuration.interactive = false;

    var $timelineChart4Element = $('#timeline-chart-4');
    $timelineChart4Element.socrataTimelineChart(timelineChart4VIF);

    /**
     * Handle flyout events.
     */

    $timelineChart1Element.on('SOCRATA_VISUALIZATION_TIMELINE_CHART_FLYOUT', handleFlyout);
    $timelineChart2Element.on('SOCRATA_VISUALIZATION_TIMELINE_CHART_FLYOUT', handleFlyout);
    $timelineChart3Element.on('SOCRATA_VISUALIZATION_TIMELINE_CHART_FLYOUT', handleFlyout);

    function handleFlyout(event) {

      var payload = event.originalEvent.detail;

      // Render/hide a flyout
      if (payload !== null) {

        flyoutRenderer.render(payload);

      } else {

        flyoutRenderer.clear();
      }
    }

    // $timelineChart1Element.trigger('destroy');
    // $timelineChart2Element.trigger('destroy');

  </script>
</html>
