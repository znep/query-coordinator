<!DOCTYPE html>
<html>
  <head>
    <title>Example Usage: RowInspector.js</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF8">
    <link rel="stylesheet" media="all" href="../dist/socrata-visualizations.css">
    <style>
    html, body {
      box-sizing: border-box;
      width: 100%;
      height: 200%;
      margin: 0;
      font-size: 0.75em;
    }

    body {
      border-right: solid 25px black;
    }

    body > div, label {
      font-size: 2rem;
    }

    #click-me {
      position: absolute;
      top: 50%;
      left: 0;
      right: 25px;
      font-size: 10em;
      text-align: center;
      background-color: rebeccapurple;
      min-height: 250px;
      color: white;
    }
    </style>
  </head>
  <body>
    <div>
      <label for="row-count">Row Count</label>
      <input type="number" min="1" step="1" id="row-count" placeholder="Row Count" value="9">
    </div>
    <div>
      <input type="checkbox" id="error">
      <label for="error">If checked, will cause an error state on click.</label>
    </div>
    <div id="click-me">CLICK ANYWHERE HERE!</div>
  </body>

  <!-- Include external vendor -->
  <script type="text/javascript" src="./vendor.js"></script>

  <!-- Include bundle -->
  <script type="text/javascript" src="../dist/socrata-visualizations.js"></script>

  <script type="text/javascript">
    var validData = function(rowCount) {
      return _.map(_.range(1, parseInt(rowCount) + 1), function(rowIndex) {
        return _.map(_.range(1, Math.random() * 25 + 1), function(columnIndex) {
          return {
            column: 'row {0} col {1}'.format(rowIndex, columnIndex),
            value: _.uniqueId('row value ')
          }
        });
      });
    };

    $(document).ready(function() {
      socrata.visualizations.views.RowInspector.setup();

      $('#click-me').click(function(event) {
        if ($(event.target).closest('#socrata-row-inspector, #error').length) {
          return;
        }

        $(document.body).trigger('SOCRATA_VISUALIZATION_ROW_INSPECTOR_SHOW', {
          position: {pageX: event.pageX, pageY: event.pageY},
          error: $('#error:checked').length === 1,
          message: 'There was an unexpected error.'
        });

        setTimeout(function() {
          $(document.body).trigger('SOCRATA_VISUALIZATION_ROW_INSPECTOR_UPDATE', {
            position: {pageX: event.pageX, pageY: event.pageY},
            error: $('#error:checked').length === 1,
            message: 'There was an unexpected error.',
            data: validData($('#row-count').val())
          });
        }, 2000)
      });
    });
  </script>
</html>
